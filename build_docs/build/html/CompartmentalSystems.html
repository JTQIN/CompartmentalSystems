
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CompartmentalSystems package &#8212; CompartmentalSystems 1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="compartmentalsystems-package">
<h1>CompartmentalSystems package<a class="headerlink" href="#compartmentalsystems-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="CompartmentalSystems.bins.html">CompartmentalSystems.bins package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.CompatibleTsTpMassFieldsPerPool">CompartmentalSystems.bins.CompatibleTsTpMassFieldsPerPool module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.FieldsPerTimeStep">CompartmentalSystems.bins.FieldsPerTimeStep module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TimeBin">CompartmentalSystems.bins.TimeBin module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TimeField">CompartmentalSystems.bins.TimeField module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TimeMassField">CompartmentalSystems.bins.TimeMassField module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TimeStep">CompartmentalSystems.bins.TimeStep module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TimeStepIterator">CompartmentalSystems.bins.TimeStepIterator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TimeStepPlotter">CompartmentalSystems.bins.TimeStepPlotter module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TsMassField">CompartmentalSystems.bins.TsMassField module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TsMassFieldsPerTimeStep">CompartmentalSystems.bins.TsMassFieldsPerTimeStep module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TsTpBin">CompartmentalSystems.bins.TsTpBin module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TsTpDeathRateField">CompartmentalSystems.bins.TsTpDeathRateField module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TsTpField">CompartmentalSystems.bins.TsTpField module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TsTpMassField">CompartmentalSystems.bins.TsTpMassField module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TsTpMassFields">CompartmentalSystems.bins.TsTpMassFields module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TsTpMassFieldsPerPoolPerTimeStep">CompartmentalSystems.bins.TsTpMassFieldsPerPoolPerTimeStep module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TsTpMassFieldsPerTimeStep">CompartmentalSystems.bins.TsTpMassFieldsPerTimeStep module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.TstBin">CompartmentalSystems.bins.TstBin module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.density_algorithm">CompartmentalSystems.bins.density_algorithm module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.getsizeof">CompartmentalSystems.bins.getsizeof module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.gv">CompartmentalSystems.bins.gv module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins.plot_helpers">CompartmentalSystems.bins.plot_helpers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="CompartmentalSystems.bins.html#module-CompartmentalSystems.bins">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-CompartmentalSystems.BlockIvp">
<span id="compartmentalsystems-blockivp-module"></span><h2>CompartmentalSystems.BlockIvp module<a class="headerlink" href="#module-CompartmentalSystems.BlockIvp" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="CompartmentalSystems.BlockIvp.BlockIvp">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.BlockIvp.</code><code class="sig-name descname">BlockIvp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_str</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">start_blocks</span><span class="p">:</span> <span class="n">List<span class="p">[</span>Tuple<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">functionss</span><span class="p">:</span> <span class="n">List<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">[</span>Callable<span class="p">, </span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">disc_times</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">()</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/BlockIvp.html#BlockIvp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.BlockIvp.BlockIvp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Helper class to build initial value systems from functions that operate
on blocks of the state_variables.</p>
<dl class="py method">
<dt id="CompartmentalSystems.BlockIvp.BlockIvp.block_solve">
<code class="sig-name descname">block_solve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t_span</span></em>, <em class="sig-param"><span class="n">first_step</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/BlockIvp.html#BlockIvp.block_solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.BlockIvp.BlockIvp.block_solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.BlockIvp.BlockIvp.block_solve_functions">
<code class="sig-name descname">block_solve_functions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t_span</span></em>, <em class="sig-param"><span class="n">first_step</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/BlockIvp.html#BlockIvp.block_solve_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.BlockIvp.BlockIvp.block_solve_functions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.BlockIvp.BlockIvp.build_rhss">
<em class="property">classmethod </em><code class="sig-name descname">build_rhss</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_str</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">start_blocks</span><span class="p">:</span> <span class="n">List<span class="p">[</span>Tuple<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">functionss</span><span class="p">:</span> <span class="n">List<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">[</span>Callable<span class="p">, </span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Callable<span class="p">[</span><span class="p">[</span>numpy.float64<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="_modules/CompartmentalSystems/BlockIvp.html#BlockIvp.build_rhss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.BlockIvp.BlockIvp.build_rhss" title="Permalink to this definition">¶</a></dt>
<dd><p>The function returns a function dot_X=f(t,X) suitable as the right-hand
side for the ode solver scipy.solve_ivp from a collection of array
valued functions that compute blocks of dot_X from time and blocks of X
rather than from single equations.</p>
<p>A special application is the creation of block triangular systems, to
integrate variables whose time derivative depends on the solution
of an original system instantaneously along with it.</p>
<p>Assume that
X_1(t) is the solution of the initial value problem (ivp)</p>
<p>ivp_1:
dot_X_1=f_1(t,X), X_1(t_0)</p>
<p>and X_2(t) the solution of another ivp</p>
<p>ivp_2:
dot_X_2=f_2(t,X_1,X_2), X_2(t_0) whose right-hand side depends on x_1.</p>
<p>Then we can obtain the solution of both ivps simultaneously by
combining them into one.</p>
<p>(dot_X_1, dox_X_2)^t = (f_1(t,X_1),f_2(t,X_1,X_2))^t</p>
<p>For n instead of 2 variables one has:
(dot_X_1, dot_X_2,…, dot_X_n)^t</p>
<blockquote>
<div><p>= (f_1(t,X_1), f_2(t,X_1,X_2),…, f_n(t,X_1,…X_n))^t</p>
</div></blockquote>
<p>For a full lower triangular system the block derivative dot_X_i
depends on t and ALL the blocks X_1,…,X_i
but often it will only depend on
SOME of the previous blocks so that f_i has a considerably
smaller argument list.</p>
<p>This function therefore allows to specify WHICH blocks the f_i depend
on.
Consider the following 5+2*2 = 9 -dimensional block diagonal example:</p>
<dl>
<dt>b_s=block_rhs(</dt><dd><blockquote>
<div><p>time_str=’t’</p>
</div></blockquote>
<p>,start_blocks=[(‘X1’,np.ones((5,1)),(‘X2’,np.ones((2,2)))]
,functions=[</p>
<blockquote>
<div><blockquote>
<div><blockquote>
<div><p>((lambda x   : x*2 ),  [‘X1’]    )</p>
</div></blockquote>
<p>,((lambda t,x : t*x ),  [‘t’ ,’X2’])</p>
</div></blockquote>
<p>])</p>
</div></blockquote>
</dd>
</dl>
<p>The first argument ‘time_str’ denotes the alias for the t argument to
be used later in the signature of the block functions.
The second argument ‘start_blocks’ describes the decomposition of X
into blocks by a list of tuples of the form (‘Name’,array).
The third argument ‘functions’ is a list of tuples of the function
itself and the list of the names of its block arguments as specified
in the ‘start_blocks’ argument.
Order is important for the ‘start_blocks’ and the ‘functions’.
It is assumed that the i-th function computes the derivative of the
i-th block.
The names of the blocks itself are arbitrary and have no meaning apart
from their correspondence in the start_blocks and functions argument.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.BlockIvp.BlockIvp.check_block_exists">
<code class="sig-name descname">check_block_exists</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/BlockIvp.html#BlockIvp.check_block_exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.BlockIvp.BlockIvp.check_block_exists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.BlockOde">
<span id="compartmentalsystems-blockode-module"></span><h2>CompartmentalSystems.BlockOde module<a class="headerlink" href="#module-CompartmentalSystems.BlockOde" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="CompartmentalSystems.BlockOde.BlockOde">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.BlockOde.</code><code class="sig-name descname">BlockOde</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_str</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">block_names_and_shapes</span><span class="p">:</span> <span class="n">List<span class="p">[</span>Tuple<span class="p">[</span>str<span class="p">, </span>Tuple<span class="p">[</span>int<span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">functionss</span><span class="p">:</span> <span class="n">List<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">[</span>Callable<span class="p">, </span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span><span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">disc_times</span><span class="p">:</span> <span class="n">Tuple<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">()</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/BlockOde.html#BlockOde"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.BlockOde.BlockOde" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Helper class to build a system from functions that operate on blocks of
the state_variables.</p>
<dl class="py method">
<dt id="CompartmentalSystems.BlockOde.BlockOde.blockIvp">
<code class="sig-name descname">blockIvp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_blocks</span><span class="p">:</span> <span class="n">List<span class="p">[</span>Tuple<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#CompartmentalSystems.BlockIvp.BlockIvp" title="CompartmentalSystems.BlockIvp.BlockIvp">CompartmentalSystems.BlockIvp.BlockIvp</a><a class="reference internal" href="_modules/CompartmentalSystems/BlockOde.html#BlockOde.blockIvp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.BlockOde.BlockOde.blockIvp" title="Permalink to this definition">¶</a></dt>
<dd><p>Extends the system to an initial value problem by adding startvalues
for the blocks.
It checks that the names of the names of the blocks coincide.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.BlockOde.BlockOde.check_block_exists">
<code class="sig-name descname">check_block_exists</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">block_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/BlockOde.html#BlockOde.check_block_exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.BlockOde.BlockOde.check_block_exists" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.Cache">
<span id="compartmentalsystems-cache-module"></span><h2>CompartmentalSystems.Cache module<a class="headerlink" href="#module-CompartmentalSystems.Cache" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="CompartmentalSystems.Cache.Cache">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.Cache.</code><code class="sig-name descname">Cache</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">keys</span></em>, <em class="sig-param"><span class="n">values</span></em>, <em class="sig-param"><span class="n">smr_hash</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/Cache.html#Cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.Cache.Cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="CompartmentalSystems.Cache.Cache.end_time_from_phi_ind">
<code class="sig-name descname">end_time_from_phi_ind</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ind</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/Cache.html#Cache.end_time_from_phi_ind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.Cache.Cache.end_time_from_phi_ind" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.Cache.Cache.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/Cache.html#Cache.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.Cache.Cache.from_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.Cache.Cache.phi_ind">
<code class="sig-name descname">phi_ind</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tau</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/Cache.html#Cache.phi_ind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.Cache.Cache.phi_ind" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.Cache.Cache.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/Cache.html#Cache.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.Cache.Cache.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.Cache.Cache.start_time_from_phi_ind">
<code class="sig-name descname">start_time_from_phi_ind</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ind</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/Cache.html#Cache.start_time_from_phi_ind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.Cache.Cache.start_time_from_phi_ind" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.cs_plotter">
<span id="compartmentalsystems-cs-plotter-module"></span><h2>CompartmentalSystems.cs_plotter module<a class="headerlink" href="#module-CompartmentalSystems.cs_plotter" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="CompartmentalSystems.cs_plotter.CSPlotter">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.cs_plotter.</code><code class="sig-name descname">CSPlotter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_vector</span></em>, <em class="sig-param"><span class="n">inputs</span></em>, <em class="sig-param"><span class="n">outputs</span></em>, <em class="sig-param"><span class="n">internal_fluxes</span></em>, <em class="sig-param"><span class="n">pipe_colors</span><span class="o">=</span><span class="default_value">{'linear': 'blue', 'no state dependence': 'red', 'nonlinear': 'green'}</span></em>, <em class="sig-param"><span class="n">visible_pool_names</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">pool_size_scale_factor</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">pool_color</span><span class="o">=</span><span class="default_value">'blue'</span></em>, <em class="sig-param"><span class="n">pool_alpha</span><span class="o">=</span><span class="default_value">0.3</span></em>, <em class="sig-param"><span class="n">pipe_alpha</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">connectionstyle</span><span class="o">=</span><span class="default_value">'arc3, rad=0.1'</span></em>, <em class="sig-param"><span class="n">arrowstyle</span><span class="o">=</span><span class="default_value">'simple'</span></em>, <em class="sig-param"><span class="n">mutation_scale</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">24</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/cs_plotter.html#CSPlotter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.cs_plotter.CSPlotter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="CompartmentalSystems.cs_plotter.CSPlotter.legend">
<code class="sig-name descname">legend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/cs_plotter.html#CSPlotter.legend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.cs_plotter.CSPlotter.legend" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.cs_plotter.CSPlotter.plot_pools_and_fluxes">
<code class="sig-name descname">plot_pools_and_fluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/cs_plotter.html#CSPlotter.plot_pools_and_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.cs_plotter.CSPlotter.plot_pools_and_fluxes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.cs_plotter.Pool">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.cs_plotter.</code><code class="sig-name descname">Pool</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">size</span></em>, <em class="sig-param"><span class="n">pool_color</span></em>, <em class="sig-param"><span class="n">pool_alpha</span></em>, <em class="sig-param"><span class="n">pipe_alpha</span></em>, <em class="sig-param"><span class="n">connectionstyle</span></em>, <em class="sig-param"><span class="n">arrowstyle</span></em>, <em class="sig-param"><span class="n">mutation_scale</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/cs_plotter.html#Pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.cs_plotter.Pool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="CompartmentalSystems.cs_plotter.Pool.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/cs_plotter.html#Pool.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.cs_plotter.Pool.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.cs_plotter.Pool.plot_input_flux">
<code class="sig-name descname">plot_input_flux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">color</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/cs_plotter.html#Pool.plot_input_flux"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.cs_plotter.Pool.plot_input_flux" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.cs_plotter.Pool.plot_internal_flux_to">
<code class="sig-name descname">plot_internal_flux_to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">pool_to</span></em>, <em class="sig-param"><span class="n">color</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/cs_plotter.html#Pool.plot_internal_flux_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.cs_plotter.Pool.plot_internal_flux_to" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.cs_plotter.Pool.plot_name">
<code class="sig-name descname">plot_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">fontsize</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/cs_plotter.html#Pool.plot_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.cs_plotter.Pool.plot_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.cs_plotter.Pool.plot_output_flux">
<code class="sig-name descname">plot_output_flux</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">color</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/cs_plotter.html#Pool.plot_output_flux"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.cs_plotter.Pool.plot_output_flux" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.discrete_model_run">
<span id="compartmentalsystems-discrete-model-run-module"></span><h2>CompartmentalSystems.discrete_model_run module<a class="headerlink" href="#module-CompartmentalSystems.discrete_model_run" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="CompartmentalSystems.discrete_model_run.DMRError">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.discrete_model_run.</code><code class="sig-name descname">DMRError</code><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DMRError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DMRError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.discrete_model_run.</code><code class="sig-name descname">DiscreteModelRun</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">Bs</span></em>, <em class="sig-param"><span class="n">xs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_external_output_vector">
<code class="sig-name descname">acc_external_output_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.acc_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_internal_flux_matrix">
<code class="sig-name descname">acc_internal_flux_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.acc_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_net_external_input_vector">
<code class="sig-name descname">acc_net_external_input_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.acc_net_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_net_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_net_external_output_vector">
<code class="sig-name descname">acc_net_external_output_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.acc_net_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_net_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_net_internal_flux_matrix">
<code class="sig-name descname">acc_net_internal_flux_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.acc_net_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.acc_net_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_densities_1_single_value_func">
<code class="sig-name descname">age_densities_1_single_value_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.age_densities_1_single_value_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_densities_1_single_value_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_densities_2_single_value_func">
<code class="sig-name descname">age_densities_2_single_value_func</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.age_densities_2_single_value_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_densities_2_single_value_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_densities_single_value_func">
<code class="sig-name descname">age_densities_single_value_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.age_densities_single_value_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_densities_single_value_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_moment_vector">
<code class="sig-name descname">age_moment_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">start_age_moments</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.age_moment_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_moment_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_quantiles_at_time">
<code class="sig-name descname">age_quantiles_at_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">pools</span></em>, <em class="sig-param"><span class="n">start_age_densities</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.age_quantiles_at_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.age_quantiles_at_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.backward_transit_time_moment">
<code class="sig-name descname">backward_transit_time_moment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">start_age_moments</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.backward_transit_time_moment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.backward_transit_time_moment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.compute_start_age_moments">
<code class="sig-name descname">compute_start_age_moments</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_order</span></em>, <em class="sig-param"><span class="n">time_index</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.compute_start_age_moments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.compute_start_age_moments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.compute_start_m_factorial_moment">
<code class="sig-name descname">compute_start_m_factorial_moment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">time_index</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.compute_start_m_factorial_moment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.compute_start_m_factorial_moment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.dts">
<em class="property">property </em><code class="sig-name descname">dts</code><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.dts" title="Permalink to this definition">¶</a></dt>
<dd><p>The lengths of the time intervals.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.from_Bs_and_net_Us">
<em class="property">classmethod </em><code class="sig-name descname">from_Bs_and_net_Us</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">Bs</span></em>, <em class="sig-param"><span class="n">net_Us</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.from_Bs_and_net_Us"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.from_Bs_and_net_Us" title="Permalink to this definition">¶</a></dt>
<dd><p>Bs State transition operators for one time step</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.from_SmoothModelRun">
<em class="property">classmethod </em><code class="sig-name descname">from_SmoothModelRun</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smr</span></em>, <em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.from_SmoothModelRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.from_SmoothModelRun" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.from_fluxes">
<em class="property">classmethod </em><code class="sig-name descname">from_fluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">net_Us</span></em>, <em class="sig-param"><span class="n">net_Fs</span></em>, <em class="sig-param"><span class="n">net_Rs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.from_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.from_fluxes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.load_from_file">
<em class="property">classmethod </em><code class="sig-name descname">load_from_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.load_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.load_from_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.net_Us">
<em class="property">property </em><code class="sig-name descname">net_Us</code><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.net_Us" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.nr_pools">
<em class="property">property </em><code class="sig-name descname">nr_pools</code><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.nr_pools" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.pool_age_densities_func">
<code class="sig-name descname">pool_age_densities_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span></em>, <em class="sig-param"><span class="n">coarsity</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.pool_age_densities_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.pool_age_densities_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.reconstruct_B">
<em class="property">classmethod </em><code class="sig-name descname">reconstruct_B</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">R</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.reconstruct_B"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.reconstruct_B" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.reconstruct_Bs">
<em class="property">classmethod </em><code class="sig-name descname">reconstruct_Bs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xs</span></em>, <em class="sig-param"><span class="n">Fs</span></em>, <em class="sig-param"><span class="n">Rs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.reconstruct_Bs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.reconstruct_Bs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.reconstruct_Bs_without_xs">
<em class="property">classmethod </em><code class="sig-name descname">reconstruct_Bs_without_xs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">Us</span></em>, <em class="sig-param"><span class="n">Fs</span></em>, <em class="sig-param"><span class="n">Rs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.reconstruct_Bs_without_xs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.reconstruct_Bs_without_xs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.reconstruct_from_fluxes_and_solution">
<em class="property">classmethod </em><code class="sig-name descname">reconstruct_from_fluxes_and_solution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span></em>, <em class="sig-param"><span class="n">xs</span></em>, <em class="sig-param"><span class="n">Fs</span></em>, <em class="sig-param"><span class="n">Rs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.reconstruct_from_fluxes_and_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.reconstruct_from_fluxes_and_solution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.save_to_file">
<code class="sig-name descname">save_to_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.save_to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.save_to_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.start_age_densities_func">
<code class="sig-name descname">start_age_densities_func</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.start_age_densities_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.start_age_densities_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.start_values">
<em class="property">property </em><code class="sig-name descname">start_values</code><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.start_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run.DiscreteModelRun.system_age_moment">
<code class="sig-name descname">system_age_moment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">start_age_moments</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run.html#DiscreteModelRun.system_age_moment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun.system_age_moment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.discrete_model_run_14C">
<span id="compartmentalsystems-discrete-model-run-14c-module"></span><h2>CompartmentalSystems.discrete_model_run_14C module<a class="headerlink" href="#module-CompartmentalSystems.discrete_model_run_14C" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.discrete_model_run_14C.</code><code class="sig-name descname">DiscreteModelRun_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dmr</span></em>, <em class="sig-param"><span class="n">start_values_14C</span></em>, <em class="sig-param"><span class="n">net_Us_14C</span></em>, <em class="sig-param"><span class="n">decay_rate</span><span class="o">=</span><span class="default_value">0.0001209681</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_14C.html#DiscreteModelRun_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun" title="CompartmentalSystems.discrete_model_run.DiscreteModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompartmentalSystems.discrete_model_run.DiscreteModelRun</span></code></a></p>
<dl class="simple">
<dt>Construct and return a <a class="reference internal" href="#CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C" title="CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiscreteModelRun_14C</span></code></a> instance that</dt><dd><p>models the 14C component of the original model run.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dmr</strong> (<a class="reference internal" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun" title="CompartmentalSystems.discrete_model_run.DiscreteModelRun"><em>DiscreteModelRun</em></a>) – original model run</p></li>
<li><p><strong>start_values_14C</strong> (<em>numpy.nd_array</em><em>, </em><em>nr_pools</em>) – 14C start values.</p></li>
<li><p><strong>Fa_func</strong> (<em>func</em><em>(</em><em>t</em><em>)</em>) – returns atmospheric fraction to be
multiplied with the input vector</p></li>
<li><p><strong>rate</strong> (<em>decay</em>) – The decay rate to be used,
defaults to <code class="docutils literal notranslate"><span class="pre">0.0001209681</span></code> (daily).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.acc_net_external_input_vector_Delta_14C">
<code class="sig-name descname">acc_net_external_input_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_14C.html#DiscreteModelRun_14C.acc_net_external_input_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.acc_net_external_input_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.acc_net_external_output_vector">
<code class="sig-name descname">acc_net_external_output_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_14C.html#DiscreteModelRun_14C.acc_net_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.acc_net_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.acc_net_external_output_vector_Delta_14C">
<code class="sig-name descname">acc_net_external_output_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_14C.html#DiscreteModelRun_14C.acc_net_external_output_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.acc_net_external_output_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.acc_net_internal_flux_matrix_Delta_14C">
<code class="sig-name descname">acc_net_internal_flux_matrix_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_14C.html#DiscreteModelRun_14C.acc_net_internal_flux_matrix_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.acc_net_internal_flux_matrix_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.external_output_vector">
<em class="property">property </em><code class="sig-name descname">external_output_vector</code><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.solve_Delta_14C">
<code class="sig-name descname">solve_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_14C.html#DiscreteModelRun_14C.solve_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_14C.DiscreteModelRun_14C.solve_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="CompartmentalSystems.discrete_model_run_14C.Error">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.discrete_model_run_14C.</code><code class="sig-name descname">Error</code><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_14C.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_14C.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.discrete_model_run_with_gross_fluxes">
<span id="compartmentalsystems-discrete-model-run-with-gross-fluxes-module"></span><h2>CompartmentalSystems.discrete_model_run_with_gross_fluxes module<a class="headerlink" href="#module-CompartmentalSystems.discrete_model_run_with_gross_fluxes" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="CompartmentalSystems.discrete_model_run_with_gross_fluxes.DMRError">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.discrete_model_run_with_gross_fluxes.</code><code class="sig-name descname">DMRError</code><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_with_gross_fluxes.html#DMRError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_with_gross_fluxes.DMRError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.discrete_model_run_with_gross_fluxes.</code><code class="sig-name descname">DiscreteModelRunWithGrossFluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">Bs</span></em>, <em class="sig-param"><span class="n">xs</span></em>, <em class="sig-param"><span class="n">gross_Us</span></em>, <em class="sig-param"><span class="n">gross_Fs</span></em>, <em class="sig-param"><span class="n">gross_Rs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_with_gross_fluxes.html#DiscreteModelRunWithGrossFluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CompartmentalSystems.discrete_model_run.DiscreteModelRun" title="CompartmentalSystems.discrete_model_run.DiscreteModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompartmentalSystems.discrete_model_run.DiscreteModelRun</span></code></a>, <a class="reference internal" href="#CompartmentalSystems.model_run.ModelRun" title="CompartmentalSystems.model_run.ModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompartmentalSystems.model_run.ModelRun</span></code></a></p>
<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.acc_external_input_vector">
<code class="sig-name descname">acc_external_input_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_with_gross_fluxes.html#DiscreteModelRunWithGrossFluxes.acc_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.acc_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.acc_gross_external_input_vector">
<code class="sig-name descname">acc_gross_external_input_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_with_gross_fluxes.html#DiscreteModelRunWithGrossFluxes.acc_gross_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.acc_gross_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.acc_gross_external_output_vector">
<code class="sig-name descname">acc_gross_external_output_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_with_gross_fluxes.html#DiscreteModelRunWithGrossFluxes.acc_gross_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.acc_gross_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.acc_gross_internal_flux_matrix">
<code class="sig-name descname">acc_gross_internal_flux_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_with_gross_fluxes.html#DiscreteModelRunWithGrossFluxes.acc_gross_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.acc_gross_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.from_SmoothModelRun">
<em class="property">classmethod </em><code class="sig-name descname">from_SmoothModelRun</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smr</span></em>, <em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_with_gross_fluxes.html#DiscreteModelRunWithGrossFluxes.from_SmoothModelRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.from_SmoothModelRun" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.reconstruct_from_fluxes_and_solution">
<em class="property">classmethod </em><code class="sig-name descname">reconstruct_from_fluxes_and_solution</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span></em>, <em class="sig-param"><span class="n">xs</span></em>, <em class="sig-param"><span class="n">net_Fs</span></em>, <em class="sig-param"><span class="n">net_Rs</span></em>, <em class="sig-param"><span class="n">gross_Us</span></em>, <em class="sig-param"><span class="n">gross_Fs</span></em>, <em class="sig-param"><span class="n">gross_Rs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/discrete_model_run_with_gross_fluxes.html#DiscreteModelRunWithGrossFluxes.reconstruct_from_fluxes_and_solution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.discrete_model_run_with_gross_fluxes.DiscreteModelRunWithGrossFluxes.reconstruct_from_fluxes_and_solution" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.example_smooth_model_runs">
<span id="compartmentalsystems-example-smooth-model-runs-module"></span><h2>CompartmentalSystems.example_smooth_model_runs module<a class="headerlink" href="#module-CompartmentalSystems.example_smooth_model_runs" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="CompartmentalSystems.example_smooth_model_runs.critics">
<code class="sig-prename descclassname">CompartmentalSystems.example_smooth_model_runs.</code><code class="sig-name descname">critics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/example_smooth_model_runs.html#critics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.example_smooth_model_runs.critics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.example_smooth_model_runs.emanuel_1">
<code class="sig-prename descclassname">CompartmentalSystems.example_smooth_model_runs.</code><code class="sig-name descname">emanuel_1</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/example_smooth_model_runs.html#emanuel_1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.example_smooth_model_runs.emanuel_1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.example_smooth_model_runs.nonlinear_two_pool">
<code class="sig-prename descclassname">CompartmentalSystems.example_smooth_model_runs.</code><code class="sig-name descname">nonlinear_two_pool</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/example_smooth_model_runs.html#nonlinear_two_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.example_smooth_model_runs.nonlinear_two_pool" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.example_smooth_reservoir_models">
<span id="compartmentalsystems-example-smooth-reservoir-models-module"></span><h2>CompartmentalSystems.example_smooth_reservoir_models module<a class="headerlink" href="#module-CompartmentalSystems.example_smooth_reservoir_models" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="CompartmentalSystems.example_smooth_reservoir_models.critics">
<code class="sig-prename descclassname">CompartmentalSystems.example_smooth_reservoir_models.</code><code class="sig-name descname">critics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">symbs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/example_smooth_reservoir_models.html#critics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.example_smooth_reservoir_models.critics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.example_smooth_reservoir_models.emanuel">
<code class="sig-prename descclassname">CompartmentalSystems.example_smooth_reservoir_models.</code><code class="sig-name descname">emanuel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">symbs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/example_smooth_reservoir_models.html#emanuel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.example_smooth_reservoir_models.emanuel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.example_smooth_reservoir_models.minimal">
<code class="sig-prename descclassname">CompartmentalSystems.example_smooth_reservoir_models.</code><code class="sig-name descname">minimal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">symbs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/example_smooth_reservoir_models.html#minimal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.example_smooth_reservoir_models.minimal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.example_smooth_reservoir_models.nonlinear_two_pool">
<code class="sig-prename descclassname">CompartmentalSystems.example_smooth_reservoir_models.</code><code class="sig-name descname">nonlinear_two_pool</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">symbs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/example_smooth_reservoir_models.html#nonlinear_two_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.example_smooth_reservoir_models.nonlinear_two_pool" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.helpers_reservoir">
<span id="compartmentalsystems-helpers-reservoir-module"></span><h2>CompartmentalSystems.helpers_reservoir module<a class="headerlink" href="#module-CompartmentalSystems.helpers_reservoir" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.F_Delta_14C">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">F_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">C12</span></em>, <em class="sig-param"><span class="n">C14</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#F_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.F_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.MH_sampling">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">MH_sampling</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">N</span></em>, <em class="sig-param"><span class="n">PDF</span></em>, <em class="sig-param"><span class="n">start</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#MH_sampling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.MH_sampling" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.arrange_subplots">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">arrange_subplots</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#arrange_subplots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.arrange_subplots" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.array_integration_by_ode">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">array_integration_by_ode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>float<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">a</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">b</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#array_integration_by_ode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.array_integration_by_ode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.array_integration_by_values">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">array_integration_by_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>float<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">taus</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#array_integration_by_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.array_integration_by_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.array_quad_result">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">array_quad_result</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>float<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">a</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">b</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">epsrel</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#array_quad_result"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.array_quad_result" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.check_parameter_dict_complete">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">check_parameter_dict_complete</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#check_parameter_dict_complete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.check_parameter_dict_complete" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Check if the parameter set  the function set are complete</dt><dd><p>to enable a model run.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothReservoirModel</span></code></a>) – The reservoir model on which the model run bases.</p></li>
<li><p><strong>parameter_dict</strong> (<em>dict</em>) – <code class="docutils literal notranslate"><span class="pre">{x:</span> <span class="pre">y}</span></code> with <code class="docutils literal notranslate"><span class="pre">x</span></code> being a SymPy symbol
and <code class="docutils literal notranslate"><span class="pre">y</span></code> being a numerical value.</p></li>
<li><p><strong>func_set</strong> (<em>dict</em>) – <code class="docutils literal notranslate"><span class="pre">{f:</span> <span class="pre">func}</span></code> with <code class="docutils literal notranslate"><span class="pre">f</span></code> being a SymPy symbol and
<code class="docutils literal notranslate"><span class="pre">func</span></code> being a Python function. Defaults to <code class="docutils literal notranslate"><span class="pre">dict()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>set of free symbols, parameter_dict is complete if</dt><dd><p><code class="docutils literal notranslate"><span class="pre">free_symbols</span></code> is the empty set</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>free_symbols (set)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.const_of_t_maker">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">const_of_t_maker</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">const</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#const_of_t_maker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.const_of_t_maker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.custom_lru_cache_wrapper">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">custom_lru_cache_wrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maxsize</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">typed</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">stats</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#custom_lru_cache_wrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.custom_lru_cache_wrapper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.deprecation_warning">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">deprecation_warning</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">txt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#deprecation_warning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.deprecation_warning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.draw_rv">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">draw_rv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">CDF</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#draw_rv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.draw_rv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.f_of_t_maker">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">f_of_t_maker</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sol_funcs</span></em>, <em class="sig-param"><span class="n">ol</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#f_of_t_maker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.f_of_t_maker" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.factor_out_from_matrix">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">factor_out_from_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#factor_out_from_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.factor_out_from_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.flux_dict_string">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">flux_dict_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">indent</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#flux_dict_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.flux_dict_string" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.func_subs">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">func_subs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">Func_expr</span></em>, <em class="sig-param"><span class="n">func</span></em>, <em class="sig-param"><span class="n">t0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#func_subs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.func_subs" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the function part_func
where part_func(_,_,…) =func(_,t=t0,_..) (func partially applied to t0)
The position of argument t in the argument list is found
by examining the Func_expression argument.
:param t: the symbol to be replaced by t0
:type t: sympy.symbol
:param t0: the value to which the function will be applied
:type t0: value
:param func: a python function
:type func: function
:param Func_exprs: An expression for an undefined Function
:type Func_exprs: sympy.Function</p>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.generalized_inverse_CDF">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">generalized_inverse_CDF</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">CDF</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">start_dist</span><span class="o">=</span><span class="default_value">0.0001</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#generalized_inverse_CDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.generalized_inverse_CDF" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.has_pw">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">has_pw</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#has_pw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.has_pw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.integrate_array_func_for_nested_boundaries">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">integrate_array_func_for_nested_boundaries</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>float<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">integrator</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>Callable<span class="p">[</span><span class="p">[</span>float<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>float<span class="p">, </span>float<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">tuples</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span><span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Sequence<span class="p">[</span>float<span class="p">]</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#integrate_array_func_for_nested_boundaries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.integrate_array_func_for_nested_boundaries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.is_DiracDelta">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">is_DiracDelta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#is_DiracDelta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.is_DiracDelta" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if expr is a Dirac delta function.</p>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.is_compartmental">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">is_compartmental</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#is_compartmental"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.is_compartmental" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.jacobian">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">jacobian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vec</span></em>, <em class="sig-param"><span class="n">state_vec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#jacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.jacobian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.load_csv">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">load_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#load_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.load_csv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.make_cut_func_set">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">make_cut_func_set</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">func_set</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#make_cut_func_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.make_cut_func_set" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.melt">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">melt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ndarr</span></em>, <em class="sig-param"><span class="n">identifiers</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#melt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.melt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.net_Fs_from_discrete_Bs_and_xs">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">net_Fs_from_discrete_Bs_and_xs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Bs</span></em>, <em class="sig-param"><span class="n">xs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#net_Fs_from_discrete_Bs_and_xs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.net_Fs_from_discrete_Bs_and_xs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.net_Rs_from_discrete_Bs_and_xs">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">net_Rs_from_discrete_Bs_and_xs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Bs</span></em>, <em class="sig-param"><span class="n">xs</span></em>, <em class="sig-param"><span class="n">decay_corr</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#net_Rs_from_discrete_Bs_and_xs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.net_Rs_from_discrete_Bs_and_xs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.net_Us_from_discrete_Bs_and_xs">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">net_Us_from_discrete_Bs_and_xs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Bs</span></em>, <em class="sig-param"><span class="n">xs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#net_Us_from_discrete_Bs_and_xs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.net_Us_from_discrete_Bs_and_xs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.numerical_function_from_expression">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">numerical_function_from_expression</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em>, <em class="sig-param"><span class="n">tup</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#numerical_function_from_expression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.numerical_function_from_expression" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.numerical_rhs">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">numerical_rhs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_vector</span></em>, <em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">rhs</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#numerical_rhs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.numerical_rhs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.numerical_rhs_old">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">numerical_rhs_old</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_vector</span></em>, <em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">rhs</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em>, <em class="sig-param"><span class="n">times</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#numerical_rhs_old"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.numerical_rhs_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.numsol_symbolic_system_old">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">numsol_symbolic_system_old</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_vector</span></em>, <em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">rhs</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em>, <em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">times</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#numsol_symbolic_system_old"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.numsol_symbolic_system_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.numsol_symbolical_system">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">numsol_symbolical_system</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_vector</span></em>, <em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">rhs</span></em>, <em class="sig-param"><span class="n">parameter_dicts</span></em>, <em class="sig-param"><span class="n">func_dicts</span></em>, <em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">disc_times</span><span class="o">=</span><span class="default_value">()</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#numsol_symbolical_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.numsol_symbolical_system" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.parse_input_function">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">parse_input_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u_i</span></em>, <em class="sig-param"><span class="n">time_symbol</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#parse_input_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.parse_input_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ordered list of jumps in the input function u.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>u</strong> (<em>SymPy expression</em>) – input function in <span class="math notranslate nohighlight">\(\dot{x} = B\,x + u\)</span></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ascending list of jumps in u</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.phi_tmax">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">phi_tmax</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">t_max</span></em>, <em class="sig-param"><span class="n">block_ode</span></em>, <em class="sig-param"><span class="n">x_s</span></em>, <em class="sig-param"><span class="n">x_block_name</span></em>, <em class="sig-param"><span class="n">phi_block_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#phi_tmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.phi_tmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.print_quantile_error_statisctics">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">print_quantile_error_statisctics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">qs_ode</span></em>, <em class="sig-param"><span class="n">qs_pi</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#print_quantile_error_statisctics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.print_quantile_error_statisctics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.save_csv">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">save_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">melted</span></em>, <em class="sig-param"><span class="n">header</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#save_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.save_csv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.stochastic_collocation_transform">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">stochastic_collocation_transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em>, <em class="sig-param"><span class="n">CDF</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#stochastic_collocation_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.stochastic_collocation_transform" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.stride">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">stride</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">strides</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#stride"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.stride" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.tup2str">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">tup2str</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tup</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#tup2str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.tup2str" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.warning">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">warning</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">txt</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#warning"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.warning" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.x_phi_ode">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">x_phi_ode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">parameter_dicts</span></em>, <em class="sig-param"><span class="n">func_dicts</span></em>, <em class="sig-param"><span class="n">x_block_name</span><span class="o">=</span><span class="default_value">'x'</span></em>, <em class="sig-param"><span class="n">phi_block_name</span><span class="o">=</span><span class="default_value">'phi'</span></em>, <em class="sig-param"><span class="n">disc_times</span><span class="o">=</span><span class="default_value">()</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#x_phi_ode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.x_phi_ode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.x_phi_tmax">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">x_phi_tmax</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">t_max</span></em>, <em class="sig-param"><span class="n">block_ode</span></em>, <em class="sig-param"><span class="n">x_s</span></em>, <em class="sig-param"><span class="n">x_block_name</span></em>, <em class="sig-param"><span class="n">phi_block_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#x_phi_tmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.x_phi_tmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.helpers_reservoir.x_tmax">
<code class="sig-prename descclassname">CompartmentalSystems.helpers_reservoir.</code><code class="sig-name descname">x_tmax</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">t_max</span></em>, <em class="sig-param"><span class="n">block_ode</span></em>, <em class="sig-param"><span class="n">x_s</span></em>, <em class="sig-param"><span class="n">x_block_name</span></em>, <em class="sig-param"><span class="n">phi_block_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/helpers_reservoir.html#x_tmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.helpers_reservoir.x_tmax" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.model_run">
<span id="compartmentalsystems-model-run-module"></span><h2>CompartmentalSystems.model_run module<a class="headerlink" href="#module-CompartmentalSystems.model_run" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="CompartmentalSystems.model_run.ModelRun">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.model_run.</code><code class="sig-name descname">ModelRun</code><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#ModelRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="CompartmentalSystems.model_run.ModelRun.acc_gross_external_input_vector">
<em class="property">abstract </em><code class="sig-name descname">acc_gross_external_input_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#ModelRun.acc_gross_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun.acc_gross_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.model_run.ModelRun.acc_gross_external_output_vector">
<em class="property">abstract </em><code class="sig-name descname">acc_gross_external_output_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#ModelRun.acc_gross_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun.acc_gross_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.model_run.ModelRun.acc_gross_internal_flux_matrix">
<em class="property">abstract </em><code class="sig-name descname">acc_gross_internal_flux_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#ModelRun.acc_gross_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun.acc_gross_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.model_run.ModelRun.acc_net_external_input_vector">
<em class="property">abstract </em><code class="sig-name descname">acc_net_external_input_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#ModelRun.acc_net_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun.acc_net_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.model_run.ModelRun.acc_net_external_output_vector">
<em class="property">abstract </em><code class="sig-name descname">acc_net_external_output_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#ModelRun.acc_net_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun.acc_net_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.model_run.ModelRun.acc_net_internal_flux_matrix">
<em class="property">abstract </em><code class="sig-name descname">acc_net_internal_flux_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#ModelRun.acc_net_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun.acc_net_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.model_run.ModelRun.dts">
<em class="property">abstract property </em><code class="sig-name descname">dts</code><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun.dts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.model_run.ModelRun.nr_pools">
<em class="property">abstract property </em><code class="sig-name descname">nr_pools</code><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun.nr_pools" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.model_run.ModelRun.solve">
<em class="property">abstract </em><code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alternative_start_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#ModelRun.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.ModelRun.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.model_run.plot_attributes">
<code class="sig-prename descclassname">CompartmentalSystems.model_run.</code><code class="sig-name descname">plot_attributes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mrs</span></em>, <em class="sig-param"><span class="n">file_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#plot_attributes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.plot_attributes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.model_run.plot_stocks_and_fluxes">
<code class="sig-prename descclassname">CompartmentalSystems.model_run.</code><code class="sig-name descname">plot_stocks_and_fluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mrs</span></em>, <em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">labels</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/model_run.html#plot_stocks_and_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.model_run.plot_stocks_and_fluxes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.myOdeResult">
<span id="compartmentalsystems-myoderesult-module"></span><h2>CompartmentalSystems.myOdeResult module<a class="headerlink" href="#module-CompartmentalSystems.myOdeResult" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="CompartmentalSystems.myOdeResult.get_sub_t_spans">
<code class="sig-prename descclassname">CompartmentalSystems.myOdeResult.</code><code class="sig-name descname">get_sub_t_spans</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t_span</span></em>, <em class="sig-param"><span class="n">disc_times</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/myOdeResult.html#get_sub_t_spans"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.myOdeResult.get_sub_t_spans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.myOdeResult.myOdeResult">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.myOdeResult.</code><code class="sig-name descname">myOdeResult</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">sol</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/myOdeResult.html#myOdeResult"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.myOdeResult.myOdeResult" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.integrate._ivp.ivp.OdeResult</span></code></p>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.myOdeResult.solve_ivp_pwc">
<code class="sig-prename descclassname">CompartmentalSystems.myOdeResult.</code><code class="sig-name descname">solve_ivp_pwc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rhss</span></em>, <em class="sig-param"><span class="n">t_span</span></em>, <em class="sig-param"><span class="n">y0</span></em>, <em class="sig-param"><span class="n">disc_times</span><span class="o">=</span><span class="default_value">()</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/myOdeResult.html#solve_ivp_pwc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.myOdeResult.solve_ivp_pwc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.picklegzip">
<span id="compartmentalsystems-picklegzip-module"></span><h2>CompartmentalSystems.picklegzip module<a class="headerlink" href="#module-CompartmentalSystems.picklegzip" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="CompartmentalSystems.picklegzip.dump">
<code class="sig-prename descclassname">CompartmentalSystems.picklegzip.</code><code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">object</span></em>, <em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">protocol</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/picklegzip.html#dump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.picklegzip.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an object to a compressed disk file.
Works well with huge objects.</p>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.picklegzip.load">
<code class="sig-prename descclassname">CompartmentalSystems.picklegzip.</code><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/picklegzip.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.picklegzip.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a compressed object from disk.</p>
</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.pwc_model_run">
<span id="compartmentalsystems-pwc-model-run-module"></span><h2>CompartmentalSystems.pwc_model_run module<a class="headerlink" href="#module-CompartmentalSystems.pwc_model_run" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="CompartmentalSystems.pwc_model_run.Error">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.pwc_model_run.</code><code class="sig-name descname">Error</code><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.pwc_model_run.</code><code class="sig-name descname">PWCModelRun</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">parameter_dicts</span></em>, <em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">disc_times</span></em>, <em class="sig-param"><span class="n">func_dicts</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CompartmentalSystems.model_run.ModelRun" title="CompartmentalSystems.model_run.ModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompartmentalSystems.model_run.ModelRun</span></code></a></p>
<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.B_func">
<code class="sig-name descname">B_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vec_sol_func</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.B_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.B_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.Phi">
<code class="sig-name descname">Phi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">T</span></em>, <em class="sig-param"><span class="n">S</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.Phi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.Phi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.acc_gross_external_input_vector">
<code class="sig-name descname">acc_gross_external_input_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.acc_gross_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.acc_gross_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.acc_gross_external_output_vector">
<code class="sig-name descname">acc_gross_external_output_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.acc_gross_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.acc_gross_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.acc_gross_internal_flux_matrix">
<code class="sig-name descname">acc_gross_internal_flux_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.acc_gross_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.acc_gross_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.acc_net_external_input_vector">
<code class="sig-name descname">acc_net_external_input_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.acc_net_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.acc_net_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.acc_net_external_output_vector">
<code class="sig-name descname">acc_net_external_output_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.acc_net_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.acc_net_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.acc_net_internal_flux_matrix">
<code class="sig-name descname">acc_net_internal_flux_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.acc_net_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.acc_net_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.boundaries">
<em class="property">property </em><code class="sig-name descname">boundaries</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.boundaries" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.dts">
<em class="property">property </em><code class="sig-name descname">dts</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.dts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.external_input_flux_funcss">
<code class="sig-name descname">external_input_flux_funcss</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.external_input_flux_funcss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.external_input_flux_funcss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.external_input_vector_func">
<code class="sig-name descname">external_input_vector_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cut_off</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.external_input_vector_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.external_input_vector_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.external_output_flux_funcss">
<code class="sig-name descname">external_output_flux_funcss</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.external_output_flux_funcss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.external_output_flux_funcss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.fake_discretized_Bs">
<code class="sig-name descname">fake_discretized_Bs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.fake_discretized_Bs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.fake_discretized_Bs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.initialize_state_transition_operator_cache">
<code class="sig-name descname">initialize_state_transition_operator_cache</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lru_maxsize</span></em>, <em class="sig-param"><span class="n">lru_stats</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.initialize_state_transition_operator_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.initialize_state_transition_operator_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.internal_flux_funcss">
<code class="sig-name descname">internal_flux_funcss</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.internal_flux_funcss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.internal_flux_funcss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.join_flux_funcss_rc">
<code class="sig-name descname">join_flux_funcss_rc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">flux_funcss</span></em>, <em class="sig-param"><span class="n">key</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.join_flux_funcss_rc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.join_flux_funcss_rc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.join_functions_rc">
<code class="sig-name descname">join_functions_rc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">funcs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.join_functions_rc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.join_functions_rc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.myhash">
<code class="sig-name descname">myhash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.myhash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.myhash" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a hash considering SOME but NOT ALL properties of a
model run. The function’s main use is to detect saved state transition
operator cashes that are no longer compatible with the model run object
that wants to use them. This check is useful but NOT COMPREHENSIVE.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.nr_intervals">
<em class="property">property </em><code class="sig-name descname">nr_intervals</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.nr_intervals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.nr_pools">
<em class="property">property </em><code class="sig-name descname">nr_pools</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.nr_pools" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.sol_funcs">
<code class="sig-name descname">sol_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.sol_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.sol_funcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alternative_start_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run.PWCModelRun.solve_func">
<code class="sig-name descname">solve_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alternative_start_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run.html#PWCModelRun.solve_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run.PWCModelRun.solve_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.pwc_model_run_14C">
<span id="compartmentalsystems-pwc-model-run-14c-module"></span><h2>CompartmentalSystems.pwc_model_run_14C module<a class="headerlink" href="#module-CompartmentalSystems.pwc_model_run_14C" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="CompartmentalSystems.pwc_model_run_14C.Error">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.pwc_model_run_14C.</code><code class="sig-name descname">Error</code><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.pwc_model_run_14C.</code><code class="sig-name descname">PWCModelRun_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pwc_mr</span></em>, <em class="sig-param"><span class="n">start_values_14C</span></em>, <em class="sig-param"><span class="n">Fa_func</span></em>, <em class="sig-param"><span class="n">decay_rate</span><span class="o">=</span><span class="default_value">0.0001209681</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CompartmentalSystems.pwc_model_run.PWCModelRun" title="CompartmentalSystems.pwc_model_run.PWCModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompartmentalSystems.pwc_model_run.PWCModelRun</span></code></a></p>
<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_gross_external_input_vector_Delta_14C">
<code class="sig-name descname">acc_gross_external_input_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.acc_gross_external_input_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_gross_external_input_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_gross_external_output_vector">
<code class="sig-name descname">acc_gross_external_output_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.acc_gross_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_gross_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_gross_external_output_vector_Delta_14C">
<code class="sig-name descname">acc_gross_external_output_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.acc_gross_external_output_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_gross_external_output_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_gross_internal_flux_matrix_Delta_14C">
<code class="sig-name descname">acc_gross_internal_flux_matrix_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.acc_gross_internal_flux_matrix_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_gross_internal_flux_matrix_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_net_external_input_vector_Delta_14C">
<code class="sig-name descname">acc_net_external_input_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.acc_net_external_input_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_net_external_input_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_net_external_output_vector">
<code class="sig-name descname">acc_net_external_output_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.acc_net_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_net_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_net_external_output_vector_Delta_14C">
<code class="sig-name descname">acc_net_external_output_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.acc_net_external_output_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_net_external_output_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_net_internal_flux_matrix_Delta_14C">
<code class="sig-name descname">acc_net_internal_flux_matrix_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.acc_net_internal_flux_matrix_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.acc_net_internal_flux_matrix_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.external_output_flux_funcss">
<code class="sig-name descname">external_output_flux_funcss</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.external_output_flux_funcss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.external_output_flux_funcss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.external_output_vector">
<em class="property">property </em><code class="sig-name descname">external_output_vector</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.solve_Delta_14C">
<code class="sig-name descname">solve_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#PWCModelRun_14C.solve_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.PWCModelRun_14C.solve_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.pwc_model_run_14C.pfile_C14Atm_NH">
<code class="sig-prename descclassname">CompartmentalSystems.pwc_model_run_14C.</code><code class="sig-name descname">pfile_C14Atm_NH</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_14C.html#pfile_C14Atm_NH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_14C.pfile_C14Atm_NH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.pwc_model_run_fd">
<span id="compartmentalsystems-pwc-model-run-fd-module"></span><h2>CompartmentalSystems.pwc_model_run_fd module<a class="headerlink" href="#module-CompartmentalSystems.pwc_model_run_fd" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.pwc_model_run_fd.</code><code class="sig-name descname">PWCModelRunFD</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Bs</span></em>, <em class="sig-param"><span class="n">us</span></em>, <em class="sig-param"><span class="n">pwc_mr</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CompartmentalSystems.model_run.ModelRun" title="CompartmentalSystems.model_run.ModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompartmentalSystems.model_run.ModelRun</span></code></a></p>
<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.B_func">
<code class="sig-name descname">B_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vec_sol_func</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.B_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.B_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.B_pwc">
<em class="property">classmethod </em><code class="sig-name descname">B_pwc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">Bs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.B_pwc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.B_pwc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_gross_external_input_vector">
<code class="sig-name descname">acc_gross_external_input_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.acc_gross_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_gross_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_gross_external_output_vector">
<code class="sig-name descname">acc_gross_external_output_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.acc_gross_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_gross_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_gross_internal_flux_matrix">
<code class="sig-name descname">acc_gross_internal_flux_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.acc_gross_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_gross_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_net_external_input_vector">
<code class="sig-name descname">acc_net_external_input_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.acc_net_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_net_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_net_external_output_vector">
<code class="sig-name descname">acc_net_external_output_vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.acc_net_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_net_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_net_internal_flux_matrix">
<code class="sig-name descname">acc_net_internal_flux_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.acc_net_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.acc_net_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.create_B_generic">
<em class="property">classmethod </em><code class="sig-name descname">create_B_generic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">Bs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.create_B_generic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.create_B_generic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.create_srm_generic">
<em class="property">classmethod </em><code class="sig-name descname">create_srm_generic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">Bs</span></em>, <em class="sig-param"><span class="n">us</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.create_srm_generic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.create_srm_generic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.create_u_generic">
<em class="property">classmethod </em><code class="sig-name descname">create_u_generic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">us</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.create_u_generic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.create_u_generic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.dts">
<em class="property">property </em><code class="sig-name descname">dts</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.dts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.external_input_vector_func">
<code class="sig-name descname">external_input_vector_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cut_off</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.external_input_vector_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.external_input_vector_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.fake_discretized_Bs">
<code class="sig-name descname">fake_discretized_Bs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.fake_discretized_Bs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.fake_discretized_Bs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.from_Bs_and_us">
<em class="property">classmethod </em><code class="sig-name descname">from_Bs_and_us</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">data_times</span></em>, <em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">Bs</span></em>, <em class="sig-param"><span class="n">us</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.from_Bs_and_us"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.from_Bs_and_us" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.from_gross_fluxes">
<em class="property">classmethod </em><code class="sig-name descname">from_gross_fluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">data_times</span></em>, <em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">gross_Us</span></em>, <em class="sig-param"><span class="n">gross_Fs</span></em>, <em class="sig-param"><span class="n">gross_Rs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.from_gross_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.from_gross_fluxes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.model">
<em class="property">property </em><code class="sig-name descname">model</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.nr_pools">
<em class="property">property </em><code class="sig-name descname">nr_pools</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.nr_pools" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.reconstruct_B_surrogate">
<em class="property">classmethod </em><code class="sig-name descname">reconstruct_B_surrogate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dt</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">gross_U</span></em>, <em class="sig-param"><span class="n">gross_F</span></em>, <em class="sig-param"><span class="n">gross_R</span></em>, <em class="sig-param"><span class="n">B0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.reconstruct_B_surrogate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.reconstruct_B_surrogate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.reconstruct_Bs">
<em class="property">classmethod </em><code class="sig-name descname">reconstruct_Bs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">gross_Us</span></em>, <em class="sig-param"><span class="n">gross_Fs</span></em>, <em class="sig-param"><span class="n">gross_Rs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.reconstruct_Bs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.reconstruct_Bs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alternative_start_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.start_values">
<em class="property">property </em><code class="sig-name descname">start_values</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.start_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.times">
<em class="property">property </em><code class="sig-name descname">times</code><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.times" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.u_pwc">
<em class="property">classmethod </em><code class="sig-name descname">u_pwc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">us</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFD.u_pwc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFD.u_pwc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="CompartmentalSystems.pwc_model_run_fd.PWCModelRunFDError">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.pwc_model_run_fd.</code><code class="sig-name descname">PWCModelRunFDError</code><a class="reference internal" href="_modules/CompartmentalSystems/pwc_model_run_fd.html#PWCModelRunFDError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.pwc_model_run_fd.PWCModelRunFDError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.smooth_model_run">
<span id="compartmentalsystems-smooth-model-run-module"></span><h2>CompartmentalSystems.smooth_model_run module<a class="headerlink" href="#module-CompartmentalSystems.smooth_model_run" title="Permalink to this headline">¶</a></h2>
<p>Module for numerical treatment of piece-wise continuous reservoir models.</p>
<p>An abstract
<a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothReservoirModel</span></code></a> is
filled with life by giving initial values, a parameter set, a time grid,
and potentially additional involved functions to it.</p>
<p>The model can then be run and as long as the model is linear,
based on the state transition operator age and transit time
distributions can be computed.</p>
<p>Nonlinear models can be linearized along a solution trajectory.</p>
<p>Counting of compartment/pool/reservoir numbers start at zero and the
total number of pools is <span class="math notranslate nohighlight">\(d\)</span>.</p>
<dl class="py exception">
<dt id="CompartmentalSystems.smooth_model_run.Error">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.smooth_model_run.</code><code class="sig-name descname">Error</code><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.smooth_model_run.</code><code class="sig-name descname">SmoothModelRun</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">start_values</span></em>, <em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">func_set</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CompartmentalSystems.model_run.ModelRun" title="CompartmentalSystems.model_run.ModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompartmentalSystems.model_run.ModelRun</span></code></a></p>
<p>Class for a model run based on a
<a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothReservoirModel</span></code></a>.</p>
<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.model">
<code class="sig-name descname">model</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.model" title="Permalink to this definition">¶</a></dt>
<dd><p>The reservoir model on which the model run bases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothReservoirModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.parameter_dict">
<code class="sig-name descname">parameter_dict</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.parameter_dict" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">{x:</span> <span class="pre">y}</span></code> with <code class="docutils literal notranslate"><span class="pre">x</span></code> being a SymPy symbol
and <code class="docutils literal notranslate"><span class="pre">y</span></code> being a numerical value.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.start_values">
<code class="sig-name descname">start_values</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.start_values" title="Permalink to this definition">¶</a></dt>
<dd><p>The vector of start values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.times">
<code class="sig-name descname">times</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.times" title="Permalink to this definition">¶</a></dt>
<dd><p>The time grid used for the simulation.
Typically created by <code class="docutils literal notranslate"><span class="pre">numpy.linspace</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.func_set">
<code class="sig-name descname">func_set</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.func_set" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">{f:</span> <span class="pre">func}</span></code> with <code class="docutils literal notranslate"><span class="pre">f</span></code> being a SymPy symbol and
<code class="docutils literal notranslate"><span class="pre">func</span></code> being a Python function. Defaults to <code class="docutils literal notranslate"><span class="pre">dict()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<p>Pool counting starts with <code class="docutils literal notranslate"><span class="pre">0</span></code>. In combined structures for pools and
system, the system is at the position of a <code class="docutils literal notranslate"><span class="pre">(d+1)</span></code> st pool.</p>
<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.B_func">
<code class="sig-name descname">B_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vec_sol_func</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.B_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.B_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.Phi">
<code class="sig-name descname">Phi</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">T</span></em>, <em class="sig-param"><span class="n">S</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.Phi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.Phi" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.Phi_func">
<code class="sig-name descname">Phi_func</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.Phi_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.Phi_func" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_gross_external_input_vector">
<code class="sig-name descname">acc_gross_external_input_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.acc_gross_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_gross_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grid of accumulated external input vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>len(times) x nr_pools</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_gross_external_output_vector">
<code class="sig-name descname">acc_gross_external_output_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.acc_gross_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_gross_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vectors of accumulated external outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>len(times)-1 x nr_pools</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_gross_internal_flux_matrix">
<code class="sig-name descname">acc_gross_internal_flux_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.acc_gross_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_gross_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grid of flux matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>len(times) x nr_pools x nr_pools</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_net_external_input_vector">
<code class="sig-name descname">acc_net_external_input_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.acc_net_external_input_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_net_external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_net_external_output_vector">
<code class="sig-name descname">acc_net_external_output_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.acc_net_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_net_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_net_internal_flux_matrix">
<code class="sig-name descname">acc_net_internal_flux_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.acc_net_internal_flux_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.acc_net_internal_flux_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.add_constant_age_distribution_surface_plotly">
<code class="sig-name descname">add_constant_age_distribution_surface_plotly</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fig</span></em>, <em class="sig-param"><span class="n">opacity</span><span class="o">=</span><span class="default_value">0.7</span></em>, <em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.add_constant_age_distribution_surface_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.add_constant_age_distribution_surface_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a grey and transparent density surface to an existing
Plotly density plot.</p>
<p>If index is not specified it is assumed to be 0 and the values correspond to the first time in the times porperty of the model run (the age distribution at the beginning)
and repeated for all times.
The plotted surface represents an age distribution that is constant in time.
It is intended to increase the visibility of changes in the age distribution with time.
Note that this constant age distribution does NOT necessarily correspond to a
possible (constant) development of the system.
This would only be true if the system was in equilibrium and the age distribution
was the equilibrium age distribution.
While this special case is a very interesting application this function does not
assertain that such an equlibrium situation is even possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>Plotly figure</em>) – The existing density plot to which the
surface is added.</p></li>
<li><p><strong>opacity</strong> (<em>between 0 and 1</em><em>, </em><em>optional</em>) – The opacity of the new surface.
Defaults to 0.9.
Unfortunately, the opacity option does not seem to work
properly.</p></li>
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – The time index from which the age distribution
data is taken.
Defaults to 0 such that the constant distribution is computed  at time <span class="math notranslate nohighlight">\(t_0\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">fig</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.add_line_to_density_plot_plotly">
<code class="sig-name descname">add_line_to_density_plot_plotly</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fig</span></em>, <em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">color</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">time_stride</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">width</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">on_surface</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">bottom</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">legend_on_surface</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">legend_bottom</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.add_line_to_density_plot_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.add_line_to_density_plot_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a line to an existing Plotly density plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>Plotly figure</em>) – Contains already a density plot to which the
new line is added.</p></li>
<li><p><strong>data</strong> (<em>numpy.array len</em><em>(</em><em>times</em><em>)</em>) – The age data of the new line.</p></li>
<li><p><strong>color</strong> (<em>#RRGGBB</em>) – The color of the new line.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – The name of the new line for the legend.</p></li>
<li><p><strong>time_stride</strong> (<em>int</em><em>, </em><em>optional</em>) – Coarsity of the plot in the time
direction to save memory.
Defaults to 1 meaning that all times are plotted and no memory
is saved.</p></li>
<li><p><strong>width</strong> (<em>int</em><em>, </em><em>optional</em>) – Width of the new line. Defaults to 5.</p></li>
<li><p><strong>on_surface</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, a new line with the given age
data is plotted on top of the given density.
Defaults to True.</p></li>
<li><p><strong>bottom</strong> (<em>bool optional</em>) – If True, a new line with the given age data
is plotted in the xy-plane.
Defaults to True.</p></li>
<li><p><strong>legend_on_surface</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the line on the surface
is mentioned in the legend.
Has no effect if on_surface is False.
Defaults to False.</p></li>
<li><p><strong>legend_bottom</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the line in the xy-plane is
mentioned in the legend.
Has no effect if bottom is False.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">fig</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_densities">
<code class="sig-name descname">age_densities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pool_age_densities</span></em>, <em class="sig-param"><span class="n">system_age_density</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.age_densities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_densities" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine pool and system age densities to one numpy.array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pool_age_densites</strong> (<em>numpy.ndarray len</em><em>(</em><em>ages</em><em>) </em><em>x len</em><em>(</em><em>times</em><em>) </em><em>x nr_pools</em>) – The pool age density values.</p></li>
<li><p><strong>system_age_density</strong> (<em>numpy.ndarray len</em><em>(</em><em>ages</em><em>) </em><em>x len</em><em>(</em><em>times</em><em>)</em>) – The system age density values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(len(ages) x len(times) x (nr_pools+1)).
The system age density values are appended to the end of the
pool density values (system = pool <code class="docutils literal notranslate"><span class="pre">d+1</span></code> with <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">nr_pools</span></code>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector">
<code class="sig-name descname">age_moment_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">start_age_moments</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.age_moment_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal notranslate"><span class="pre">order</span></code> th pool age moment vector over the time grid
by an ODE system.</p>
<p>This function solves an ODE system to obtain the pool age moments very
fast. If the system has empty pools at the beginning, the semi-explicit
formula is used until all pools are non-empty. Then the ODE system
starts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em>) – The order of the pool age moments to be computed.</p></li>
<li><p><strong>start_age_moments</strong> (<em>numpy.ndarray order x nr_pools</em><em>, </em><em>optional</em>) – Given initial age moments up to the order of interest.
Can possibly be computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities"><code class="xref py py-func docutils literal notranslate"><span class="pre">moments_from_densities()</span></code></a>.
Defaults to None assuming zero initial ages.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(times) x nr_pools.
The <code class="docutils literal notranslate"><span class="pre">order</span></code> th pool age moments over the time grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector_from_densities">
<code class="sig-name descname">age_moment_vector_from_densities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">start_age_densities</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.age_moment_vector_from_densities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector_from_densities" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal notranslate"><span class="pre">order</span></code> th moment of the pool ages by integration.</p>
<p>This function is extremely slow, since for each pool the integral over
the density is computed based on the singe-valued functions. It is
implemented only for the sake of completeness and to test the results
obtained by faster methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em>) – The order of the moment to be computed.</p></li>
<li><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age that returns a numpy.array containing the
masses with the given age at time <span class="math notranslate nohighlight">\(t_0\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(times) x nr_pools.
Contains the <code class="docutils literal notranslate"><span class="pre">order</span></code> th moment
of the pool ages over the time grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector_semi_explicit">
<code class="sig-name descname">age_moment_vector_semi_explicit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">start_age_moments</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.age_moment_vector_semi_explicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector_semi_explicit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal notranslate"><span class="pre">order</span></code> th moment of the pool ages by a semi-explicit
formula.</p>
<p>This function bases on a semi-explicit formula such that no improper
integrals need to be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em>) – The order of the age moment to be computed.</p></li>
<li><p><strong>start_age_moments</strong> (<em>numpy.ndarray order x nr_pools</em><em>, </em><em>optional</em>) – Given initial age moments up to the order of interest.
Can possibly be computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities"><code class="xref py py-func docutils literal notranslate"><span class="pre">moments_from_densities()</span></code></a>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> assuming zero initial ages.</p></li>
<li><p><strong>times</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – Time grid.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> and the original time grid is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(times) x nr_pools.
The <code class="docutils literal notranslate"><span class="pre">order</span></code> th pool age moments over the time grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.apply_to_forward_transit_time_simulation">
<code class="sig-name descname">apply_to_forward_transit_time_simulation</code><span class="sig-paren">(</span><em class="sig-param">f_dict={'mean': &lt;function mean&gt;}</em>, <em class="sig-param">N=10000</em>, <em class="sig-param">M=2</em>, <em class="sig-param">k=5</em>, <em class="sig-param">MH=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.apply_to_forward_transit_time_simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.apply_to_forward_transit_time_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>This is just a tentative approach.</p>
<p>To be honest, the problem of an unkown infinite future cannot be solved
this way, since the densities used to simulate forward transit time
random variables are biased by the cut-off at the end of the time grid.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.apply_to_forward_transit_time_simulation_its">
<code class="sig-name descname">apply_to_forward_transit_time_simulation_its</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f_dict</span></em>, <em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">N</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.apply_to_forward_transit_time_simulation_its"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.apply_to_forward_transit_time_simulation_its" title="Permalink to this definition">¶</a></dt>
<dd><p>This is just a tentative approach.</p>
<p>To be honest, the problem of an unkown infinite future cannot be solved
this way, since the densities used to simulate forward transit time
random variables are biased by the cut-off at the end of the time grid.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_density">
<code class="sig-name descname">backward_transit_time_density</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pool_age_densities</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.backward_transit_time_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the backward transit time based on given pool age densities.</p>
<p>The result is obtained by computing a weighted sum of the pool age
densities according to output rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pool_age_densites</strong> (<em>numpy.ndarray len</em><em>(</em><em>ages</em><em>) </em><em>x len</em><em>(</em><em>times</em><em>) </em><em>x nr_pools</em>) – The pool age density values.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(ages) x len(times). Mass leaving the system with
the respective age at the respective time.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_density_single_value_func">
<code class="sig-name descname">backward_transit_time_density_single_value_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.backward_transit_time_density_single_value_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_density_single_value_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function that returns a single value for the
backward transit time density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age that returns a numpy.array containing the
masses with the given age at time <span class="math notranslate nohighlight">\(t_0\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python function <code class="docutils literal notranslate"><span class="pre">p_sv</span></code>: <code class="docutils literal notranslate"><span class="pre">p_sv(a,</span> <span class="pre">t)</span></code> returns the mass that
leaves the system at time <code class="docutils literal notranslate"><span class="pre">t</span></code> with age <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_moment">
<code class="sig-name descname">backward_transit_time_moment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">start_age_moments</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.backward_transit_time_moment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal notranslate"><span class="pre">order</span></code> th backward transit time moment based on the
<a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">age_moment_vector()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em>) – The order of the backward transit time moment that is
to be computed.</p></li>
<li><p><strong>start_age_moments</strong> (<em>numpy.ndarray order x nr_pools</em><em>, </em><em>optional</em>) – Given initial age moments up to the order of interest.
Can possibly be computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities"><code class="xref py py-func docutils literal notranslate"><span class="pre">moments_from_densities()</span></code></a>.
Defaults to None assuming zero initial ages.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <code class="docutils literal notranslate"><span class="pre">order</span></code> th backward transit time moment over the
time grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_moment_from_density">
<code class="sig-name descname">backward_transit_time_moment_from_density</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">start_age_densities</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.backward_transit_time_moment_from_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_moment_from_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal notranslate"><span class="pre">order</span></code> th backward transit time moment based on an
improper integral over the density.</p>
<p>This function is extremely slow and implemented only for the sake of
completeness and for testing results from faster approaches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em>) – The order of the backward transit time moment that is
to be computed.</p></li>
<li><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math notranslate nohighlight">\(t_0\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <code class="docutils literal notranslate"><span class="pre">order</span></code> th backward transit time moment over the
time grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.combine_pools_and_system_values">
<code class="sig-name descname">combine_pools_and_system_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pools_values</span></em>, <em class="sig-param"><span class="n">system_values</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.combine_pools_and_system_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.combine_pools_and_system_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Append the system values to the pool values as if they belonged to
another pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pools_values</strong> (<em>numpy.ndarray len</em><em>(</em><em>times</em><em>) </em><em>x nr_pools</em>) – The values to be
saved over the time-pool grid.</p></li>
<li><p><strong>system_values</strong> (<em>numpy.array</em>) – The system values to be saved over the
time grid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(times) x (nr_pools+1) The pool and system values
over the time-pool grid with the system added at the end as another
pool.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_backward_transit_time_distribution_single_value">
<code class="sig-name descname">cumulative_backward_transit_time_distribution_single_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">F0</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.cumulative_backward_transit_time_distribution_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_backward_transit_time_distribution_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the cumulative backward transit time
distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math notranslate nohighlight">\(t_0\)</span>. Defaults to None.</p></li>
<li><p><strong>F0</strong> (<em>Python function</em>) – A function of age that returns a numpy.array
containing the masses with age less than or equal to the age at
time <span class="math notranslate nohighlight">\(t_0\)</span>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.discrete_model_run_14C.Error" title="CompartmentalSystems.discrete_model_run_14C.Error"><strong>Error</strong></a> – If both <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code> and <code class="docutils literal notranslate"><span class="pre">F0</span></code> are <code class="docutils literal notranslate"><span class="pre">None</span></code>.
    One must be given.
    It is fastest to provide <code class="docutils literal notranslate"><span class="pre">F0</span></code>, otherwise <code class="docutils literal notranslate"><span class="pre">F0</span></code> will be
    computed by numerical integration of <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Python function <code class="docutils literal notranslate"><span class="pre">F_sv</span></code>: <code class="docutils literal notranslate"><span class="pre">F_sv(a,</span> <span class="pre">t)</span></code> is the mass leaving the
system at time <code class="docutils literal notranslate"><span class="pre">t</span></code> with age less than or equal to <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_forward_transit_time_distribution_single_value_func">
<code class="sig-name descname">cumulative_forward_transit_time_distribution_single_value_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cut_off</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.cumulative_forward_transit_time_distribution_single_value_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_forward_transit_time_distribution_single_value_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the cumulative forward transit time
distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cut_off</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, no density values are going
to be computed after the end of the time grid, instead
<code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code> will be returned.
Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
<code class="docutils literal notranslate"><span class="pre">False</span></code> might lead to unexpected behavior.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python function <code class="docutils literal notranslate"><span class="pre">F_sv</span></code>: <code class="docutils literal notranslate"><span class="pre">F_sv(a,</span> <span class="pre">t)</span></code> is the mass leaving the
system at time <code class="docutils literal notranslate"><span class="pre">t+a</span></code> with age less than or equal to <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_pool_age_distributions_single_value">
<code class="sig-name descname">cumulative_pool_age_distributions_single_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">F0</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.cumulative_pool_age_distributions_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_pool_age_distributions_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the cumulative pool age distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math notranslate nohighlight">\(t_0\)</span>. Defaults to None.</p></li>
<li><p><strong>F0</strong> (<em>Python function</em>) – A function of age that returns a numpy.array
containing the masses with age less than or equal to the age at
time <span class="math notranslate nohighlight">\(t_0\)</span>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.discrete_model_run_14C.Error" title="CompartmentalSystems.discrete_model_run_14C.Error"><strong>Error</strong></a> – If both <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code> and <code class="docutils literal notranslate"><span class="pre">F0</span></code> are <code class="docutils literal notranslate"><span class="pre">None</span></code>.
    One must be given.
    It is fastest to provide <code class="docutils literal notranslate"><span class="pre">F0</span></code>, otherwise <code class="docutils literal notranslate"><span class="pre">F0</span></code> will be
    computed by numerical integration of <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Python function <code class="docutils literal notranslate"><span class="pre">F_sv</span></code>: <code class="docutils literal notranslate"><span class="pre">F_sv(a,t)</span></code> is the vector of pool
masses (<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code>) with age less than or equal to <code class="docutils literal notranslate"><span class="pre">a</span></code> at
time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_system_age_distribution_single_value">
<code class="sig-name descname">cumulative_system_age_distribution_single_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">F0</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.cumulative_system_age_distribution_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_system_age_distribution_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the cumulative system age distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math notranslate nohighlight">\(t_0\)</span>. Defaults to None.</p></li>
<li><p><strong>F0</strong> (<em>Python function</em>) – A function of age that returns a numpy.array
containing the masses with age less than or equal to the age at
time <span class="math notranslate nohighlight">\(t_0\)</span>. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.discrete_model_run_14C.Error" title="CompartmentalSystems.discrete_model_run_14C.Error"><strong>Error</strong></a> – If both <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code> and <code class="docutils literal notranslate"><span class="pre">F0</span></code> are None.
    One must be given.
    It is fastest to provide <code class="docutils literal notranslate"><span class="pre">F0</span></code>, otherwise <code class="docutils literal notranslate"><span class="pre">F0</span></code> will be
    computed by numerical integration of <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Python function <code class="docutils literal notranslate"><span class="pre">F_sv</span></code>: <code class="docutils literal notranslate"><span class="pre">F_sv(a,</span> <span class="pre">t)</span></code> is the mass in the system
with age less than or equal to <code class="docutils literal notranslate"><span class="pre">a</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.density_values">
<code class="sig-name descname">density_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">density_sv</span></em>, <em class="sig-param"><span class="n">values</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.density_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.density_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the density value over the time grid at ages given in values.</p>
<p>This function can be used to obtain the density values at mean or median
values to draw a curve on top of the density surface. But actually this
is now implemented in a much faster way based on the surface itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density_sv</strong> (<em>Python function</em>) – A function that takes <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code>
as arguments and returns density value with age a at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.
Potentially coming from <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density_single_value" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density_single_value"><code class="xref py py-func docutils literal notranslate"><span class="pre">system_age_density_single_value()</span></code></a>.</p></li>
<li><p><strong>values</strong> (<em>numpy.array</em>) – The ages over the time grid at which the
density values are to be computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The density values over the time grid based
on the given age values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.density_values_for_pools">
<code class="sig-name descname">density_values_for_pools</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pool_densities_sv</span></em>, <em class="sig-param"><span class="n">pool_age_values</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.density_values_for_pools"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.density_values_for_pools" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the pool age densities over the time grid at ages given in
pool_age_values.</p>
<p>This function can be used to obtain the density values at mean or median
values to draw a curve on top of the density surface. But actually this
is now implemented in a much faster way based on the surface itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pool_age_densites_sv</strong> (<em>Python function</em>) – A function that takes
<code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code> as arguments and returns a vector of pool contents
with mass a at time t. Potentially coming from
<a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_single_value" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_single_value"><code class="xref py py-func docutils literal notranslate"><span class="pre">pool_age_densities_single_value()</span></code></a>.</p></li>
<li><p><strong>pool_age_values</strong> (<em>numpy.ndarray len</em><em>(</em><em>times</em><em>) </em><em>x nr_pools</em>) – The ages over
the time-pool grid at which the density values are to be
computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(len(times) x nr_pools) The pool density values over
the time-pool grid based on the given age values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.distribution_quantile">
<em class="property">static </em><code class="sig-name descname">distribution_quantile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quantile</span></em>, <em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">norm_const</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_value</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'brentq'</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.distribution_quantile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.distribution_quantile" title="Permalink to this definition">¶</a></dt>
<dd><p>Return distribution quantile (one single value) of a given distribution.</p>
<p>The compuation is done by computing the generalized inverse of the
respective cumulative distribution using a nonlinear root search
algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantile</strong> (<em>between 0 and 1</em>) – The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal notranslate"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</p></li>
<li><p><strong>F</strong> (<em>Python function</em>) – A function of age <code class="docutils literal notranslate"><span class="pre">a</span></code> that
returns the mass that is of age less than or equal to <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p></li>
<li><p><strong>norm_const</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – The amount of total mass of the
distribution.
Defaults to one assuming a given probability distribution.</p></li>
<li><p><strong>start_value</strong> (<em>float</em><em>, </em><em>optional</em>) – A start value for the nonlinear
search.
A good values is slighty greater than the solution value.
Defaults to zero.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The method that is used for finding the roots of a
nonlinear function. Either ‘brentq’ or ‘newton’.
Defaults to ‘brentq’.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal notranslate"><span class="pre">1e-01</span></code> might already be fine.
Defaults to <code class="docutils literal notranslate"><span class="pre">1e-08</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computed quantile value of the distribution.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.distribution_quantiles">
<code class="sig-name descname">distribution_quantiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quantile</span></em>, <em class="sig-param"><span class="n">F_sv</span></em>, <em class="sig-param"><span class="n">norm_consts</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'brentq'</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.distribution_quantiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.distribution_quantiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return distribution quantiles over the time grid of a given
distribution.</p>
<p>The compuation is done by computing the generalized inverse of the
respective cumulative distribution using a nonlinear root search
algorithm. Depending on how slowly the cumulative distribution can be
computed, this can take quite some time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantile</strong> (<em>between 0 and 1</em>) – The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal notranslate"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</p></li>
<li><p><strong>F_sv</strong> (<em>Python function</em>) – A function of age <code class="docutils literal notranslate"><span class="pre">a</span></code> and time <code class="docutils literal notranslate"><span class="pre">t</span></code> that
returns the mass that is of age less than or equal to <code class="docutils literal notranslate"><span class="pre">a</span></code> at
time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p></li>
<li><p><strong>norm_consts</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – An array over the time grid of
total masses over all ages.
Defaults to an array of ones assuming given probability
distributions.</p></li>
<li><p><strong>start_values</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – An array over the time grid of
start values for the nonlinear search.
Good values are slighty greater than the solution values.
Must have the same length as <code class="docutils literal notranslate"><span class="pre">times</span></code>.
Defaults to an array of zeros.</p></li>
<li><p><strong>times</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – Time grid on which to compute the
quantiles.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> in which case the orignal time grid
is used.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The method that is used for finding the roots of a
nonlinear function. Either ‘brentq’ or ‘newton’.
Defaults to ‘brentq’.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal notranslate"><span class="pre">1e-01</span></code> might already be fine.
Defaults to <code class="docutils literal notranslate"><span class="pre">1e-08</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The computed quantile values over the time grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.dts">
<em class="property">property </em><code class="sig-name descname">dts</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.dts" title="Permalink to this definition">¶</a></dt>
<dd><p>The lengths of the time intervals.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_flux_funcs">
<code class="sig-name descname">external_input_flux_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.external_input_flux_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_flux_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of the external input fluxes.
The resulting functions base on sol_funcs and are linear interpolations.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">{key:</span> <span class="pre">func}</span></code> with <code class="docutils literal notranslate"><span class="pre">key</span></code> representing the pool which
receives the input and <code class="docutils literal notranslate"><span class="pre">func</span></code> a function of time that returns
a <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_vector">
<em class="property">property </em><code class="sig-name descname">external_input_vector</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grid of external input vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>len(times) x nr_pools</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_vector_func">
<code class="sig-name descname">external_input_vector_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cut_off</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.external_input_vector_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_vector_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector valued function for the external inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Python function <code class="docutils literal notranslate"><span class="pre">u</span></code>: <code class="docutils literal notranslate"><span class="pre">u(t)</span></code> is a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the
external inputs at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.
Note:
If the required (future) values for the input exceed the maximum of
times they are assumed to be zero if <code class="docutils literal notranslate"><span class="pre">cut_off</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>.
If <code class="docutils literal notranslate"><span class="pre">cut_off</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> then the input function is assumed to
be valid everywhere which might be dangerous if they are
extrapolated from data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.external_output_flux_funcs">
<code class="sig-name descname">external_output_flux_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.external_output_flux_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.external_output_flux_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of the external output fluxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">{key:</span> <span class="pre">func}</span></code> with <code class="docutils literal notranslate"><span class="pre">key</span></code> representing the pool from which
the output comes and <code class="docutils literal notranslate"><span class="pre">func</span></code> a function of time that returns a
<code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.external_output_vector">
<em class="property">property </em><code class="sig-name descname">external_output_vector</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grid of external output vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>len(times) x nr_pools</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.fake_discretized_Bs">
<code class="sig-name descname">fake_discretized_Bs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.fake_discretized_Bs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.fake_discretized_Bs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.fake_gross_discretized_output">
<code class="sig-name descname">fake_gross_discretized_output</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.fake_gross_discretized_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.fake_gross_discretized_output" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.fake_net_discretized_output">
<code class="sig-name descname">fake_net_discretized_output</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.fake_net_discretized_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.fake_net_discretized_output" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_density_func">
<code class="sig-name descname">forward_transit_time_density_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cut_off</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.forward_transit_time_density_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_density_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function based on an age array for the forward transit time
density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cut_off</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, no density values are going to
be computed after the end of the time grid, instead
<code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code> will be returned.
Defaults to True and False might lead to unexpected behavior.</p></li>
<li><p><strong>times</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – Time grid.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> and the original time grid is used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python function <code class="docutils literal notranslate"><span class="pre">p</span></code>: <code class="docutils literal notranslate"><span class="pre">p(ages)</span></code> is a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>
len(ages) x len(times) that gives the mass that will leave the
system with the respective age when it came in at time <code class="docutils literal notranslate"><span class="pre">t</span></code>,
where <code class="docutils literal notranslate"><span class="pre">ages</span></code> is a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_density_single_value_func">
<code class="sig-name descname">forward_transit_time_density_single_value_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cut_off</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">my_B_func</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.forward_transit_time_density_single_value_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_density_single_value_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function that returns a single value for the
forward transit time density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cut_off</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, no density values are going to
be computed after the end of the time grid, instead
<code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code> will be returned.
Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span></code> might lead to unexpected behavior.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python function <code class="docutils literal notranslate"><span class="pre">p_sv</span></code>: <code class="docutils literal notranslate"><span class="pre">p_sv(a,</span> <span class="pre">t)</span></code> returns how much mass will
leave the system with age <code class="docutils literal notranslate"><span class="pre">a</span></code> when it came in at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.initialize_state_transition_operator_cache">
<code class="sig-name descname">initialize_state_transition_operator_cache</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lru_maxsize</span></em>, <em class="sig-param"><span class="n">lru_stats</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.initialize_state_transition_operator_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.initialize_state_transition_operator_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.internal_flux_funcs">
<code class="sig-name descname">internal_flux_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.internal_flux_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.internal_flux_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of the internal fluxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">{key:</span> <span class="pre">func}</span></code> with <code class="docutils literal notranslate"><span class="pre">key=(pool_from,</span> <span class="pre">pool_to)</span></code> representing
the pools involved and <code class="docutils literal notranslate"><span class="pre">func</span></code> a function of time that returns
a <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.linearize">
<code class="sig-name descname">linearize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.linearize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.linearize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a linearized SmoothModelRun instance.</p>
<p>Linearization happens along the solution trajectory. Only for linear
systems all functionality is guaranteed,
this is why nonlinear systems should be linearized first.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A linearized version of the original
<a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothModelRun</span></code></a>, with the solutions now being part
of <code class="docutils literal notranslate"><span class="pre">func_set</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothModelRun</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.linearize_old">
<code class="sig-name descname">linearize_old</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.linearize_old"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.linearize_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a linearized SmoothModelRun instance.</p>
<p>Linearization happens along the solution trajectory. Only for linear
systems all functionality is guaranteed,
this is why nonlinear systems should be linearized first.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A linearized version of the original
<a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothModelRun</span></code></a>, with the solutions now being part
of <code class="docutils literal notranslate"><span class="pre">func_set</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothModelRun</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.load_density_csv">
<code class="sig-name descname">load_density_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">ages</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.load_density_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.load_density_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load density values from a csv file.</p>
<p>Attention: It is assumed that the data were saved before with the very
same ages, times, and pools.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The csv file from which the data are to be read.</p></li>
<li><p><strong>ages</strong> (<em>numpy.array</em>) – The ages corresponding to the age indices.
What is needed here is in fact only the length of the age grid.</p></li>
<li><p><strong>times</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – The ages corresponding to the time
indices.
What is needed here is in fact only the length of the time grid.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> and the original times are being used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(ages) x len(times) The density values over the
ages-times grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.load_pools_and_system_densities_csv">
<code class="sig-name descname">load_pools_and_system_densities_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">ages</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.load_pools_and_system_densities_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.load_pools_and_system_densities_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pool and system age densities from a csv file.</p>
<p>Attention: It is assumed that the data were saved before with the very
same ages, times, and pools.
Furthermore, it is assumed that the system value always follows the
pool values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The csv file from which the data are to be read.</p></li>
<li><p><strong>ages</strong> (<em>numpy.array</em>) – The ages corresponding to the age indices.
What is needed here is in fact only the length of the age grid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(ages) x len(times) x (nr_pools+1) The density
values for the pools and the system over the
ages-times-(pools+system) grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.load_pools_and_system_value_csv">
<code class="sig-name descname">load_pools_and_system_value_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.load_pools_and_system_value_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.load_pools_and_system_value_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pool and system values from a csv file.</p>
<p>Values could be the mean/median age, for example. One dimension less
than a density.</p>
<p>Attention: It is assumed that the data were saved before with the very
same ages, times, and pools.
Furthermore, it is assumed that the system value always follows the
pool values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The csv file from which the data are to be read.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(times) x (nr_pools+1) The values for the pools
and the system over the times-(pools+system) grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.load_state_transition_operator_cache">
<code class="sig-name descname">load_state_transition_operator_cache</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.load_state_transition_operator_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.load_state_transition_operator_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.load_value_csv">
<code class="sig-name descname">load_value_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.load_value_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.load_value_csv" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities">
<em class="property">static </em><code class="sig-name descname">moments_from_densities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_order</span></em>, <em class="sig-param"><span class="n">densities</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.moments_from_densities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the moments up to max_order of the given densities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_order</strong> (<em>int</em>) – The highest order up to which moments are
to be computed.</p></li>
<li><p><strong>densities</strong> (<em>numpy.array</em>) – Each entry is a Python function of one
variable (age) that represents a probability density function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>moments x pools, containing the moments of the given
densities.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.myhash">
<code class="sig-name descname">myhash</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.myhash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.myhash" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a hash considering SOME but NOT ALL properties of a
model run. The function’s main use is to detect saved state transition
operator cashes that are no longer compatible with the model run object
that wants to use them. This check is useful but NOT COMPREHENSIVE.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.no_input_model">
<em class="property">property </em><code class="sig-name descname">no_input_model</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.no_input_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.nr_pools">
<em class="property">property </em><code class="sig-name descname">nr_pools</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.nr_pools" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of pools involved in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.output_rate_vector">
<em class="property">property </em><code class="sig-name descname">output_rate_vector</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.output_rate_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grid of output rate vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>len(times) x nr_pools, <code class="docutils literal notranslate"><span class="pre">solution/output_vector</span></code></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.output_rate_vector_at_t">
<code class="sig-name descname">output_rate_vector_at_t</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.output_rate_vector_at_t"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.output_rate_vector_at_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector of output rates at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>t</strong> (<em>float</em>) – The time at which the output rates are computed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The ith entry contains the output rate of pool <code class="docutils literal notranslate"><span class="pre">i</span></code>
at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.output_vector_func">
<code class="sig-name descname">output_vector_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.output_vector_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.output_vector_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector of the external output fluxes at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The <code class="docutils literal notranslate"><span class="pre">i</span></code> th entry is the output from pool <code class="docutils literal notranslate"><span class="pre">i</span></code> at
time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_3d_density_plotly">
<code class="sig-name descname">plot_3d_density_plotly</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">title</span></em>, <em class="sig-param"><span class="n">density_data</span></em>, <em class="sig-param"><span class="n">ages</span></em>, <em class="sig-param"><span class="n">age_stride</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">time_stride</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_3d_density_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_3d_density_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a 3-dimendional density plot with Plotly.</p>
<p>The colors are created such that they are constant along the age-time
diagonal.
Thus, equal colors mark equal entry time into the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>title</strong> (<em>str</em>) – The title of the new figure.</p></li>
<li><p><strong>density_data</strong> (<em>numpy.ndarray len</em><em>(</em><em>ages</em><em>) </em><em>x len</em><em>(</em><em>times</em><em>)</em>) – The density data to be plotted.</p></li>
<li><p><strong>age_stride</strong> (<em>int</em><em>, </em><em>optional</em>) – Coarsity of the plot in the age
direction to save memory.
Defaults to 1 meaning that all times are plotted and no memory
is saved.</p></li>
<li><p><strong>time_stride</strong> (<em>int</em><em>, </em><em>optional</em>) – Coarsity of the plot in the time
direction to save memory.
Defaults to 1 meaning that all times are plotted and no memory
is saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Plotly figure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_external_input_fluxes">
<code class="sig-name descname">plot_external_input_fluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fig</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_external_input_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_external_input_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all external inpput fluxes.</p>
<p>For each external input flux a new subplot is added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>Matplotlib figure</em>) – The fig to which the subplots are added.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em><em>, </em><em>optional</em>) – Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">fig</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_external_output_fluxes">
<code class="sig-name descname">plot_external_output_fluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fig</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_external_output_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_external_output_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all external output fluxes.</p>
<p>For each external output flux a new subplot is added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>Matplotlib figure</em>) – The fig to which the subplots are added.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em><em>, </em><em>optional</em>) – Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">fig</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_internal_fluxes">
<code class="sig-name descname">plot_internal_fluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fig</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_internal_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_internal_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all internal fluxes.</p>
<p>For each internal flux a new subplot is added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>Matplotlib figure</em>) – The fig to which the subplots are added.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em><em>, </em><em>optional</em>) – Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">fig</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_mean_ages">
<code class="sig-name descname">plot_mean_ages</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fig</span></em>, <em class="sig-param"><span class="n">start_mean_ages</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_mean_ages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_mean_ages" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the time evolution of the mean ages for all pools and the
system.</p>
<p>For each pool and the system a separate subplot is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>Matplotlib figure</em>) – The fig to which the subplots are added.</p></li>
<li><p><strong>start_mean_ages</strong> (<em>numpy.array</em>) – Contains the start mean ages of the
pools at time <span class="math notranslate nohighlight">\(t_0\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">fig</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_mean_backward_transit_time">
<code class="sig-name descname">plot_mean_backward_transit_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">start_mean_ages</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_mean_backward_transit_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_mean_backward_transit_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the time evolution of the mean backward transit time.</p>
<p>For each pool and the system a separate subplot is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Matplotlib axis</em>) – The ax onto which the plot is done.</p></li>
<li><p><strong>start_mean_ages</strong> (<em>numpy.array</em>) – Contains the start mean ages of the
pools at time <span class="math notranslate nohighlight">\(t_0\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">ax</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_phase_plane">
<code class="sig-name descname">plot_phase_plane</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">i</span></em>, <em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_phase_plane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_phase_plane" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot one single phase plane.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Matplotlib axis</em>) – The axis onto which the phase plane is
plotted.</p></li>
<li><p><strong>i</strong> (<em>int</em>) – The numbers of the pools for which the phase plane is
plotted.</p></li>
<li><p><strong>j</strong> (<em>int</em>) – The numbers of the pools for which the phase plane is
plotted.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em><em>, </em><em>optional</em>) – Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">ax</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_phase_planes">
<code class="sig-name descname">plot_phase_planes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fig</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_phase_planes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_phase_planes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all phase planes.</p>
<p>For each (i,j)-phase plane a new subplot is added.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>Matplotlib figure</em>) – The fig to which the subplots are added.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em><em>, </em><em>optional</em>) – Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">fig</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_solutions">
<code class="sig-name descname">plot_solutions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fig</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_solutions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_solutions" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the solution trajectories.</p>
<p>For each trajectory (nr_pools+1) a new subplot is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fig</strong> (<em>Matplotlib figure</em>) – The fig to which the subplots are added.</p></li>
<li><p><strong>fontsize</strong> (<em>float</em><em>, </em><em>optional</em>) – Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.
Instead <code class="docutils literal notranslate"><span class="pre">fig</span></code> is changed in place.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_func">
<code class="sig-name descname">pool_age_densities_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_densities_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function that takes an array of ages and returns the
pool age densities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math notranslate nohighlight">\(t_0\)</span> for every pool.
Defaults to None, meaning that all initial mass is considered
to have zero age.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python function <code class="docutils literal notranslate"><span class="pre">p</span></code>: <code class="docutils literal notranslate"><span class="pre">p(ages)</span></code> returns a <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>
len(ages) x len(times) x nr_pools containing the pool contents
with the respective ages at the respective times, where <code class="docutils literal notranslate"><span class="pre">ages</span></code>
is a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_single_value">
<code class="sig-name descname">pool_age_densities_single_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_densities_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the pool age densities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math notranslate nohighlight">\(t_0\)</span>. Defaults to None, meaning that all
initial mass is considered to have zero age.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python function <code class="docutils literal notranslate"><span class="pre">p_sv</span></code>: <code class="docutils literal notranslate"><span class="pre">p_sv(a,</span> <span class="pre">t)</span></code> returns <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">numpy.array</span></code>
containing the pool contents with age <code class="docutils literal notranslate"><span class="pre">a</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distribution_quantiles_pool_by_ode">
<code class="sig-name descname">pool_age_distribution_quantiles_pool_by_ode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quantile</span></em>, <em class="sig-param"><span class="n">pool</span></em>, <em class="sig-param"><span class="n">start_age_densities</span></em>, <em class="sig-param"><span class="n">F0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">check_time_indices</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_distribution_quantiles_pool_by_ode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distribution_quantiles_pool_by_ode" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pool age distribution quantile over the time grid for one
single pool.</p>
<p>The compuation is done by solving an ODE as soon as the pool is
nonempty.
The initial value is obtained by computing the generalized inverse of
the pool age distribution by a numerical root search algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantile</strong> (<em>between 0 and 1</em>) – The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal notranslate"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</p></li>
<li><p><strong>pool</strong> (<em>int</em>) – The number of the pool for which the age quantile is to
be computed.</p></li>
<li><p><strong>start_age_densities</strong> (<em>Python function</em>) – A function of age
that returns a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math notranslate nohighlight">\(t_0\)</span>.</p></li>
<li><p><strong>F0</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age that returns a
<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math notranslate nohighlight">\(t_0\)</span>.
It is fastest to provide <code class="docutils literal notranslate"><span class="pre">F0</span></code>, otherwise <code class="docutils literal notranslate"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>check_time_indices</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Indices of the tiime</dt><dd><p>grid on which the ODE result are checked against an explicit
solution computed by the pseudo-inverse of the cumulative</p>
</dd>
</dl>
<p>distribution function.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> in which case no check is performed.</p>
</p></li>
<li><p><strong>kwargs</strong> – Passed to the <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code>, e.g., <code class="docutils literal notranslate"><span class="pre">method</span></code>
or <code class="docutils literal notranslate"><span class="pre">max_step</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.discrete_model_run_14C.Error" title="CompartmentalSystems.discrete_model_run_14C.Error"><strong>Error</strong></a> – If <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(len(times)) The computed quantile values over the
time grid.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distributions_quantiles">
<code class="sig-name descname">pool_age_distributions_quantiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quantile</span></em>, <em class="sig-param"><span class="n">start_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_age_densities</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">F0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'brentq'</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_distributions_quantiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distributions_quantiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pool age distribution quantiles over the time grid.</p>
<p>The compuation is done by computing the generalized inverse of the
respective cumulative distribution using a nonlinear root search
algorithm. Depending on how slowly the cumulative distribution can be
computed, this can take quite some time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantile</strong> (<em>between 0 and 1</em>) – The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal notranslate"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</p></li>
<li><p><strong>start_values</strong> (<em>numpy.ndarray</em><em>, </em><em>len</em><em>(</em><em>times</em><em>) </em><em>x nr_pools</em><em>, </em><em>optional</em>) – For each pool an array over the time grid of start values for
the nonlinear search.
Good values are slighty greater than the solution values.
Defaults to an array of zeros for each pool</p></li>
<li><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age
that returns a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math notranslate nohighlight">\(t_0\)</span>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>F0</strong> (<em>Python function</em>) – A function of age that returns a
<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math notranslate nohighlight">\(t_0\)</span>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The method that is used for finding the roots of a
nonlinear function. Either ‘brentq’ or ‘newton’.
Defaults to ‘brentq’.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal notranslate"><span class="pre">1e-01</span></code> might already be fine.
Defaults to <code class="docutils literal notranslate"><span class="pre">1e-08</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.discrete_model_run_14C.Error" title="CompartmentalSystems.discrete_model_run_14C.Error"><strong>Error</strong></a> – If both <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code> and <code class="docutils literal notranslate"><span class="pre">F0</span></code> are <code class="docutils literal notranslate"><span class="pre">None</span></code>.
    One must be given.
    It is fastest to provide <code class="docutils literal notranslate"><span class="pre">F0</span></code>, otherwise <code class="docutils literal notranslate"><span class="pre">F0</span></code> will be
    computed by numerical integration of <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>(len(times) x nr_pools)
The computed quantile values over the time-pool grid.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distributions_quantiles_by_ode">
<code class="sig-name descname">pool_age_distributions_quantiles_by_ode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quantile</span></em>, <em class="sig-param"><span class="n">start_age_densities</span></em>, <em class="sig-param"><span class="n">F0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">check_time_indices</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_distributions_quantiles_by_ode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distributions_quantiles_by_ode" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pool age distribution quantiles over the time grid.</p>
<p>The compuation is done by solving an ODE for each pool as soon as the
pool is nonempty.
The initial value is obtained by computing the generalized inverse of
the pool age distribution by a numerical root search algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantile</strong> (<em>between 0 and 1</em>) – The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal notranslate"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</p></li>
<li><p><strong>start_age_densities</strong> (<em>Python function</em>) – A function of age
that returns a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math notranslate nohighlight">\(t_0\)</span>.</p></li>
<li><p><strong>F0</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age that returns a
<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math notranslate nohighlight">\(t_0\)</span>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.
It is fastest to provide <code class="docutils literal notranslate"><span class="pre">F0</span></code>, otherwise <code class="docutils literal notranslate"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code>.</p></li>
<li><p><strong>check_time_indices</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Indices of the tiime</dt><dd><p>grid on which the ODE result are checked against an explicit
solution computed by the pseudo-inverse of the cumulative</p>
</dd>
</dl>
<p>distribution function.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> in which case no check is performed.</p>
</p></li>
<li><p><strong>kwargs</strong> – Passed to the <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code>, e.g., <code class="docutils literal notranslate"><span class="pre">method</span></code>
or <code class="docutils literal notranslate"><span class="pre">max_step</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(len(times) x nr_pools) The computed quantile values
over the time-pool grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.save_density_csv">
<code class="sig-name descname">save_density_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">density</span></em>, <em class="sig-param"><span class="n">ages</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.save_density_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.save_density_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Save density values over age-time grid to csv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The name of the csv file to be written.</p></li>
<li><p><strong>density</strong> (<em>numpy.ndarray len</em><em>(</em><em>ages</em><em>) </em><em>x len</em><em>(</em><em>times</em><em>)</em>) – The density values
to be saved over the age-time grid.</p></li>
<li><p><strong>ages</strong> (<em>numpy.array</em>) – The ages corresponding to the indices in the
zeroth dimension of the density ndarray.</p></li>
<li><p><strong>times</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – An alternative time grid to be used.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> which means that the original time grid is
going to be used.</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.save_pools_and_system_density_csv">
<code class="sig-name descname">save_pools_and_system_density_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">pool_age_densities</span></em>, <em class="sig-param"><span class="n">system_age_density</span></em>, <em class="sig-param"><span class="n">ages</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.save_pools_and_system_density_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.save_pools_and_system_density_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the pool and system age densities to a csv file.</p>
<p>The system value will be coded into pool number -1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The name of the csv file to be written.</p></li>
<li><p><strong>pool_age_densites</strong> (<em>numpy.ndarray len</em><em>(</em><em>ages</em><em>) </em><em>x len</em><em>(</em><em>times</em><em>) </em><em>x nr_pools</em>) – The pool age density values.</p></li>
<li><p><strong>system_age_density</strong> (<em>numpy.ndarray len</em><em>(</em><em>ages</em><em>) </em><em>x len</em><em>(</em><em>times</em><em>)</em>) – The system age density values.</p></li>
<li><p><strong>ages</strong> (<em>numpy.array</em>) – The ages that correspond to the indices in the
zeroth dimension of the density arrays.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.save_pools_and_system_value_csv">
<code class="sig-name descname">save_pools_and_system_value_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">pools_ndarr</span></em>, <em class="sig-param"><span class="n">system_arr</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.save_pools_and_system_value_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.save_pools_and_system_value_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Save pool and system values to a csv file.</p>
<p>Values could be the mean age, for example. One dimension less than a
density.
The system value will be coded into pool number -1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The name of the csv file to be written.</p></li>
<li><p><strong>pools_ndarr</strong> (<em>numpy.ndarray len</em><em>(</em><em>times</em><em>) </em><em>x nr_pools</em>) – The values to be
saved over the time-pool grid.</p></li>
<li><p><strong>system_arr</strong> (<em>numpy.array</em>) – The values over the time grid
corresponding to the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.save_state_transition_operator_cache">
<code class="sig-name descname">save_state_transition_operator_cache</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.save_state_transition_operator_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.save_state_transition_operator_cache" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.save_value_csv">
<code class="sig-name descname">save_value_csv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">arr</span></em>, <em class="sig-param"><span class="n">times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.save_value_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.save_value_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Save values over the time grid to a csv file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The name of the csv file to be written.</p></li>
<li><p><strong>arr</strong> (<em>numpy.array</em>) – The values to be saved over the time grid.</p></li>
<li><p><strong>times</strong> (<em>np.array</em><em>, </em><em>optional</em>) – The time grid to be used.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> in which case the orginal time grid
is used.</p></li>
</ul>
</dd>
</dl>
<p>Returns:</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs">
<code class="sig-name descname">sol_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.sol_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of linearly interpolated solution functions per pool.
:returns:</p>
<blockquote>
<div><dl class="simple">
<dt>List of Python functions <code class="docutils literal notranslate"><span class="pre">[f[i]]</span></code>, where <code class="docutils literal notranslate"><span class="pre">f[i](t)</span></code> returns</dt><dd><p>pool i’s content at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs_dict_by_name">
<code class="sig-name descname">sol_funcs_dict_by_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.sol_funcs_dict_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs_dict_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return linearly interpolated solution functions. as a dictionary indexed by the name (string) of the
state variables</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs_dict_by_symbol">
<code class="sig-name descname">sol_funcs_dict_by_symbol</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.sol_funcs_dict_by_symbol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs_dict_by_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return linearly interpolated solution functions as a dictionary
indexed by the symbols of the state variables</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs_old">
<code class="sig-name descname">sol_funcs_old</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.sol_funcs_old"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Return linearly interpolated solution functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Python function <code class="docutils literal notranslate"><span class="pre">f</span></code>: <code class="docutils literal notranslate"><span class="pre">f(t)</span></code> returns a numpy.array containing the
pool contents at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alternative_start_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the model and return a solution grid. If the solution has been computed previously (even by other methods) the cached result will be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alternative_start_values</strong> (<em>numpy.array</em>) – If not given,
the original start_values are used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(times) x nr_pools, contains the pool contents
at the times given in the time grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.solve_func">
<code class="sig-name descname">solve_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alternative_start_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.solve_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.solve_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the model and return a function of time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alternative_start_values</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – If not given, the
original <code class="docutils literal notranslate"><span class="pre">start_values</span></code> are used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python function <code class="docutils literal notranslate"><span class="pre">f</span></code>: <code class="docutils literal notranslate"><span class="pre">f(t)</span></code> is a numpy.array that containts the
pool contents at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.solve_old">
<code class="sig-name descname">solve_old</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alternative_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alternative_start_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.solve_old"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.solve_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the model and return a solution grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alternative_times</strong> (<em>numpy.array</em>) – If not given, the original time
grid is used.</p></li>
<li><p><strong>alternative_start_values</strong> (<em>numpy.array</em>) – If not given,
the original start_values are used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>len(times) x nr_pools, contains the pool contents
at the times given in the time grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.solve_single_value_old">
<code class="sig-name descname">solve_single_value_old</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alternative_start_values</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.solve_single_value_old"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.solve_single_value_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the model and return a function of time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>alternative_start_values</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – If not given, the
original <code class="docutils literal notranslate"><span class="pre">start_values</span></code> are used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python function <code class="docutils literal notranslate"><span class="pre">f</span></code>: <code class="docutils literal notranslate"><span class="pre">f(t)</span></code> is a numpy.array that containts the
pool contents at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density">
<code class="sig-name descname">system_age_density</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pool_age_densities</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the system age density based on the given pool age densities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>pool_age_densites</strong> (<em>numpy.ndarray len</em><em>(</em><em>ages</em><em>) </em><em>x len</em><em>(</em><em>times</em><em>) </em><em>x nr_pools</em>) – The pool age density values.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(len(ages) x len(times)) The sum of the pool age
contents over all pools.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density_single_value">
<code class="sig-name descname">system_age_density_single_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_age_densities</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_density_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the system age density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math notranslate nohighlight">\(t_0\)</span>.
Defaults to None, meaning that all initial mass is considered
to have zero age.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Python function <code class="docutils literal notranslate"><span class="pre">sys_p_sv</span></code>: <code class="docutils literal notranslate"><span class="pre">sys_p_sv(a,</span> <span class="pre">t)</span></code> returns the system
content with age <code class="docutils literal notranslate"><span class="pre">a</span></code> at time <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_distribution_quantiles">
<code class="sig-name descname">system_age_distribution_quantiles</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quantile</span></em>, <em class="sig-param"><span class="n">start_values</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">start_age_densities</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">F0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'brentq'</span></em>, <em class="sig-param"><span class="n">tol</span><span class="o">=</span><span class="default_value">1e-08</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_distribution_quantiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_distribution_quantiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return system age distribution quantiles over the time grid.</p>
<p>The compuation is done by computing the generalized inverse of the
respective cumulative distribution using a nonlinear root search
algorithm. Depending on how slowly the cumulative distribution can be
computed, this can take quite some time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantile</strong> (<em>between 0 and 1</em>) – The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal notranslate"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</p></li>
<li><p><strong>start_values</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – An array over the time grid of
start values for the nonlinear search.
Good values are slighty greater than the solution values.
Must have the same length as <code class="docutils literal notranslate"><span class="pre">times</span></code>.
Defaults to an array of zeros.</p></li>
<li><p><strong>start_age_densities</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age
that returns a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math notranslate nohighlight">\(t_0\)</span>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>F0</strong> (<em>Python function</em>) – A function of age that returns a
<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math notranslate nohighlight">\(t_0\)</span>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>method</strong> (<em>str</em>) – The method that is used for finding the roots of a
nonlinear function. Either ‘brentq’ or ‘newton’.
Defaults to ‘brentq’.</p></li>
<li><p><strong>tol</strong> (<em>float</em>) – The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal notranslate"><span class="pre">1e-01</span></code> might already be fide.
Defaults to <code class="docutils literal notranslate"><span class="pre">1e-08</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.discrete_model_run_14C.Error" title="CompartmentalSystems.discrete_model_run_14C.Error"><strong>Error</strong></a> – If both <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code> and <code class="docutils literal notranslate"><span class="pre">F0</span></code> are <code class="docutils literal notranslate"><span class="pre">None</span></code>.
    One must be given.
    It is fastest to provide <code class="docutils literal notranslate"><span class="pre">F0</span></code>, otherwise <code class="docutils literal notranslate"><span class="pre">F0</span></code> will be
    computed by numerical integration of <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The computed quantile values over the time grid.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_distribution_quantiles_by_ode">
<code class="sig-name descname">system_age_distribution_quantiles_by_ode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quantile</span></em>, <em class="sig-param"><span class="n">start_age_densities</span></em>, <em class="sig-param"><span class="n">F0</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">check_time_indices</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_distribution_quantiles_by_ode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_distribution_quantiles_by_ode" title="Permalink to this definition">¶</a></dt>
<dd><p>Return system age distribution quantile over the time grid.</p>
<p>The compuation is done by solving an ODE as soon as the system is
nonempty.
The initial value is obtained by computing the generalized inverse of
the system age distribution by a numerical root search algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantile</strong> (<em>between 0 and 1</em>) – The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal notranslate"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</p></li>
<li><p><strong>pool</strong> (<em>int</em>) – The number of the pool for which the age quantile is to
be computed.</p></li>
<li><p><strong>start_age_densities</strong> (<em>Python function</em>) – A function of age
that returns a <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math notranslate nohighlight">\(t_0\)</span>.</p></li>
<li><p><strong>F0</strong> (<em>Python function</em><em>, </em><em>optional</em>) – A function of age that returns a
<code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math notranslate nohighlight">\(t_0\)</span>.
It is fastest to provide <code class="docutils literal notranslate"><span class="pre">F0</span></code>, otherwise <code class="docutils literal notranslate"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code>.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>check_time_indices</strong> (<em>numpy.array</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>Indices of the tiime</dt><dd><p>grid on which the ODE result are checked against an explicit
solution computed by the pseudo-inverse of the cumulative</p>
</dd>
</dl>
<p>distribution function.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> in which case no check is performed.</p>
</p></li>
<li><p><strong>kwargs</strong> – Passed to the <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code>, e.g., <code class="docutils literal notranslate"><span class="pre">method</span></code>
or <code class="docutils literal notranslate"><span class="pre">max_step</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.discrete_model_run_14C.Error" title="CompartmentalSystems.discrete_model_run_14C.Error"><strong>Error</strong></a> – If <code class="docutils literal notranslate"><span class="pre">start_age_densities</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The computed quantile values over the time grid.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_moment">
<code class="sig-name descname">system_age_moment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">order</span></em>, <em class="sig-param"><span class="n">start_age_moments</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_moment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal notranslate"><span class="pre">order</span></code> th system age moment vector over the time grid
by an ODE system.</p>
<p>The pool age moments are computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">age_moment_vector()</span></code></a> and then
weighted corresponding to the pool contents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em>) – The order of the pool age moments to be computed.</p></li>
<li><p><strong>start_age_moments</strong> (<em>numpy.ndarray order x nr_pools</em><em>, </em><em>optional</em>) – Given initial age moments up to the order of interest.
Can possibly be computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities"><code class="xref py py-func docutils literal notranslate"><span class="pre">moments_from_densities()</span></code></a>.
Defaults to None assuming zero initial ages.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <code class="docutils literal notranslate"><span class="pre">order</span></code> th system age moment over the time grid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.to_14C_explicit">
<code class="sig-name descname">to_14C_explicit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">start_values_14C</span></em>, <em class="sig-param"><span class="n">Fa_func</span></em>, <em class="sig-param"><span class="n">decay_rate</span><span class="o">=</span><span class="default_value">0.0001209681</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.to_14C_explicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.to_14C_explicit" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Construct and return a <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothModelRun</span></code></a> instance that</dt><dd><p>models the 14C component additional to the original model run.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_values_14C</strong> (<em>numpy.nd_array</em><em>, </em><em>nr_pools</em>) – 14C start values.</p></li>
<li><p><strong>Fa_func</strong> (<em>func</em><em>(</em><em>t</em><em>)</em>) – returns atmospheric fraction to be multiplied with the input vector</p></li>
<li><p><strong>rate</strong> (<em>decay</em>) – The decay rate to be used, defaults to
<code class="docutils literal notranslate"><span class="pre">0.0001209681</span></code> (daily).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothModelRun</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.x_solve_func_skew">
<code class="sig-name descname">x_solve_func_skew</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.x_solve_func_skew"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.x_solve_func_skew" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.smooth_model_run_14C">
<span id="compartmentalsystems-smooth-model-run-14c-module"></span><h2>CompartmentalSystems.smooth_model_run_14C module<a class="headerlink" href="#module-CompartmentalSystems.smooth_model_run_14C" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="CompartmentalSystems.smooth_model_run_14C.Error">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.smooth_model_run_14C.</code><code class="sig-name descname">Error</code><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.smooth_model_run_14C.</code><code class="sig-name descname">SmoothModelRun_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">smr</span></em>, <em class="sig-param"><span class="n">start_values_14C</span></em>, <em class="sig-param"><span class="n">Fa_func</span></em>, <em class="sig-param"><span class="n">decay_rate</span><span class="o">=</span><span class="default_value">0.0001209681</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompartmentalSystems.smooth_model_run.SmoothModelRun</span></code></a></p>
<dl class="simple">
<dt>Construct and return a <a class="reference internal" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C" title="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothModelRun_14C</span></code></a> instance that</dt><dd><p>models the 14C component of the original model run.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smr</strong> (<a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><em>SmoothModelRun</em></a>) – original model run</p></li>
<li><p><strong>start_values_14C</strong> (<em>numpy.nd_array</em><em>, </em><em>nr_pools</em>) – 14C start values.</p></li>
<li><p><strong>Fa_func</strong> (<em>func</em><em>(</em><em>t</em><em>)</em>) – returns atmospheric fraction to be
multiplied with the input vector</p></li>
<li><p><strong>rate</strong> (<em>decay</em>) – The decay rate to be used,
defaults to <code class="docutils literal notranslate"><span class="pre">0.0001209681</span></code> (daily).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_gross_external_input_vector_Delta_14C">
<code class="sig-name descname">acc_gross_external_input_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.acc_gross_external_input_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_gross_external_input_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_gross_external_output_vector">
<code class="sig-name descname">acc_gross_external_output_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.acc_gross_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_gross_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vectors of accumulated external outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>len(times)-1 x nr_pools</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_gross_external_output_vector_Delta_14C">
<code class="sig-name descname">acc_gross_external_output_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.acc_gross_external_output_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_gross_external_output_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_gross_internal_flux_matrix_Delta_14C">
<code class="sig-name descname">acc_gross_internal_flux_matrix_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.acc_gross_internal_flux_matrix_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_gross_internal_flux_matrix_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_net_external_input_vector_Delta_14C">
<code class="sig-name descname">acc_net_external_input_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.acc_net_external_input_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_net_external_input_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_net_external_output_vector">
<code class="sig-name descname">acc_net_external_output_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.acc_net_external_output_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_net_external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_net_external_output_vector_Delta_14C">
<code class="sig-name descname">acc_net_external_output_vector_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.acc_net_external_output_vector_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_net_external_output_vector_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_net_internal_flux_matrix_Delta_14C">
<code class="sig-name descname">acc_net_internal_flux_matrix_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_times</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.acc_net_internal_flux_matrix_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.acc_net_internal_flux_matrix_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.external_output_flux_funcs">
<code class="sig-name descname">external_output_flux_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.external_output_flux_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.external_output_flux_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of the external output fluxes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">{key:</span> <span class="pre">func}</span></code> with <code class="docutils literal notranslate"><span class="pre">key</span></code> representing the pool from which
the output comes and <code class="docutils literal notranslate"><span class="pre">func</span></code> a function of time that returns a
<code class="docutils literal notranslate"><span class="pre">float</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.external_output_vector">
<em class="property">property </em><code class="sig-name descname">external_output_vector</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grid of external output vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>len(times) x nr_pools</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.solve_Delta_14C">
<code class="sig-name descname">solve_Delta_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#SmoothModelRun_14C.solve_Delta_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.SmoothModelRun_14C.solve_Delta_14C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.smooth_model_run_14C.pfile_C14Atm_NH">
<code class="sig-prename descclassname">CompartmentalSystems.smooth_model_run_14C.</code><code class="sig-name descname">pfile_C14Atm_NH</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_model_run_14C.html#pfile_C14Atm_NH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run_14C.pfile_C14Atm_NH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.smooth_reservoir_model">
<span id="compartmentalsystems-smooth-reservoir-model-module"></span><h2>CompartmentalSystems.smooth_reservoir_model module<a class="headerlink" href="#module-CompartmentalSystems.smooth_reservoir_model" title="Permalink to this headline">¶</a></h2>
<p>Module for symbolical treatment of smooth reservoir models.</p>
<p>This module handles the symbolic treatment of compartmental/reservoir/pool
models.
It does not deal with numerical computations and model simulations,
but rather defines the underlying structure of the respective model.</p>
<p>All fluxes or matrix entries are supposed to be SymPy expressions.
<em>Smooth</em> means that no <code class="docutils literal notranslate"><span class="pre">Piecewise</span></code> or <code class="docutils literal notranslate"><span class="pre">DiracDelta</span></code> functions should be
involved in the model description.</p>
<p>Counting of compartment/pool/reservoir numbers starts at zero and the
total number of pools is <span class="math notranslate nohighlight">\(d\)</span>.</p>
<dl class="py exception">
<dt id="CompartmentalSystems.smooth_reservoir_model.Error">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.smooth_reservoir_model.</code><code class="sig-name descname">Error</code><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.smooth_reservoir_model.</code><code class="sig-name descname">SmoothReservoirModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_vector</span></em>, <em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">input_fluxes</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">output_fluxes</span><span class="o">=</span><span class="default_value">{}</span></em>, <em class="sig-param"><span class="n">internal_fluxes</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>General class of smooth reservoir models.</p>
<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.state_vector">
<code class="sig-name descname">state_vector</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.state_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>The model’s state vector
<span class="math notranslate nohighlight">\(x\)</span>.
Its entries are SymPy symbols.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SymPy dx1-matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.state_variables">
<code class="sig-name descname">state_variables</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.state_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of the variables in the state vector.
Its entries are of type <code class="docutils literal notranslate"><span class="pre">str</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.time_symbol">
<code class="sig-name descname">time_symbol</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.time_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>The model’s time symbol.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SymPy symbol</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.input_fluxes">
<code class="sig-name descname">input_fluxes</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.input_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>The model’s external input fluxes.
<code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">flux1,</span> <span class="pre">key2:</span> <span class="pre">flux2}</span></code> with <code class="docutils literal notranslate"><span class="pre">key</span></code> the pool number and
<code class="docutils literal notranslate"><span class="pre">flux</span></code> a SymPy expression for the influx.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.output_fluxes">
<code class="sig-name descname">output_fluxes</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.output_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>The model’s external output fluxes.
<code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">flux1,</span> <span class="pre">key2:</span> <span class="pre">flux2}</span></code> with <code class="docutils literal notranslate"><span class="pre">key</span></code> the pool number and
<code class="docutils literal notranslate"><span class="pre">flux</span></code> a SymPy expression for the outflux.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.internal_fluxes">
<code class="sig-name descname">internal_fluxes</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.internal_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>The model’s internal_fluxes.
<code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">flux1,</span> <span class="pre">key2:</span> <span class="pre">flux2}</span></code> with <code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">=</span> <span class="pre">(pool_from,</span> <span class="pre">pool_to)</span></code>
and <em>flux</em> a SymPy expression for the flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.F">
<em class="property">property </em><code class="sig-name descname">F</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.F" title="Permalink to this definition">¶</a></dt>
<dd><p>The right hand side of the differential equation
<span class="math notranslate nohighlight">\(\dot{x}=B\,x+u\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SymPy dx1-matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.age_moment_system">
<code class="sig-name descname">age_moment_system</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_order</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.age_moment_system"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.age_moment_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the age moment system of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>max_order</strong> (<em>int</em>) – The maximum order up to which the age moment
system is created (1 for the mean).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>extended_state (SymPy d*(max_order+1)x1-matrix): The extended</dt><dd><p>state vector of the age moment system.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>extended_rhs (SymPy d*(max_order+1)x1-matrix): The extended right</dt><dd><p>hand side of the age moment ODE.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.all_fluxes">
<code class="sig-name descname">all_fluxes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.all_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.all_fluxes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.compartmental_matrix">
<em class="property">property </em><code class="sig-name descname">compartmental_matrix</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.compartmental_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math notranslate nohighlight">\(B\)</span> from
<span class="math notranslate nohighlight">\(\dot{x} = B\,x+u\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><span class="math notranslate nohighlight">\(B = \xi\,T\,N\)</span></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>SymPy dxd-matrix</p>
</dd>
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SymPy Matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.external_inputs">
<em class="property">property </em><code class="sig-name descname">external_inputs</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.external_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector of external inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SymPy dx1-matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.external_outputs">
<em class="property">property </em><code class="sig-name descname">external_outputs</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.external_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector of external outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SymPy dx1-matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.figure">
<code class="sig-name descname">figure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">figure_size</span><span class="o">=</span><span class="default_value">7, 7</span></em>, <em class="sig-param"><span class="n">logo</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">thumbnail</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.figure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.figure" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a figure representing the reservoir model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figure_size</strong> (<em>2-tuple</em><em>, </em><em>optional</em>) – Width and height of the figure.
Defaults to (7,7).</p></li>
<li><p><strong>logo</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, figure_size set to (3,3), no legend,
smaller font size. Defaults to False.</p></li>
<li><p><strong>thumbnail</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, produce a very small version,
no legend. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure representing the reservoir model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Matplotlib figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.free_symbols">
<em class="property">property </em><code class="sig-name descname">free_symbols</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.free_symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the superset of the free symbols of the flux expressions including the state variables.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.from_B_u">
<em class="property">classmethod </em><code class="sig-name descname">from_B_u</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_vector</span></em>, <em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">B</span></em>, <em class="sig-param"><span class="n">u</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel">CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel</a><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.from_B_u"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.from_B_u" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Construct and return a <a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothReservoirModel</span></code></a> instance from</dt><dd><p><span class="math notranslate nohighlight">\(\dot{x}=B\,x+u\)</span></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_vector</strong> (<em>SymPy dx1-matrix</em>) – The model’s state vector
<span class="math notranslate nohighlight">\(x\)</span>.
Its entries are SymPy symbols.</p></li>
<li><p><strong>time_symbol</strong> (<em>SymPy symbol</em>) – The model’s time symbol.</p></li>
<li><p><strong>B</strong> (<em>SymPy dxd-matrix</em>) – The model’s compartmental matrix.</p></li>
<li><p><strong>u</strong> (<em>SymPy dx1-matrix</em>) – The model’s external input vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothReservoirModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.from_state_variable_indexed_fluxes">
<em class="property">classmethod </em><code class="sig-name descname">from_state_variable_indexed_fluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_vector</span></em>, <em class="sig-param"><span class="n">time_symbol</span></em>, <em class="sig-param"><span class="n">input_fluxes</span></em>, <em class="sig-param"><span class="n">output_fluxes</span></em>, <em class="sig-param"><span class="n">internal_fluxes</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel">CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel</a><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.from_state_variable_indexed_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.from_state_variable_indexed_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an instance of SmoothReservoirModel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_vector</strong> (<em>SymPy dx1-matrix</em>) – The model’s state vector
<span class="math notranslate nohighlight">\(x\)</span>.
Its entries are SymPy symbols.</p></li>
<li><p><strong>time_symbol</strong> (<em>SymPy symbol</em>) – The model’s time symbol.</p></li>
<li><p><strong>input_fluxes</strong> (<em>dict</em>) – The model’s external input fluxes.
<code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">flux1,</span> <span class="pre">key2:</span> <span class="pre">flux2}</span></code> with <code class="docutils literal notranslate"><span class="pre">key</span></code> the symbol of the target pool. (as used in the state vector)
and <code class="docutils literal notranslate"><span class="pre">flux</span></code> a SymPy expression for the influx.</p></li>
<li><p><strong>output_fluxes</strong> (<em>dict</em>) – The model’s external output fluxes.
<code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">flux1,</span> <span class="pre">key2:</span> <span class="pre">flux2}</span></code> with <code class="docutils literal notranslate"><span class="pre">key</span></code> the symbols for the source pool (as used in the state vector)
and <code class="docutils literal notranslate"><span class="pre">flux</span></code> a SymPy expression for the outflux.</p></li>
<li><p><strong>internal_fluxes</strong> (<em>dict</em>) – The model’s internal_fluxes.
<code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">flux1,</span> <span class="pre">key2:</span> <span class="pre">flux2}</span></code> with
<code class="docutils literal notranslate"><span class="pre">key</span> <span class="pre">=</span> <span class="pre">(source</span> <span class="pre">pool</span> <span class="pre">symbol,</span> <span class="pre">target</span> <span class="pre">pool</span> <span class="pre">symbol)</span></code> and <code class="docutils literal notranslate"><span class="pre">flux</span></code> a SymPy expression
for the flux.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">SmoothReservoirModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.function_expressions">
<em class="property">property </em><code class="sig-name descname">function_expressions</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.function_expressions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the superset of the free symbols of the flux expressions.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.internal_inputs">
<em class="property">property </em><code class="sig-name descname">internal_inputs</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.internal_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector of internal inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SymPy dx1-matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.internal_outputs">
<em class="property">property </em><code class="sig-name descname">internal_outputs</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.internal_outputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector of internal outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SymPy dx1-matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.is_compartmental">
<em class="property">property </em><code class="sig-name descname">is_compartmental</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.is_compartmental" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns checks that all fluxes are nonnegative
at the time of implementation this functionality sympy did not support
relations in predicates yet.
So while the following works:</p>
<dl class="simple">
<dt>with assuming(Q.positive(x) &amp; Q.positive(y)):</dt><dd><p>print(ask(Q.positive(2*x+y)</p>
</dd>
</dl>
<p>it is not possible yet to get a meaningful answer to:</p>
<dl class="simple">
<dt>with assuming(Q.is_true(x&gt;0) &amp; Q.is_true(y&gt;0)):</dt><dd><p>print(ask(Q.positive(2*x+y)</p>
</dd>
</dl>
<p>We therefore cannot implement more elaborate assumptions like k_1-(a_12+a_32)&gt;=0
but still can assume all the state_variables and the time_symbol to be nonnegative
Therefore we can check the compartmental_property best after all paramater value have been substituted.
At the moment the function throws an exception if this is not the case.</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.is_linear">
<em class="property">property </em><code class="sig-name descname">is_linear</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.is_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if we can make SURE that the model is linear by checking that the jacobian is not state dependent.
Note that external numerical functions of state variables are represented as sympy.Function f(x_1,x_2,…,t)
Sympy will consider the derivative of math:<cite>df/dx_i</cite> with respect to state variable math:<cite>x_i</cite> as function math:<cite>g(x_1, x_2,…)</cite> too, since it can not exclude this possibility if we know f only numerically.
In consequence this method will return False even if the numerical implementation of f IS linear in math:<cite>x_1,x_2,…</cite> .
To avoid this situation you can just reformulate linear external functions math:<cite>f(x_1,x_2,…,t)</cite> as linear combinations
of state independent external functions math:<cite>f(x_1,x_2,…,t)=g_1(t)x_1+g_2(t)x_2+…</cite> so that sympy can detect the linearity.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>‘True’, ‘False’</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.is_state_dependent">
<code class="sig-name descname">is_state_dependent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">expr</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.is_state_dependent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.is_state_dependent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.jacobian">
<em class="property">property </em><code class="sig-name descname">jacobian</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.jacobian" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.no_input_model">
<em class="property">property </em><code class="sig-name descname">no_input_model</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.no_input_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.nr_pools">
<em class="property">property </em><code class="sig-name descname">nr_pools</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.nr_pools" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of pools involved in the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.plot_pools_and_fluxes">
<code class="sig-name descname">plot_pools_and_fluxes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span></em>, <em class="sig-param"><span class="n">mutation_scale</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">fontsize</span><span class="o">=</span><span class="default_value">24</span></em>, <em class="sig-param"><span class="n">thumbnail</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">legend</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.plot_pools_and_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.plot_pools_and_fluxes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.port_controlled_Hamiltonian_representation">
<code class="sig-name descname">port_controlled_Hamiltonian_representation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.port_controlled_Hamiltonian_representation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.port_controlled_Hamiltonian_representation" title="Permalink to this definition">¶</a></dt>
<dd><p>tuple: <span class="math notranslate nohighlight">\(J, R, N, x, u\)</span> from
<span class="math notranslate nohighlight">\(\dot{x} = [J(x)-R(x)] \frac{\partial}{\partial x}H+u\)</span>.
with <span class="math notranslate nohighlight">\(H=\sum_i x_i \implies \frac{\partial}{\partial x}H =(1,1,...,1)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>J (skew symmetric SymPy dxd-matrix) of internal fluxbalances:
<span class="math notranslate nohighlight">\(J_{i,j}=r_{j,i}-r_{i,j}\)</span></p></li>
<li><p>Q (SymPy dxd-matrix): Diagonal matrix describing the dissipation
rates (outfluxes).</p></li>
<li><p>x (SymPy dx1-matrix): The model’s state vector.</p></li>
<li><p>u (SymPy dx1-matrix): The model’s external input vector.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.state_variable_set">
<em class="property">property </em><code class="sig-name descname">state_variable_set</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.state_variable_set" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.steady_states">
<code class="sig-name descname">steady_states</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par_set</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.steady_states"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.steady_states" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.subs">
<code class="sig-name descname">subs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parameter_dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.subs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new instance of class: <cite>SmoothReservoirModel</cite> with all parameters in the parameter_dict replaced
by their values by calling subs on all the flux expressions.
:param parameter_dict: A dictionary with the structure {parameter_symbol:parameter_value,….}</p>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.xi_T_N_u_representation">
<code class="sig-name descname">xi_T_N_u_representation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">factor_out_xi</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model.html#SmoothReservoirModel.xi_T_N_u_representation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel.xi_T_N_u_representation" title="Permalink to this definition">¶</a></dt>
<dd><p>tuple: <span class="math notranslate nohighlight">\(\xi, T, N, x, u\)</span> from
<span class="math notranslate nohighlight">\(\dot{x} = \xi\,T\,N\,x+u\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>factor_out_xi</strong> (<em>bool</em>) – If true, xi is extracted from the matrix,
otherwise <span class="math notranslate nohighlight">\(xi=1\)</span> will be returned.
(Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>xi (SymPy number): Environmental coefficient.</p></li>
<li><dl class="simple">
<dt>T (SymPy dxd-matrix): Internal fluxes. Main diagonal contains</dt><dd><p><code class="docutils literal notranslate"><span class="pre">-1</span></code> entries.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>N (SymPy dxd-matrix): Diagonal matrix containing the decomposition</dt><dd><p>rates.</p>
</dd>
</dl>
</li>
<li><p>x (SymPy dx1-matrix): The model’s state vector.</p></li>
<li><p>u (SymPy dx1-matrix): The model’s external input vector.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.smooth_reservoir_model_14C">
<span id="compartmentalsystems-smooth-reservoir-model-14c-module"></span><h2>CompartmentalSystems.smooth_reservoir_model_14C module<a class="headerlink" href="#module-CompartmentalSystems.smooth_reservoir_model_14C" title="Permalink to this headline">¶</a></h2>
<p>Module for symbolical treatment of smooth 14C reservoir models.</p>
<p>This module handles the symbolic treatment of compartmental/reservoir/pool
models.
It does not deal with numerical computations and model simulations,
but rather defines the underlying structure of the respective model.</p>
<p>All fluxes or matrix entries are supposed to be SymPy expressions.
<em>Smooth</em> means that no <code class="docutils literal notranslate"><span class="pre">Piecewise</span></code> or <code class="docutils literal notranslate"><span class="pre">DiracDelta</span></code> functions should be
involved in the model description.</p>
<p>Counting of compartment/pool/reservoir numbers starts at zero and the
total number of pools is <span class="math notranslate nohighlight">\(d\)</span>.</p>
<dl class="py exception">
<dt id="CompartmentalSystems.smooth_reservoir_model_14C.Error">
<em class="property">exception </em><code class="sig-prename descclassname">CompartmentalSystems.smooth_reservoir_model_14C.</code><code class="sig-name descname">Error</code><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model_14C.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model_14C.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
</dd></dl>

<dl class="py class">
<dt id="CompartmentalSystems.smooth_reservoir_model_14C.SmoothReservoirModel_14C">
<em class="property">class </em><code class="sig-prename descclassname">CompartmentalSystems.smooth_reservoir_model_14C.</code><code class="sig-name descname">SmoothReservoirModel_14C</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">decay_symbol</span></em>, <em class="sig-param"><span class="n">Fa</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/smooth_reservoir_model_14C.html#SmoothReservoirModel_14C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model_14C.SmoothReservoirModel_14C" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel</span></code></a></p>
<p>General class of smooth 14C reservoir models.</p>
<dl class="py attribute">
<dt id="CompartmentalSystems.smooth_reservoir_model_14C.SmoothReservoirModel_14C.decay_symbol">
<code class="sig-name descname">decay_symbol</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model_14C.SmoothReservoirModel_14C.decay_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>The model’s decay symbol.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>SymPy symbol</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="CompartmentalSystems.smooth_reservoir_model_14C.SmoothReservoirModel_14C.output_fluxes_corrected_for_decay">
<em class="property">property </em><code class="sig-name descname">output_fluxes_corrected_for_decay</code><a class="headerlink" href="#CompartmentalSystems.smooth_reservoir_model_14C.SmoothReservoirModel_14C.output_fluxes_corrected_for_decay" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-CompartmentalSystems.start_distributions">
<span id="compartmentalsystems-start-distributions-module"></span><h2>CompartmentalSystems.start_distributions module<a class="headerlink" href="#module-CompartmentalSystems.start_distributions" title="Permalink to this headline">¶</a></h2>
<p>Module for computing age distributions or moments thereof to be used
as start distributions in subsequent simulations.</p>
<p>The age distribution at the start <span class="math notranslate nohighlight">\(t_0\)</span> is NOT
defined by the reservoir model and the initial values.
In fact EVERY age distribution can be chosen.
The implemented algorithms will correctly project it
to any time <span class="math notranslate nohighlight">\(t\)</span>.
This module provides several ways to generate such a distribution.</p>
<p>The functions containing the word ‘distributions’ usually return a vector
valued function of age representing pool wise age distributions that
are NOT normalized (Integrating of a vector component over all ages
yields the mass of the corresponding pool.)
, and in some cases a start vector that should be used in the subsequent
simulation for which the start age distribution is computed.</p>
<p>The functions containing the word ‘moments’ usually return an
array: moments x pools, containing the moments of the
pool ages .
representing the initial values needed for the moment systems e.g. the
mean of a start distribution to be used as initial value for the
mean age system. The length of the list is determined by the maximum order of
the moment system to be solved.
In some cases a consistent start vector is also provided.</p>
<div class="section" id="zero-start-age-distributions">
<h3>Zero start age distributions<a class="headerlink" href="#zero-start-age-distributions" title="Permalink to this headline">¶</a></h3>
<p>The distributions eaisiest to imagine are those that start with zero age:</p>
<ol class="arabic simple">
<li><p>The one with all pools empty provided by:
:py:meth:<a href="#id1"><span class="problematic" id="id2">`</span></a>start_age_distributions_from_zero_initial_content
and the respective moments by:
:py:meth:<a href="#id3"><span class="problematic" id="id4">`</span></a>start_age_moments_from_zero_initial_content</p></li>
<li><p>The one where all initial mass has age zero, provided by:
:py:meth:<a href="#id5"><span class="problematic" id="id6">`</span></a>start_age_distributions_from_zero_age_initial_content</p></li>
</ol>
</div>
<div class="section" id="established-distributions">
<h3>Established distributions<a class="headerlink" href="#established-distributions" title="Permalink to this headline">¶</a></h3>
<p>However for many applications one is interested in the CHANGE of an age
distribution that has been established over a (possibly infinitely) long period
of time.</p>
<ol class="arabic">
<li><p>Spinup</p>
<p>If we start the computation with all pools empty at time <span class="math notranslate nohighlight">\(0\)</span>
and run it till time <span class="math notranslate nohighlight">\(t = a_{max}\)</span>,
the resulting distribution will be non zero only in the interval
<span class="math notranslate nohighlight">\([0,a_{max}]\)</span>.
Such a distribution is provided by:
<a class="reference internal" href="#CompartmentalSystems.start_distributions.start_age_distributions_from_empty_spinup" title="CompartmentalSystems.start_distributions.start_age_distributions_from_empty_spinup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start_age_distributions_from_empty_spinup()</span></code></a>
and the moments by:
:py:meth:<a href="#id7"><span class="problematic" id="id8">`</span></a>start_age_moments_from_empty_spinup</p>
<p>Note that the finiteness of the spin up time has to be considered in the
choice of questions that can be asked.
For instance do not mistake the fact that the percentage
of material older than <span class="math notranslate nohighlight">\(a_{max}\)</span> will increase over
time for a property of the system, where it is actually a
property of the start distribution resulting from the finiteness
of the spin up time.</p>
</li>
<li><p>Distributions induced by steady states of the autonomous system, if those
exist.</p>
<p>If the term ‘established’ is taken to the limit of infinity one can look
for a related system that has persisted unchanged for all  times
<span class="math notranslate nohighlight">\(t&lt;t_0\)</span> and start with the age distribution created by such a system.
Such a distribution can only occur if the system has been in a steady
state. For a general non-autonomous system this is very unlikely that such
a steady state exist at all.
However we can consider a related autonomous system resulting from
‘freezing’ the general non-autonomous system at a time <span class="math notranslate nohighlight">\(t_0\)</span>.
Even for such an autonomous system it is uncertain if and where equilibria
exist. This has to be checked before an equilibrium age distribution can be
computed.
Actually the following steps have to be performed:</p>
<ol class="loweralpha simple">
<li><p>Transform the general nonlinear non-autonomous system
into a nonlinear autonomous system by freezing it
at time <span class="math notranslate nohighlight">\(t=t_0\)</span>:</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(u_0(x)=u(t_0,x_0)\)</span> and <span class="math notranslate nohighlight">\(B_0(x)=B(t_0,x_0)\)</span></p></li>
<li><p>Look for an equilibrium <span class="math notranslate nohighlight">\(x_{fix}\)</span> of the frozen system
such that <span class="math notranslate nohighlight">\(0=B_0(x_{fix})+u_0(x_{fix})\)</span>.
If the frozen system is linear the we can compute
the fixed point explicitly : <span class="math notranslate nohighlight">\(x_{fix}=B_0^{-1}u_0\)</span>.
In general the frozen system will be nonlinear and we will have to
look for the fixed point numerically.</p></li>
<li><p>Compute the age distribution of the system at equilibrium
<span class="math notranslate nohighlight">\(x_{fix}\)</span>.
This can be done using the formulas for linear
autonomous pool models. (At the fixed point the nonlinear system
is identical to a linear one. This is a special case of the general
idea of linearizing a nonlinear model with respect to a trajectory,
which in case of a fixed point is constant.)</p></li>
</ol>
<p>All these steps are performed by
<a class="reference internal" href="#CompartmentalSystems.start_distributions.start_age_distributions_from_steady_state" title="CompartmentalSystems.start_distributions.start_age_distributions_from_steady_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start_age_distributions_from_steady_state()</span></code></a>
and
<a class="reference internal" href="#CompartmentalSystems.start_distributions.start_age_moments_from_steady_state" title="CompartmentalSystems.start_distributions.start_age_moments_from_steady_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">start_age_moments_from_steady_state()</span></code></a>.</p>
<p>Note that <span class="math notranslate nohighlight">\(x_{fix}\)</span> is the compatible start vector that has to be
used along with this start distributions for the following computation.</p>
</li>
</ol>
<dl class="py function">
<dt id="CompartmentalSystems.start_distributions.compute_fixedpoint_numerically">
<code class="sig-prename descclassname">CompartmentalSystems.start_distributions.</code><code class="sig-name descname">compute_fixedpoint_numerically</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">t0</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/start_distributions.html#compute_fixedpoint_numerically"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.start_distributions.compute_fixedpoint_numerically" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.start_distributions.lapm_for_steady_state">
<code class="sig-prename descclassname">CompartmentalSystems.start_distributions.</code><code class="sig-name descname">lapm_for_steady_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">t0</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em>, <em class="sig-param"><span class="n">x0</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/start_distributions.html#lapm_for_steady_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.start_distributions.lapm_for_steady_state" title="Permalink to this definition">¶</a></dt>
<dd><p>If a fixedpoint of the frozen system can be found, create a linear
autonomous model as an equivalent for the frozen (generally nonlinear)
system there.</p>
<p>The function performs the following steps:</p>
<ol class="arabic">
<li><p>Substitute symbols and symbolic functions with the parameters and
numeric functions.</p></li>
<li><p>Transform the general nonlinear non-autonomous system
into a nonlinear autonomous system by freezing it
at time <span class="math notranslate nohighlight">\(t=t_0\)</span>:</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(u_0(x)=u(t_0,x_0)\)</span> and <span class="math notranslate nohighlight">\(B_0(x)=B(t_0,x_0)\)</span></p></li>
<li><p>Look for an equilibrium <span class="math notranslate nohighlight">\(x_{fix}\)</span> of the frozen system
such that <span class="math notranslate nohighlight">\(0=B_0(x_{fix})+u_0(x_{fix})\)</span>.
If the frozen system is linear the we can compute
the fixed point explicitly : <span class="math notranslate nohighlight">\(x_{fix}=B_0^{-1}u_0\)</span>.
In general the frozen system will be nonlinear and we will have to
look for the fixed point numerically.</p></li>
<li><p>Create a linear autonomous pool model.
that can be investigated with the
package <a class="reference external" href="https://github.com/MPIBGC-TEE/LAPM">LAPM</a></p>
<p>This is a special case of the general
linearization of a nonlinear model along a trajectory,
which in case of a fixed point is constant.
At the fixed point the age distribution and solution of the
nonlinear system are identical to those of a linear one.</p>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srm</strong> (<a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><em>SmoothReservoirModel</em></a>) – The (symbolic) model</p></li>
<li><p><strong>par_set</strong> (<em>dict</em>) – The parameter set that transforms the symbolic model into a
numeric one.
The keys are the sympy symbols, the values are the values used
for the simulation.</p></li>
<li><p><strong>func_set</strong> (<em>dict</em>) – The keys are the symbolic
sympy expressions for external functions
the values are the numeric functions to be used in the simulation.</p></li>
<li><p><strong>t0</strong> (<em>float</em>) – The time where the non-autonomous system is frozen.</p></li>
<li><p><strong>x0</strong> (<em>numpy.ndarray</em>) – An initial guess to start the fixed point iteration.
If the frozen model is linear it will be ignored and
can therefore be omitted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>lapm is an instance of
(<code class="xref py py-class docutils literal notranslate"><span class="pre">LAPM.linear_autonomous_pool_model.LinearAutonomousPoolModel</span></code>)
representing the linearization with
respect to the (constant) fixed point trajectory. It yields the
same age distribution as the frozen possibly nonlinear system at
the fixed point.
<span class="math notranslate nohighlight">\(x_{fix}\)</span> is a one dimensional vector representing the
equilibrium.
This is returned since it is very likely needed as start vector in the
simulation for which the start distributions has been computed.
(The computed distribution assumes the system to be in this state.)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(lapm, x_fix)  (tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.start_distributions.start_age_distributions_from_empty_spinup">
<code class="sig-prename descclassname">CompartmentalSystems.start_distributions.</code><code class="sig-name descname">start_age_distributions_from_empty_spinup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">t_max</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/start_distributions.html#start_age_distributions_from_empty_spinup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.start_distributions.start_age_distributions_from_empty_spinup" title="Permalink to this definition">¶</a></dt>
<dd><p>Finite age spin up from empty pools</p>
<p>Creates a SmoothModelRun object with empty pools at <span class="math notranslate nohighlight">\(t=0\)</span>,
runs it until <span class="math notranslate nohighlight">\(t=t_{max}\)</span> an returns the age distribution at
<span class="math notranslate nohighlight">\(t_{max}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srm</strong> (<a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><em>SmoothReservoirModel</em></a>) – The (symbolic) model</p></li>
<li><p><strong>t_max</strong> (<em>float</em>) – The end of the spinup (which starts at t=0 and runs until t=t_max)</p></li>
<li><p><strong>parameter_dict</strong> (<em>dict</em>) – The parameter set that transforms the symbolic model into a
numeric one.
The keys are the sympy symbols, the values are the values used for
the simulation.</p></li>
<li><p><strong>func_set</strong> (<em>dict</em>) – The keys are the symbolic
sympy expressions for external functions
the values are the numeric functions to be used in the simulation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a_dist_at_end_of_spinup is a vector valued function of age.
a_dist_at_end_of_spinup(a)[i] reflects the mass of age <span class="math notranslate nohighlight">\(a\)</span>
in pool i.</p>
<p>sol_t_max is a one dimensional vector
representing the pool contents at the end of the spinup.
This is returned since it is very likely needed as start vector in the
simulation for which the start distributions has been computed.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(a_dist_at_end_of_spinup, sol_t_max)  (tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.start_distributions.start_age_distributions_from_steady_state">
<code class="sig-prename descclassname">CompartmentalSystems.start_distributions.</code><code class="sig-name descname">start_age_distributions_from_steady_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">t0</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em>, <em class="sig-param"><span class="n">x0</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/start_distributions.html#start_age_distributions_from_steady_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.start_distributions.start_age_distributions_from_steady_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the age distribution of the system at equilibrium <span class="math notranslate nohighlight">\(x_{fix}\)</span>
, by means of a linear autonomous pool model with identical age
distributions.
The fixed point and the linear model are provided by:
<a class="reference internal" href="#CompartmentalSystems.start_distributions.lapm_for_steady_state" title="CompartmentalSystems.start_distributions.lapm_for_steady_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lapm_for_steady_state()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srm</strong> (<a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><em>SmoothReservoirModel</em></a>) – The (symbolic) model</p></li>
<li><p><strong>parameter_dict</strong> (<em>dict</em>) – The parameter set that transforms the symbolic model into a
numeric one. The keys are the sympy symbols, the values are the
values used for the simulation.</p></li>
<li><p><strong>func_set</strong> (<em>dict</em>) – The keys are the symbolic sympy expressions for external functions,
the values are the numeric functions to be used in the simulation</p></li>
<li><p><strong>t0</strong> (<em>float</em>) – The time where the non-autonomous system is frozen.</p></li>
<li><p><strong>x0</strong> (<em>numpy.ndarray</em>) – An initial guess to start the fixed point iteration.
If the frozen model is linear it will be ignored and
can therefore be omitted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>a_dist_function is a vector valued function of age.
a_dist_function(a)[i] reflects the mass of age <span class="math notranslate nohighlight">\(a\)</span>
in pool i.
<span class="math notranslate nohighlight">\(x_{fix}\)</span> is a one dimensional vector representing the</p>
<blockquote>
<div><p>equilibrium.</p>
</div></blockquote>
<p>This is returned since it is very likely needed as start vector in the
simulation for which the start distributions has been computed.
(The computed distribution assumes the system to be in this state.)</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(a_dist_function, x_fix)  (tuple)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.start_distributions.start_age_distributions_from_zero_age_initial_content">
<code class="sig-prename descclassname">CompartmentalSystems.start_distributions.</code><code class="sig-name descname">start_age_distributions_from_zero_age_initial_content</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">x0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/start_distributions.html#start_age_distributions_from_zero_age_initial_content"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.start_distributions.start_age_distributions_from_zero_age_initial_content" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the age distribution (function) for a system into
which all initial mass is injected instantaneous at <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
<p>The function returns a vector valued function dist(a) of the age a
that returns the start vector for a=0 and a
zero vector of the same size everywhere else.
This represents the age distribution of mass in a
compartmental system where the age of all pool contents is zero.
This means that the distribution is NOT normalized to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srm</strong> (<a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><em>SmoothReservoirModel</em></a>) – The (symbolic) model</p></li>
<li><p><strong>x0</strong> (<em>numpy.ndarray</em>) – The contents of the pools at <span class="math notranslate nohighlight">\(t=0\)</span></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a vector valued function of age.
dist(a)[i] reflects the mass of age <span class="math notranslate nohighlight">\(a\)</span>
in pool i.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dist (callable)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.start_distributions.start_age_distributions_from_zero_initial_content">
<code class="sig-prename descclassname">CompartmentalSystems.start_distributions.</code><code class="sig-name descname">start_age_distributions_from_zero_initial_content</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/start_distributions.html#start_age_distributions_from_zero_initial_content"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.start_distributions.start_age_distributions_from_zero_initial_content" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the age distribution (function) for an empty system.</p>
<p>The function returns a vector valued function dist(a) of the age a
that is zero everywhere dist(a)=0 for all a.
This represents the age distribution of a compartmental system with all
pools empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>srm</strong> (<a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><em>SmoothReservoirModel</em></a>) – The (symbolic) model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dist, a vector valued function of age.
dist(a)[i] reflects the mass of age <span class="math notranslate nohighlight">\(a\)</span>
in pool i.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.start_distributions.start_age_moments_from_empty_spinup">
<code class="sig-prename descclassname">CompartmentalSystems.start_distributions.</code><code class="sig-name descname">start_age_moments_from_empty_spinup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">t_max</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em>, <em class="sig-param"><span class="n">max_order</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/start_distributions.html#start_age_moments_from_empty_spinup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.start_distributions.start_age_moments_from_empty_spinup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.start_distributions.start_age_moments_from_steady_state">
<code class="sig-prename descclassname">CompartmentalSystems.start_distributions.</code><code class="sig-name descname">start_age_moments_from_steady_state</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">t0</span></em>, <em class="sig-param"><span class="n">parameter_dict</span></em>, <em class="sig-param"><span class="n">func_set</span></em>, <em class="sig-param"><span class="n">max_order</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/start_distributions.html#start_age_moments_from_steady_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.start_distributions.start_age_moments_from_steady_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the age moments of the system at equilibrium <span class="math notranslate nohighlight">\(x_{fix}\)</span>
, by means of a linear autonomous pool model with identical age
distributions.
The fixed point and the linear model are provided by:
<a class="reference internal" href="#CompartmentalSystems.start_distributions.lapm_for_steady_state" title="CompartmentalSystems.start_distributions.lapm_for_steady_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lapm_for_steady_state()</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>srm</strong> (<a class="reference internal" href="#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><em>SmoothReservoirModel</em></a>) – The (symbolic) model</p></li>
<li><p><strong>parameter_dict</strong> (<em>dict</em>) – The parameter set that transforms the symbolic model into a
numeric one. The keys are the sympy symbols, the values are the
values used for the simulation.</p></li>
<li><p><strong>func_set</strong> (<em>dict</em>) – The keys are the symbolic sympy expressions for external functions
the values are the numeric functions to be used in the simulation</p></li>
<li><p><strong>t0</strong> (<em>float</em>) – The time where the non-autonomous system is frozen.</p></li>
<li><p><strong>x0</strong> (<em>numpy.ndarray</em>) – An initial guess to start the fixed point iteration.
If the frozen model is linear it will be ignored and
can therefore be omitted.</p></li>
<li><p><strong>max_order</strong> (<em>int</em>) – The highest order up to which moments are to be computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>moments x pools, containing the moments of the
pool ages in equilibrium.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="CompartmentalSystems.start_distributions.start_age_moments_from_zero_initial_content">
<code class="sig-prename descclassname">CompartmentalSystems.start_distributions.</code><code class="sig-name descname">start_age_moments_from_zero_initial_content</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">srm</span></em>, <em class="sig-param"><span class="n">max_order</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/CompartmentalSystems/start_distributions.html#start_age_moments_from_zero_initial_content"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.start_distributions.start_age_moments_from_zero_initial_content" title="Permalink to this definition">¶</a></dt>
<dd><p>The function returns an array of shape (max_order, srm.nr_pools)</p>
<p>The values are set to numpy.nan to be consistent with other parts of the
code.
For instance the mean age (first moment) of an empty pool is undefined )
:param srm: The (symbolic) model
:type srm: SmoothReservoirModel
:param max_order: The highest order up to which moments are to be</p>
<blockquote>
<div><p>computed.</p>
</div></blockquote>
<dl class="field-list simple">
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-CompartmentalSystems">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-CompartmentalSystems" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">CompartmentalSystems</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Holger Metzler, Markus Müller.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/CompartmentalSystems.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>