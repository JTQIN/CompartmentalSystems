<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CompartmentalSystems.smooth_model_run &mdash; CompartmentalSystems 1 documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="CompartmentalSystems 1 documentation" href="../index.html" />
    <link rel="prev" title="CompartmentalSystems.smooth_reservoir_model" href="CompartmentalSystems.smooth_reservoir_model.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-CompartmentalSystems.smooth_model_run">
<span id="compartmentalsystems-smooth-model-run"></span><h1>CompartmentalSystems.smooth_model_run<a class="headerlink" href="#module-CompartmentalSystems.smooth_model_run" title="Permalink to this headline">¶</a></h1>
<p>Module for numerical treatment of smooth reservoir models.</p>
<p>An abstract
<a class="reference internal" href="CompartmentalSystems.smooth_reservoir_model.html#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal"><span class="pre">SmoothReservoirModel</span></code></a> is
filled with live by giving initial values, a parameter set, a time grid,
and potentially additional involved functions to it.</p>
<p>The model can then be run and as long as the model is linear,
based on the state transition operator age and transit time
distributions can be computed.</p>
<p>Nonlinear models can be lineaized along a solution trajectory.</p>
<p>Counting of compartment/pool/reservoir numbers start at zero and the
total number of pools is <span class="math">\(d\)</span>.</p>
<p class="rubric">Classes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-obj docutils literal"><span class="pre">SmoothModelRun</span></code></a>(model,&nbsp;parameter_set,&nbsp;...[,&nbsp;...])</td>
<td>Class for a model run based on a <a class="reference internal" href="CompartmentalSystems.smooth_reservoir_model.html#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal"><span class="pre">SmoothReservoirModel</span></code></a>.</td>
</tr>
</tbody>
</table>
<p class="rubric">Exceptions</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-obj docutils literal"><span class="pre">Error</span></code></a></td>
<td>Generic error occurring in this module.</td>
</tr>
</tbody>
</table>
<dl class="exception">
<dt id="CompartmentalSystems.smooth_model_run.Error">
<em class="property">exception </em><code class="descname">Error</code><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#Error"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.Error" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">Exception</span></code></p>
<p>Generic error occurring in this module.</p>
<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.Error.with_traceback">
<code class="descname">with_traceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.Error.with_traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception.with_traceback(tb) &#8211;
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun">
<em class="property">class </em><code class="descname">SmoothModelRun</code><span class="sig-paren">(</span><em>model</em>, <em>parameter_set</em>, <em>start_values</em>, <em>times</em>, <em>func_set=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class for a model run based on a
<a class="reference internal" href="CompartmentalSystems.smooth_reservoir_model.html#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal"><span class="pre">SmoothReservoirModel</span></code></a>.</p>
<dl class="attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.model">
<code class="descname">model</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.model" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="CompartmentalSystems.smooth_reservoir_model.html#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal"><span class="pre">SmoothReservoirModel</span></code></a> &#8211; The reservoir model on which the model run bases.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">parameter set</code></dt>
<dd><p><em>dict</em> &#8211; <code class="docutils literal"><span class="pre">{x:</span> <span class="pre">y}</span></code> with <code class="docutils literal"><span class="pre">x</span></code> being a SymPy symbol
and <code class="docutils literal"><span class="pre">y</span></code> being a numerical value.</p>
</dd></dl>

<dl class="attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.start_values">
<code class="descname">start_values</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.start_values" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy.array</em> &#8211; The vector of start values.</p>
</dd></dl>

<dl class="attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.times">
<code class="descname">times</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.times" title="Permalink to this definition">¶</a></dt>
<dd><p><em>numpy.array</em> &#8211; The time grid used for the simulation.
Typically created by <code class="docutils literal"><span class="pre">numpy.linspace</span></code>.</p>
</dd></dl>

<dl class="attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.func_set">
<code class="descname">func_set</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.func_set" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> &#8211; <code class="docutils literal"><span class="pre">{f:</span> <span class="pre">func}</span></code> with <code class="docutils literal"><span class="pre">f</span></code> being a SymPy symbol and
<code class="docutils literal"><span class="pre">func</span></code> being a Python function. Defaults to <code class="docutils literal"><span class="pre">dict()</span></code>.</p>
</dd></dl>

<p>Pool counting starts with <code class="docutils literal"><span class="pre">0`</span></code>. In combined structures for pools and
system, the system is at the position of a <code class="docutils literal"><span class="pre">(d+1)</span></code> st pool.</p>
<p>Return a SmoothModelRun instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<a class="reference internal" href="CompartmentalSystems.smooth_reservoir_model.html#CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel" title="CompartmentalSystems.smooth_reservoir_model.SmoothReservoirModel"><code class="xref py py-class docutils literal"><span class="pre">SmoothReservoirModel</span></code></a>) &#8211; The reservoir model on which the model run bases.</li>
<li><strong>parameter_set</strong> (<em>dict</em>) &#8211; <code class="docutils literal"><span class="pre">{x:</span> <span class="pre">y}</span></code> with <code class="docutils literal"><span class="pre">x</span></code> being a SymPy symbol
and <code class="docutils literal"><span class="pre">y</span></code> being a numerical value.</li>
<li><strong>start_values</strong> (<em>numpy.array</em>) &#8211; The vector of start values.</li>
<li><strong>times</strong> (<em>numpy.array</em>) &#8211; The time grid used for the simulation.
Typically created by <code class="docutils literal"><span class="pre">numpy.linspace</span></code>.</li>
<li><strong>func_set</strong> (<em>dict</em>) &#8211; <code class="docutils literal"><span class="pre">{f:</span> <span class="pre">func}</span></code> with <code class="docutils literal"><span class="pre">f</span></code> being a SymPy symbol and
<code class="docutils literal"><span class="pre">func</span></code> being a Python function. Defaults to <code class="docutils literal"><span class="pre">dict()</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> &#8211; If <code class="docutils literal"><span class="pre">start_values</span></code> is not a <code class="docutils literal"><span class="pre">numpy.array</span></code>.</p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.A">
<code class="descname">A</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.A"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.A" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math">\(A(t)\)</span> with <span class="math">\(A\)</span> from
<span class="math">\(\dot{x} = A\,x+u.\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>t</strong> (<em>float</em>) &#8211; The time at which <span class="math">\(A\)</span> is to be evaluated.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The compartmental matrix evaluated at time <code class="docutils literal"><span class="pre">t</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.add_equilibrium_surface_plotly">
<code class="descname">add_equilibrium_surface_plotly</code><span class="sig-paren">(</span><em>fig</em>, <em>opacity=0.9</em>, <em>index=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.add_equilibrium_surface_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.add_equilibrium_surface_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a grey and transparent equilibrium density surface to an existing
Plotly density plot.</p>
<p>The &#8216;equilibrium&#8217; values are taken from the time zero index such that
the system is supposed to be in equlibrium at time <span class="math">\(t_0\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fig</strong> (<em>Plotly figure</em>) &#8211; The existing density plot to which the
equilibrium surface is added.</li>
<li><strong>opacity</strong> (<em>between 0 and 1, optional</em>) &#8211; The opacity of the new surface.
Defaults to 0.9.
Unfortunately, the opacity option does not seem to work
properly.</li>
<li><strong>index</strong> (<em>int, optional</em>) &#8211; The time index from which the equilibrium
data is taken.
Defaults to 0 such that the system is supposed to be in
equlibrium at time <span class="math">\(t_0\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">fig</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.add_line_to_density_plot_plotly">
<code class="descname">add_line_to_density_plot_plotly</code><span class="sig-paren">(</span><em>fig</em>, <em>data</em>, <em>color</em>, <em>name</em>, <em>time_stride=1</em>, <em>width=5</em>, <em>on_surface=True</em>, <em>bottom=True</em>, <em>legend_on_surface=False</em>, <em>legend_bottom=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.add_line_to_density_plot_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.add_line_to_density_plot_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a line to an existing Plotly density plot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fig</strong> (<em>Plotly figure</em>) &#8211; Contains already a density plot to which the
new line is added.</li>
<li><strong>data</strong> (<em>numpy.array len(times</em>) &#8211; The age data of the new line.</li>
<li><strong>color</strong> (<em>#RRGGBB</em>) &#8211; The color of the new line.</li>
<li><strong>name</strong> (<em>str</em>) &#8211; The name of the new line for the legend.</li>
<li><strong>time_stride</strong> (<em>int, optional</em>) &#8211; Coarsity of the plot in the time
direction to save memory.
Defaults to 1 meaning that all times are plotted and no memory
is saved.</li>
<li><strong>width</strong> (<em>int, optional</em>) &#8211; Width of the new line. Defaults to 5.</li>
<li><strong>on_surface</strong> (<em>bool, optional</em>) &#8211; If True, a new line with the given age
data is plotted on top of the given density.
Defaults to True.</li>
<li><strong>bottom</strong> (<em>bool optional</em>) &#8211; If True, a new line with the given age data
is plotted in the xy-plane.
Defaults to True.</li>
<li><strong>legend_on_surface</strong> (<em>bool, optional</em>) &#8211; If True, the line on the surface
is mentioned in the legend.
Has no effect if on_surface is False.
Defaults to False.</li>
<li><strong>legend_bottom</strong> (<em>bool, optional</em>) &#8211; If True, the line in the xy-plane is
mentioned in the legend.
Has no effect if bottom is False.
Defaults to False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">fig</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_densities">
<code class="descname">age_densities</code><span class="sig-paren">(</span><em>pool_age_densities</em>, <em>system_age_density</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.age_densities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_densities" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine pool and system age densities to one numpy.array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pool_age_densites</strong> (<em>numpy.ndarray len(ages</em>) &#8211; The pool age density values.</li>
<li><strong>system_age_density</strong> (<em>numpy.ndarray len(ages</em>) &#8211; The system age density values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(len(ages) x len(times) x (nr_pools+1)).
The system age density values are appended to the end of the
pool density values (system = pool <code class="docutils literal"><span class="pre">d+1</span></code> with <code class="docutils literal"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">nr_pools</span></code>).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector">
<code class="descname">age_moment_vector</code><span class="sig-paren">(</span><em>order</em>, <em>start_age_moments=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.age_moment_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal"><span class="pre">order</span></code> th pool age moment vector over the time grid
by an ODE system.</p>
<p>This function solves an ODE system to obtain the pool age moments very
fast. If the system has empty pools at the beginning, the semi-explicit
formula is used until all pools are non-empty. Then the ODE system
starts.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>int</em>) &#8211; The order of the pool age moments to be computed.</li>
<li><strong>start_age_moments</strong> (<em>numpy.ndarray order x nr_pools, optional</em>) &#8211; Given initial age moments up to the order of interest.
Can possibly be computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities"><code class="xref py py-func docutils literal"><span class="pre">moments_from_densities()</span></code></a>.
Defaults to None assuming zero initial ages.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">len(times) x nr_pools.
The <code class="docutils literal"><span class="pre">order</span></code> th pool age moments over the time grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector_from_densities">
<code class="descname">age_moment_vector_from_densities</code><span class="sig-paren">(</span><em>order</em>, <em>start_age_densities</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.age_moment_vector_from_densities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector_from_densities" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal"><span class="pre">order</span></code> th moment of the pool ages by integration.</p>
<p>This function is extremely slow, since for each pool the integral over
the density is computed based on the singe-valued functions. It is
implemented only for the sake of completeness and to test the results
obtained by faster methods.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>int</em>) &#8211; The order of the moment to be computed.</li>
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age that returns a numpy.array containing the
masses with the given age at time <span class="math">\(t_0\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">len(times) x nr_pools.
Contains the <code class="docutils literal"><span class="pre">order</span></code> th moment
of the pool ages over the time grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector_semi_explicit">
<code class="descname">age_moment_vector_semi_explicit</code><span class="sig-paren">(</span><em>order</em>, <em>start_age_moments=None</em>, <em>times=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.age_moment_vector_semi_explicit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector_semi_explicit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal"><span class="pre">order</span></code> th moment of the pool ages by a semi-explicit
formula.</p>
<p>This function bases on a semi-explicit formula such that no improper
integrals need to be computed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>int</em>) &#8211; The order of the age moment to be computed.</li>
<li><strong>start_age_moments</strong> (<em>numpy.ndarray order x nr_pools, optional</em>) &#8211; Given initial age moments up to the order of interest.
Can possibly be computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities"><code class="xref py py-func docutils literal"><span class="pre">moments_from_densities()</span></code></a>.
Defaults to None assuming zero initial ages.</li>
<li><strong>times</strong> (<em>numpy.array, optional</em>) &#8211; Time grid.
Defaults to None and the original time grid is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">len(times) x nr_pools.
The <code class="docutils literal"><span class="pre">order</span></code> th pool age moments over the time grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.apply_to_forward_transit_time_simulation">
<code class="descname">apply_to_forward_transit_time_simulation</code><span class="sig-paren">(</span><em>f_dict={'mean': &lt;Mock id='140305003550256'&gt;}</em>, <em>N=10000</em>, <em>M=2</em>, <em>k=5</em>, <em>MH=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.apply_to_forward_transit_time_simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.apply_to_forward_transit_time_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>This is just a tentative approach.</p>
<p>To be honest, the problem of an unkown infinite future cannot be solved
this way, since the densities used to simulate forward transit time
random variables are biased by the cut-off at the end of the time grid.</p>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.apply_to_forward_transit_time_simulation_its">
<code class="descname">apply_to_forward_transit_time_simulation_its</code><span class="sig-paren">(</span><em>f_dict</em>, <em>times</em>, <em>N=1000</em>, <em>k=5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.apply_to_forward_transit_time_simulation_its"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.apply_to_forward_transit_time_simulation_its" title="Permalink to this definition">¶</a></dt>
<dd><p>This is just a tentative approach.</p>
<p>To be honest, the problem of an unkown infinite future cannot be solved
this way, since the densities used to simulate forward transit time
random variables are biased by the cut-off at the end of the time grid.</p>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_density">
<code class="descname">backward_transit_time_density</code><span class="sig-paren">(</span><em>pool_age_densities</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.backward_transit_time_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the backward transit time based on given pool age densities.</p>
<p>The result is obtained by computing a weighted sum of the pool age
densities according to output rates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pool_age_densites</strong> (<em>numpy.ndarray len(ages</em>) &#8211; The pool age density values.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">len(ages) x len(times). Mass leaving the system with
the respective age at the respective time.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_density_single_value">
<code class="descname">backward_transit_time_density_single_value</code><span class="sig-paren">(</span><em>start_age_densities</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.backward_transit_time_density_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_density_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function that returns a single value for the
backward transit time density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age that returns a numpy.array containing the
masses with the given age at time <span class="math">\(t_0\)</span>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">p_sv</span></code>: <code class="docutils literal"><span class="pre">p_sv(a,</span> <span class="pre">t)</span></code> returns the mass that
leaves the system at time <code class="docutils literal"><span class="pre">t</span></code> with age <code class="docutils literal"><span class="pre">a</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_moment">
<code class="descname">backward_transit_time_moment</code><span class="sig-paren">(</span><em>order</em>, <em>start_age_moments</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.backward_transit_time_moment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal"><span class="pre">order</span></code> th backward transit time moment based on the
<a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector"><code class="xref py py-func docutils literal"><span class="pre">age_moment_vector()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>int</em>) &#8211; The order of the backward transit time moment that is
to be computed.</li>
<li><strong>start_age_moments</strong> (<em>numpy.ndarray order x nr_pools, optional</em>) &#8211; Given initial age moments up to the order of interest.
Can possibly be computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities"><code class="xref py py-func docutils literal"><span class="pre">moments_from_densities()</span></code></a>.
Defaults to None assuming zero initial ages.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal"><span class="pre">order</span></code> th backward transit time moment over the
time grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_moment_from_density">
<code class="descname">backward_transit_time_moment_from_density</code><span class="sig-paren">(</span><em>order</em>, <em>start_age_densities</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.backward_transit_time_moment_from_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.backward_transit_time_moment_from_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal"><span class="pre">order</span></code> th backward transit time moment based on an
improper integral over the density.</p>
<p>This function is extremely slow and implemented only for the sake of
completeness and for testing results from faster approaches.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>int</em>) &#8211; The order of the backward transit time moment that is
to be computed.</li>
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math">\(t_0\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal"><span class="pre">order</span></code> th backward transit time moment over the
time grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.combine_pools_and_system_values">
<code class="descname">combine_pools_and_system_values</code><span class="sig-paren">(</span><em>pools_values</em>, <em>system_values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.combine_pools_and_system_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.combine_pools_and_system_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Append the system values to the pool values as if they belonged to
another pool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pools_values</strong> (<em>numpy.ndarray len(times</em>) &#8211; The values to be
saved over the time-pool grid.</li>
<li><strong>system_values</strong> (<em>numpy.array</em>) &#8211; The system values to be saved over the
time grid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">len(times) x (nr_pools+1) The pool and system values
over the time-pool grid with the system added at the end as another
pool.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_backward_transit_time_distribution_single_value">
<code class="descname">cumulative_backward_transit_time_distribution_single_value</code><span class="sig-paren">(</span><em>start_age_densities=None</em>, <em>F0=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.cumulative_backward_transit_time_distribution_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_backward_transit_time_distribution_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the cumulative backward transit time
distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math">\(t_0\)</span>. Defaults to None.</li>
<li><strong>F0</strong> (<em>Python function</em>) &#8211; A function of age that returns a numpy.array
containing the masses with age less than or equal to the age at
time <span class="math">\(t_0\)</span>. Defaults to None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> &#8211; If both <code class="docutils literal"><span class="pre">start_age_densities</span></code> and <code class="docutils literal"><span class="pre">F0</span></code> are <code class="docutils literal"><span class="pre">None</span></code>.
One must be given.
It is fastest to provide <code class="docutils literal"><span class="pre">F0</span></code>, otherwise <code class="docutils literal"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal"><span class="pre">start_age_densities</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Python function <code class="docutils literal"><span class="pre">F_sv</span></code>: <code class="docutils literal"><span class="pre">F_sv(a,</span> <span class="pre">t)</span></code> is the mass leaving the
system at time <code class="docutils literal"><span class="pre">t</span></code> with age less than or equal to <code class="docutils literal"><span class="pre">a</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_forward_transit_time_distribution_single_value">
<code class="descname">cumulative_forward_transit_time_distribution_single_value</code><span class="sig-paren">(</span><em>cut_off=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.cumulative_forward_transit_time_distribution_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_forward_transit_time_distribution_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the cumulative forward transit time
distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cut_off</strong> (<em>bool, optional</em>) &#8211; If <code class="docutils literal"><span class="pre">True</span></code>, no density values are going
to be computed after the end of the time grid, instead
<code class="docutils literal"><span class="pre">numpy.nan</span></code> will be returned.
Defaults to <code class="docutils literal"><span class="pre">True</span></code>.
<code class="docutils literal"><span class="pre">False</span></code> might lead to unexpected behavior.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">F_sv</span></code>: <code class="docutils literal"><span class="pre">F_sv(a,</span> <span class="pre">t)</span></code> is the mass leaving the
system at time <code class="docutils literal"><span class="pre">t+a</span></code> with age less than or equal to <code class="docutils literal"><span class="pre">a</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_pool_age_distributions_single_value">
<code class="descname">cumulative_pool_age_distributions_single_value</code><span class="sig-paren">(</span><em>start_age_densities=None</em>, <em>F0=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.cumulative_pool_age_distributions_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_pool_age_distributions_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the cumulative pool age distributions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math">\(t_0\)</span>. Defaults to None.</li>
<li><strong>F0</strong> (<em>Python function</em>) &#8211; A function of age that returns a numpy.array
containing the masses with age less than or equal to the age at
time <span class="math">\(t_0\)</span>. Defaults to None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> &#8211; If both <code class="docutils literal"><span class="pre">start_age_densities</span></code> and <code class="docutils literal"><span class="pre">F0</span></code> are <code class="docutils literal"><span class="pre">None</span></code>.
One must be given.
It is fastest to provide <code class="docutils literal"><span class="pre">F0</span></code>, otherwise <code class="docutils literal"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal"><span class="pre">start_age_densities</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Python function <code class="docutils literal"><span class="pre">F_sv</span></code>: <code class="docutils literal"><span class="pre">F_sv(a,t)</span></code> is the vector of pool
masses (<code class="docutils literal"><span class="pre">numpy.array</span></code>) with age less than or equal to <code class="docutils literal"><span class="pre">a</span></code> at
time <code class="docutils literal"><span class="pre">t</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_system_age_distribution_single_value">
<code class="descname">cumulative_system_age_distribution_single_value</code><span class="sig-paren">(</span><em>start_age_densities=None</em>, <em>F0=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.cumulative_system_age_distribution_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.cumulative_system_age_distribution_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the cumulative system age distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math">\(t_0\)</span>. Defaults to None.</li>
<li><strong>F0</strong> (<em>Python function</em>) &#8211; A function of age that returns a numpy.array
containing the masses with age less than or equal to the age at
time <span class="math">\(t_0\)</span>. Defaults to None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> &#8211; If both <code class="docutils literal"><span class="pre">start_age_densities</span></code> and <code class="docutils literal"><span class="pre">F0</span></code> are None.
One must be given.
It is fastest to provide <code class="docutils literal"><span class="pre">F0</span></code>, otherwise <code class="docutils literal"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal"><span class="pre">start_age_densities</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Python function <code class="docutils literal"><span class="pre">F_sv</span></code>: <code class="docutils literal"><span class="pre">F_sv(a,</span> <span class="pre">t)</span></code> is the mass in the system
with age less than or equal to <code class="docutils literal"><span class="pre">a</span></code> at time <code class="docutils literal"><span class="pre">t</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.density_values">
<code class="descname">density_values</code><span class="sig-paren">(</span><em>density_sv</em>, <em>values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.density_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.density_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the density value over the time grid at ages given in values.</p>
<p>This function can be used to obtain the density values at mean or median
values to draw a curve on top of the density surface. But actually this
is now implemented in a much faster way based on the surface itself.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>density_sv</strong> (<em>Python function</em>) &#8211; A function that takes <code class="docutils literal"><span class="pre">a</span></code>, <code class="docutils literal"><span class="pre">t</span></code>
as arguments and returns density value with age a at time <code class="docutils literal"><span class="pre">t</span></code>.
Potentially coming from <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density_single_value" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density_single_value"><code class="xref py py-func docutils literal"><span class="pre">system_age_density_single_value()</span></code></a>.</li>
<li><strong>values</strong> (<em>numpy.array</em>) &#8211; The ages over the time grid at which the
density values are to be computed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The density values over the time grid based
on the given age values.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.density_values_for_pools">
<code class="descname">density_values_for_pools</code><span class="sig-paren">(</span><em>pool_densities_sv</em>, <em>pool_age_values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.density_values_for_pools"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.density_values_for_pools" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the pool age densities over the time grid at ages given in
pool_age_values.</p>
<p>This function can be used to obtain the density values at mean or median
values to draw a curve on top of the density surface. But actually this
is now implemented in a much faster way based on the surface itself.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pool_age_densites_sv</strong> (<em>Python function</em>) &#8211; A function that takes
<code class="docutils literal"><span class="pre">a</span></code>, <code class="docutils literal"><span class="pre">t</span></code> as arguments and returns a vector of pool contents
with mass a at time t. Potentially coming from
<a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_single_value" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_single_value"><code class="xref py py-func docutils literal"><span class="pre">pool_age_densities_single_value()</span></code></a>.</li>
<li><strong>pool_age_values</strong> (<em>numpy.ndarray len(times</em>) &#8211; The ages over
the time-pool grid at which the density values are to be
computed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(len(times) x nr_pools) The pool density values over
the time-pool grid based on the given age values.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.distribution_quantiles">
<code class="descname">distribution_quantiles</code><span class="sig-paren">(</span><em>quantile</em>, <em>F_sv</em>, <em>norm_consts=None</em>, <em>start_values=None</em>, <em>method='brentq'</em>, <em>tol=1e-08</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.distribution_quantiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.distribution_quantiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return distribution quantiles over the time grid of a given
distribution.</p>
<p>The compuation is done by computing the generalized inverse of the
respective cumulative distribution using a nonlinear root search
algorithm. Depending on how slowly the cumulative distribution can be
computed, this can take quite some time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>quantile</strong> (<em>between 0 and 1</em>) &#8211; The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</li>
<li><strong>F_sv</strong> (<em>Python function</em>) &#8211; A function of age <code class="docutils literal"><span class="pre">a</span></code> and time <code class="docutils literal"><span class="pre">t</span></code> that
returns the mass that is of age less than or equal to <code class="docutils literal"><span class="pre">a</span></code> at
time <code class="docutils literal"><span class="pre">t</span></code>.</li>
<li><strong>norm_consts</strong> (<em>numpy.array, optional</em>) &#8211; An array over the time grid of
total masses over all ages.
Defaults to an array of ones assuming given probability
distributions.</li>
<li><strong>start_values</strong> (<em>numpy.array, optional</em>) &#8211; An array over the time grid of
start values for the nonlinear search.
Good values are slighty greater than the solution values.
Defaults to an array of zeros.</li>
<li><strong>method</strong> (<em>str</em>) &#8211; The method that is used for finding the roots of a
nonlinear function. Either &#8216;brentq&#8217; or &#8216;newton&#8217;.
Defaults to &#8216;brentq&#8217;.</li>
<li><strong>tol</strong> (<em>float</em>) &#8211; The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal"><span class="pre">1e-01</span></code> might already be fine.
Defaults to <code class="docutils literal"><span class="pre">1e-08</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The computed quantile values over the time grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_flux_funcs">
<code class="descname">external_input_flux_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.external_input_flux_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_flux_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of the external input fluxes.</p>
<p>The resulting functions base on sol_funcs and are linear interpolations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal"><span class="pre">{key:</span> <span class="pre">func}</span></code> with <code class="docutils literal"><span class="pre">key</span></code> representing the pool which
receives the input and <code class="docutils literal"><span class="pre">func</span></code> a function of time that returns
a <code class="docutils literal"><span class="pre">float</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_vector">
<code class="descname">external_input_vector</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grid of external input vectors.</p>
<p>The input at time <span class="math">\(t_0\)</span> is set to zero by definition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">len(times) x nr_pools</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_vector_func">
<code class="descname">external_input_vector_func</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.external_input_vector_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.external_input_vector_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector valued function for the external inputs.</p>
<p>The resulting function bases on sol_funcs and is a linear interpolation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">u</span></code>: <code class="docutils literal"><span class="pre">u(t)</span></code> is a <code class="docutils literal"><span class="pre">numpy.array</span></code> containing the
external inputs at time <code class="docutils literal"><span class="pre">t</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.external_output_vector">
<code class="descname">external_output_vector</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.external_output_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grid of external output vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">len(times) x nr_pools</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_density_func">
<code class="descname">forward_transit_time_density_func</code><span class="sig-paren">(</span><em>cut_off=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.forward_transit_time_density_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_density_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function based on an age array for the forward transit time
density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cut_off</strong> (<em>bool, optional</em>) &#8211; If True, no density values are going to
be computed after the end of the time grid, instead numpy.nan
will be returned.
Defaults to True and False might lead to unexpected behavior.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">p</span></code>: <code class="docutils literal"><span class="pre">p(ages)</span></code> is a <code class="docutils literal"><span class="pre">numpy.ndarray</span></code>
len(ages) x len(times) that gives the mass that will leave the
system with the respective age when it came in at time <code class="docutils literal"><span class="pre">t</span></code>,
where <code class="docutils literal"><span class="pre">ages</span></code> is a <code class="docutils literal"><span class="pre">numpy.array</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_density_single_value">
<code class="descname">forward_transit_time_density_single_value</code><span class="sig-paren">(</span><em>cut_off=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.forward_transit_time_density_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_density_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function that returns a single value for the
forward transit time density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cut_off</strong> (<em>bool, optional</em>) &#8211; If True, no density values are going to
be computed after the end of the time grid, instead numpy.nan
will be returned.
Defaults to True and False might lead to unexpected behavior.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">p_sv</span></code>: <code class="docutils literal"><span class="pre">p_sv(a,</span> <span class="pre">t)</span></code> returns how much mass will
leave the system with age <code class="docutils literal"><span class="pre">a</span></code> when it came in at time <code class="docutils literal"><span class="pre">t</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_moment">
<code class="descname">forward_transit_time_moment</code><span class="sig-paren">(</span><em>order</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.forward_transit_time_moment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.forward_transit_time_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal"><span class="pre">order</span></code> th forward transit time moment.</p>
<p>Attention! This function integrates over the state transition operator
until infinite time.
The results are going to be weird, since at the end of the time grid
some cut- off will happen which biases the result.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>order</strong> (<em>int</em>) &#8211; The order of the forward transit time moment to be
computed.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The <code class="docutils literal"><span class="pre">order</span></code> th forward transit time moment over the
time grid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.internal_flux_funcs">
<code class="descname">internal_flux_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.internal_flux_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.internal_flux_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of the internal fluxes.</p>
<p>The resulting functions base on sol_funcs and are linear interpolations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal"><span class="pre">{key:</span> <span class="pre">func}</span></code> with <code class="docutils literal"><span class="pre">key=(pool_from,</span> <span class="pre">pool_to)</span></code> representing
the pools involved and <code class="docutils literal"><span class="pre">func</span></code> a function of time that returns
a <code class="docutils literal"><span class="pre">float</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ditc</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.linearize">
<code class="descname">linearize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.linearize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.linearize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a linearized SmoothModelRun instance.</p>
<p>Linearization happens along the solution trajectory. Only for linear
systems all functionality is guaranteed,
this is why nonlinear systems should be linearized first.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">A linearized version of the original
<a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-class docutils literal"><span class="pre">SmoothModelRun</span></code></a>, with the solutions now being part
of <code class="docutils literal"><span class="pre">func_set</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun" title="CompartmentalSystems.smooth_model_run.SmoothModelRun"><code class="xref py py-class docutils literal"><span class="pre">SmoothModelRun</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.load_density_csv">
<code class="descname">load_density_csv</code><span class="sig-paren">(</span><em>filename</em>, <em>ages</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.load_density_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.load_density_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load density values from a csv file.</p>
<p>Attention: It is assumed that the data were saved before with the very
same ages, times, and pools.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The csv file from which the data are to be read.</li>
<li><strong>ages</strong> (<em>numpy.array</em>) &#8211; The ages corresponding to the age indices.
What is needed here is in fact only the length of the age grid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">len(ages) x len(times) The density values over the
ages-times grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.load_pools_and_system_densities_csv">
<code class="descname">load_pools_and_system_densities_csv</code><span class="sig-paren">(</span><em>filename</em>, <em>ages</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.load_pools_and_system_densities_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.load_pools_and_system_densities_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pool and system age densities from a csv file.</p>
<p>Attention: It is assumed that the data were saved before with the very
same ages, times, and pools.
Furthermore, it is assumed that the system value always follows the
pool values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The csv file from which the data are to be read.</li>
<li><strong>ages</strong> (<em>numpy.array</em>) &#8211; The ages corresponding to the age indices.
What is needed here is in fact only the length of the age grid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">len(ages) x len(times) x (nr_pools+1) The density
values for the pools and the system over the
ages-times-(pools+system) grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.load_pools_and_system_value_csv">
<code class="descname">load_pools_and_system_value_csv</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.load_pools_and_system_value_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.load_pools_and_system_value_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Load pool and system values from a csv file.</p>
<p>Values could be the mean/median age, for example. One dimension less
than a density.</p>
<p>Attention: It is assumed that the data were saved before with the very
same ages, times, and pools.
Furthermore, it is assumed that the system value always follows the
pool values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>str</em>) &#8211; The csv file from which the data are to be read.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">len(times) x (nr_pools+1) The values for the pools
and the system over the times-(pools+system) grid.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities">
<em class="property">static </em><code class="descname">moments_from_densities</code><span class="sig-paren">(</span><em>max_order</em>, <em>densities</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.moments_from_densities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the moments up to max_order of the given densities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>max_order</strong> (<em>int</em>) &#8211; The highest order up to which moments are
to be computed.</li>
<li><strong>densities</strong> (<em>numpy.array</em>) &#8211; Each entry is a Python function of one
variable (age) that represents a probability density function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">moments x pools, containing the moments of the given
densities.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.nr_pools">
<code class="descname">nr_pools</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.nr_pools" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em> &#8211; Return the number of pools involved in the model.</p>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.output_flux_funcs">
<code class="descname">output_flux_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.output_flux_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.output_flux_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary of the external output fluxes.</p>
<p>The resulting functions base on sol_funcs and are linear interpolations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="docutils literal"><span class="pre">{key:</span> <span class="pre">func}</span></code> with <code class="docutils literal"><span class="pre">key</span></code> representing the pool from which
the output comes and <code class="docutils literal"><span class="pre">func</span></code> a function of time that returns a
<code class="docutils literal"><span class="pre">float</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.output_rate_vector">
<code class="descname">output_rate_vector</code><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.output_rate_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grid of output rate vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">len(times) x nr_pools, <code class="docutils literal"><span class="pre">solution/output_vector</span></code></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.output_rate_vector_at_t">
<code class="descname">output_rate_vector_at_t</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.output_rate_vector_at_t"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.output_rate_vector_at_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector of output rates at time <code class="docutils literal"><span class="pre">t</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>t</strong> (<em>float</em>) &#8211; The time at which the output rates are computed.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The ith entry contains the output rate of pool <code class="docutils literal"><span class="pre">i</span></code>
at time <code class="docutils literal"><span class="pre">t</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.output_vector_func">
<code class="descname">output_vector_func</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.output_vector_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.output_vector_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector of the external output fluxes at time <code class="docutils literal"><span class="pre">t</span></code>.</p>
<p>The resulting values base on sol_funcs and come from  linear
interpolations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The <code class="docutils literal"><span class="pre">i</span></code> th entry is the output from pool <code class="docutils literal"><span class="pre">i</span></code> at
time <code class="docutils literal"><span class="pre">t</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">numpy.array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_3d_density_plotly">
<code class="descname">plot_3d_density_plotly</code><span class="sig-paren">(</span><em>title</em>, <em>density_data</em>, <em>ages</em>, <em>age_stride=1</em>, <em>time_stride=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_3d_density_plotly"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_3d_density_plotly" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a 3-dimendional density plot with Plotly.</p>
<p>The colors are created such that they are constant along the age-time
diagonal.
Thus, equal colors mark equal entry time into the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>title</strong> (<em>str</em>) &#8211; The title of the new figure.</li>
<li><strong>density_data</strong> (<em>numpy.ndarray len(ages</em>) &#8211; The density data to be plotted.</li>
<li><strong>age_stride</strong> (<em>int, optional</em>) &#8211; Coarsity of the plot in the age
direction to save memory.
Defaults to 1 meaning that all times are plotted and no memory
is saved.</li>
<li><strong>time_stride</strong> (<em>int, optional</em>) &#8211; Coarsity of the plot in the time
direction to save memory.
Defaults to 1 meaning that all times are plotted and no memory
is saved.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Plotly figure.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_external_input_fluxes">
<code class="descname">plot_external_input_fluxes</code><span class="sig-paren">(</span><em>fig</em>, <em>fontsize=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_external_input_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_external_input_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all external inpput fluxes.</p>
<p>For each external input flux a new subplot is added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fig</strong> (<em>Matplotlib figure</em>) &#8211; The fig to which the subplots are added.</li>
<li><strong>fontsize</strong> (<em>float, optional</em>) &#8211; Defaults to 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">fig</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_external_output_fluxes">
<code class="descname">plot_external_output_fluxes</code><span class="sig-paren">(</span><em>fig</em>, <em>fontsize=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_external_output_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_external_output_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all external output fluxes.</p>
<p>For each external output flux a new subplot is added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fig</strong> (<em>Matplotlib figure</em>) &#8211; The fig to which the subplots are added.</li>
<li><strong>fontsize</strong> (<em>float, optional</em>) &#8211; Defaults to 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">fig</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_internal_fluxes">
<code class="descname">plot_internal_fluxes</code><span class="sig-paren">(</span><em>fig</em>, <em>fontsize=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_internal_fluxes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_internal_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all internal fluxes.</p>
<p>For each internal flux a new subplot is added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fig</strong> (<em>Matplotlib figure</em>) &#8211; The fig to which the subplots are added.</li>
<li><strong>fontsize</strong> (<em>float, optional</em>) &#8211; Defaults to 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">fig</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_mean_ages">
<code class="descname">plot_mean_ages</code><span class="sig-paren">(</span><em>fig</em>, <em>start_mean_ages</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_mean_ages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_mean_ages" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the time evolution of the mean ages for all pools and the
system.</p>
<p>For each pool and the system a separate subplot is created.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fig</strong> (<em>Matplotlib figure</em>) &#8211; The fig to which the subplots are added.</li>
<li><strong>start_mean_ages</strong> (<em>numpy.array</em>) &#8211; Contains the start mean ages of the
pools at time <span class="math">\(t_0\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">fig</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_mean_backward_transit_time">
<code class="descname">plot_mean_backward_transit_time</code><span class="sig-paren">(</span><em>ax</em>, <em>start_mean_ages</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_mean_backward_transit_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_mean_backward_transit_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the time evolution of the mean backward transit time.</p>
<p>For each pool and the system a separate subplot is created.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax</strong> (<em>Matplotlib axis</em>) &#8211; The ax onto which the plot is done.</li>
<li><strong>start_mean_ages</strong> (<em>numpy.array</em>) &#8211; Contains the start mean ages of the
pools at time <span class="math">\(t_0\)</span>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">ax</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_phase_plane">
<code class="descname">plot_phase_plane</code><span class="sig-paren">(</span><em>ax</em>, <em>i</em>, <em>j</em>, <em>fontsize=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_phase_plane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_phase_plane" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot one single phase plane.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax</strong> (<em>Matplotlib axis</em>) &#8211; The axis onto which the phase plane is
plotted.</li>
<li><strong>j</strong> (<em>i,</em>) &#8211; The numbers of the pools for which the phase plane is
plotted.</li>
<li><strong>fontsize</strong> (<em>float, optional</em>) &#8211; Defaults to 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">ax</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_phase_planes">
<code class="descname">plot_phase_planes</code><span class="sig-paren">(</span><em>fig</em>, <em>fontsize=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_phase_planes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_phase_planes" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot all phase planes.</p>
<p>For each (i,j)-phase plane a new subplot is added.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fig</strong> (<em>Matplotlib figure</em>) &#8211; The fig to which the subplots are added.</li>
<li><strong>fontsize</strong> (<em>float, optional</em>) &#8211; Defaults to 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">fig</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_solutions">
<code class="descname">plot_solutions</code><span class="sig-paren">(</span><em>fig</em>, <em>fontsize=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.plot_solutions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.plot_solutions" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the solution trajectories.</p>
<p>For each trajectory (nr_pools+1) a new subplot is created.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fig</strong> (<em>Matplotlib figure</em>) &#8211; The fig to which the subplots are added.</li>
<li><strong>fontsize</strong> (<em>float, optional</em>) &#8211; Defaults to 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.
Instead <code class="docutils literal"><span class="pre">fig</span></code> is changed in place.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_func">
<code class="descname">pool_age_densities_func</code><span class="sig-paren">(</span><em>start_age_densities=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_densities_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function based on an age array that returns the
pool age densities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math">\(t_0\)</span>.
Defaults to None, meaning that all initial mass is considered
to have zero age.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">p</span></code>: <code class="docutils literal"><span class="pre">p(ages)</span></code> returns a <code class="docutils literal"><span class="pre">numpy.ndarray</span></code>
len(ages) x len(times) x nr_pools containing the pool contents
with the respective ages at the respective times, where <code class="docutils literal"><span class="pre">ages</span></code>
is a <code class="docutils literal"><span class="pre">numpy.array</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_single_value">
<code class="descname">pool_age_densities_single_value</code><span class="sig-paren">(</span><em>start_age_densities=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_densities_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_densities_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the pool age densities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math">\(t_0\)</span>. Defaults to None, meaning that all
initial mass is considered to have zero age.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">p_sv</span></code>: <code class="docutils literal"><span class="pre">p_sv(a,</span> <span class="pre">t)</span></code> returns <code class="docutils literal"><span class="pre">a</span> <span class="pre">numpy.array</span></code>
containing the pool contents with age <code class="docutils literal"><span class="pre">a</span></code> at time <code class="docutils literal"><span class="pre">t</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distribution_quantiles_pool_by_ode">
<code class="descname">pool_age_distribution_quantiles_pool_by_ode</code><span class="sig-paren">(</span><em>quantile</em>, <em>pool</em>, <em>start_age_densities=None</em>, <em>F0=None</em>, <em>tol=1e-08</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_distribution_quantiles_pool_by_ode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distribution_quantiles_pool_by_ode" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pool age distribution quantile over the time grid for one
single pool.</p>
<p>The compuation is done by solving an ODE as soon as the pool is
nonempty.
The initial value is obtained by computing the generalized inverse of
the pool age distribution by a numerical root search algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>quantile</strong> (<em>between 0 and 1</em>) &#8211; The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</li>
<li><strong>pool</strong> (<em>int</em>) &#8211; The number of the pool for which the age quantile is to
be computed.</li>
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a <code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>F0</strong> (<em>Python function</em>) &#8211; A function of age that returns a
<code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>tol</strong> (<em>float</em>) &#8211; The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal"><span class="pre">1e-01</span></code> might already be fine.
Defaults to <code class="docutils literal"><span class="pre">1e-08</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> &#8211; If both <code class="docutils literal"><span class="pre">start_age_densities</span></code> and <code class="docutils literal"><span class="pre">F0</span></code> are <code class="docutils literal"><span class="pre">None</span></code>.
One must be given.
It is fastest to provide <code class="docutils literal"><span class="pre">F0</span></code>, otherwise <code class="docutils literal"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal"><span class="pre">start_age_densities</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(len(times)) The computed quantile values over the
time grid.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distributions_quantiles">
<code class="descname">pool_age_distributions_quantiles</code><span class="sig-paren">(</span><em>quantile</em>, <em>start_values=None</em>, <em>start_age_densities=None</em>, <em>F0=None</em>, <em>method='brentq'</em>, <em>tol=1e-08</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_distributions_quantiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distributions_quantiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pool age distribution quantiles over the time grid.</p>
<p>The compuation is done by computing the generalized inverse of the
respective cumulative distribution using a nonlinear root search
algorithm. Depending on how slowly the cumulative distribution can be
computed, this can take quite some time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>quantile</strong> (<em>between 0 and 1</em>) &#8211; The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</li>
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a <code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>F0</strong> (<em>Python function</em>) &#8211; A function of age that returns a
<code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>method</strong> (<em>str</em>) &#8211; The method that is used for finding the roots of a
nonlinear function. Either &#8216;brentq&#8217; or &#8216;newton&#8217;.
Defaults to &#8216;brentq&#8217;.</li>
<li><strong>tol</strong> (<em>float</em>) &#8211; The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal"><span class="pre">1e-01</span></code> might already be fine.
Defaults to <code class="docutils literal"><span class="pre">1e-08</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> &#8211; If both <code class="docutils literal"><span class="pre">start_age_densities</span></code> and <code class="docutils literal"><span class="pre">F0</span></code> are <code class="docutils literal"><span class="pre">None</span></code>.
One must be given.
It is fastest to provide <code class="docutils literal"><span class="pre">F0</span></code>, otherwise <code class="docutils literal"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal"><span class="pre">start_age_densities</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(len(times) x nr_pools)
The computed quantile values over the time-pool grid.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distributions_quantiles_by_ode">
<code class="descname">pool_age_distributions_quantiles_by_ode</code><span class="sig-paren">(</span><em>quantile</em>, <em>start_age_densities=None</em>, <em>F0=None</em>, <em>tol=1e-08</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.pool_age_distributions_quantiles_by_ode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.pool_age_distributions_quantiles_by_ode" title="Permalink to this definition">¶</a></dt>
<dd><p>Return pool age distribution quantiles over the time grid.</p>
<p>The compuation is done by solving an ODE for each pool as soon as the
pool is nonempty.
The initial value is obtained by computing the generalized inverse of
the pool age distribution by a numerical root search algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>quantile</strong> (<em>between 0 and 1</em>) &#8211; The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</li>
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a <code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>F0</strong> (<em>Python function</em>) &#8211; A function of age that returns a
<code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>tol</strong> (<em>float</em>) &#8211; The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal"><span class="pre">1e-01</span></code> might already be fine.
Defaults to <code class="docutils literal"><span class="pre">1e-08</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> &#8211; If both <code class="docutils literal"><span class="pre">start_age_densities</span></code> and <code class="docutils literal"><span class="pre">F0</span></code> are <code class="docutils literal"><span class="pre">None</span></code>.
One must be given.
It is fastest to provide <code class="docutils literal"><span class="pre">F0</span></code>, otherwise <code class="docutils literal"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal"><span class="pre">start_age_densities</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">(len(times) x nr_pools) The computed quantile values
over the time-pool grid.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.save_density_csv">
<code class="descname">save_density_csv</code><span class="sig-paren">(</span><em>filename</em>, <em>density</em>, <em>ages</em>, <em>times=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.save_density_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.save_density_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Save density values over age-time grid to csv file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The name of the csv file to be written.</li>
<li><strong>density</strong> (<em>numpy.ndarray len(ages</em>) &#8211; The density values
to be saved over the age-time grid.</li>
<li><strong>ages</strong> (<em>numpy.array</em>) &#8211; The ages corresponding to the indices in the
zeroth dimension of the density ndarray.</li>
<li><strong>times</strong> (<em>numpy.array, optional</em>) &#8211; An alternative time grid to be used.
Defaults to None which means that the original time grid is
going to be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.save_pools_and_system_density_csv">
<code class="descname">save_pools_and_system_density_csv</code><span class="sig-paren">(</span><em>filename</em>, <em>pool_age_densities</em>, <em>system_age_density</em>, <em>ages</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.save_pools_and_system_density_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.save_pools_and_system_density_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the pool and system age densities to a csv file.</p>
<p>The system value will be coded into pool number -1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The name of the csv file to be written.</li>
<li><strong>pool_age_densites</strong> (<em>numpy.ndarray len(ages</em>) &#8211; The pool age density values.</li>
<li><strong>system_age_density</strong> (<em>numpy.ndarray len(ages</em>) &#8211; The system age density values.</li>
<li><strong>ages</strong> (<em>numpy.array</em>) &#8211; The ages that correspond to the indices in the
zeroth dimension of the density arrays.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.save_pools_and_system_value_csv">
<code class="descname">save_pools_and_system_value_csv</code><span class="sig-paren">(</span><em>filename</em>, <em>pools_ndarr</em>, <em>system_arr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.save_pools_and_system_value_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.save_pools_and_system_value_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Save pool and system values to a csv file.</p>
<p>Values could be the mean age, for example. One dimension less than a
density.
The system value will be coded into pool number -1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The name of the csv file to be written.</li>
<li><strong>pools_ndarr</strong> (<em>numpy.ndarray len(times</em>) &#8211; The values to be
saved over the time-pool grid.</li>
<li><strong>system_arr</strong> (<em>numpy.array</em>) &#8211; The values over the time grid
corresponding to the system.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.save_value_csv">
<code class="descname">save_value_csv</code><span class="sig-paren">(</span><em>filename</em>, <em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.save_value_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.save_value_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Save values over the time grid to a csv file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; The name of the csv file to be written.</li>
<li><strong>arr</strong> (<em>numpy.array</em>) &#8211; The values to be saved over the time grid.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs">
<code class="descname">sol_funcs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.sol_funcs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.sol_funcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return linearly interpolated solution functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">f</span></code>: <code class="docutils literal"><span class="pre">f(t)</span></code> returns a numpy.array containing the
pool contents at time <code class="docutils literal"><span class="pre">t</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>alternative_times=None</em>, <em>alternative_start_values=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the model and return a solution grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>alternative_times</strong> (<em>numpy.array</em>) &#8211; If not given, the original time
grid is used.</li>
<li><strong>alternative_start_values</strong> (<em>numpy.array</em>) &#8211; If not given,
the original start_values are used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">len(times) x nr_pools, contains the pool contents
at the times given in the time grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.solve_single_value">
<code class="descname">solve_single_value</code><span class="sig-paren">(</span><em>alternative_start_values=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.solve_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.solve_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the model and return a function of time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>alternative_start_values</strong> (<em>numpy.array, optional</em>) &#8211; If not given, the
original <code class="docutils literal"><span class="pre">start_values</span></code> are used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">f</span></code>: <code class="docutils literal"><span class="pre">f(t)</span></code> is a numpy.array that containts the
pool contents at time <code class="docutils literal"><span class="pre">t</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density">
<code class="descname">system_age_density</code><span class="sig-paren">(</span><em>pool_age_densities</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the system age density based on the given pool age densities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pool_age_densites</strong> (<em>numpy.ndarray len(ages</em>) &#8211; The pool age density values.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(len(ages) x len(times)) The sum of the pool age
contents over all pools.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density_single_value">
<code class="descname">system_age_density_single_value</code><span class="sig-paren">(</span><em>start_age_densities=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_density_single_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_density_single_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function for the system age density.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a numpy.array containing the masses with the given
age at time <span class="math">\(t_0\)</span>.
Defaults to None, meaning that all initial mass is considered
to have zero age.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Python function <code class="docutils literal"><span class="pre">sys_p_sv</span></code>: <code class="docutils literal"><span class="pre">sys_p_sv(a,</span> <span class="pre">t)</span></code> returns the system
content with age <code class="docutils literal"><span class="pre">a</span></code> at time <code class="docutils literal"><span class="pre">t</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_distribution_quantiles">
<code class="descname">system_age_distribution_quantiles</code><span class="sig-paren">(</span><em>quantile</em>, <em>start_values=None</em>, <em>start_age_densities=None</em>, <em>F0=None</em>, <em>method='brentq'</em>, <em>tol=1e-08</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_distribution_quantiles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_distribution_quantiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return system age distribution quantiles over the time grid.</p>
<p>The compuation is done by computing the generalized inverse of the
respective cumulative distribution using a nonlinear root search
algorithm. Depending on how slowly the cumulative distribution can be
computed, this can take quite some time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>quantile</strong> (<em>between 0 and 1</em>) &#8211; The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</li>
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a <code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>F0</strong> (<em>Python function</em>) &#8211; A function of age that returns a
<code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>method</strong> (<em>str</em>) &#8211; The method that is used for finding the roots of a
nonlinear function. Either &#8216;brentq&#8217; or &#8216;newton&#8217;.
Defaults to &#8216;brentq&#8217;.</li>
<li><strong>tol</strong> (<em>float</em>) &#8211; The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal"><span class="pre">1e-01</span></code> might already be fide.
Defaults to <code class="docutils literal"><span class="pre">1e-08</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> &#8211; If both <code class="docutils literal"><span class="pre">start_age_densities</span></code> and <code class="docutils literal"><span class="pre">F0</span></code> are <code class="docutils literal"><span class="pre">None</span></code>.
One must be given.
It is fastest to provide <code class="docutils literal"><span class="pre">F0</span></code>, otherwise <code class="docutils literal"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal"><span class="pre">start_age_densities</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The computed quantile values over the time grid.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_distribution_quantiles_by_ode">
<code class="descname">system_age_distribution_quantiles_by_ode</code><span class="sig-paren">(</span><em>quantile</em>, <em>start_age_densities=None</em>, <em>F0=None</em>, <em>tol=1e-08</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_distribution_quantiles_by_ode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_distribution_quantiles_by_ode" title="Permalink to this definition">¶</a></dt>
<dd><p>Return system age distribution quantile over the time grid.</p>
<p>The compuation is done by solving an ODE as soon as the system is
nonempty.
The initial value is obtained by computing the generalized inverse of
the system age distribution by a numerical root search algorithm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>quantile</strong> (<em>between 0 and 1</em>) &#8211; The relative share of mass that is
considered to be left of the computed value. A value of <code class="docutils literal"><span class="pre">0.5</span></code>
leads to the computation of the median of the distribution.</li>
<li><strong>pool</strong> (<em>int</em>) &#8211; The number of the pool for which the age quantile is to
be computed.</li>
<li><strong>start_age_densities</strong> (<em>Python function, optional</em>) &#8211; A function of age
that returns a <code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with the
given age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>F0</strong> (<em>Python function</em>) &#8211; A function of age that returns a
<code class="docutils literal"><span class="pre">numpy.array</span></code> containing the masses with age less than or
equal to the age at time <span class="math">\(t_0\)</span>.
Defaults to <code class="docutils literal"><span class="pre">None</span></code>.</li>
<li><strong>tol</strong> (<em>float</em>) &#8211; The tolerance used in the numerical root search
algorithm. A low tolerance decreases the computation speed
tremendously, so a value of <code class="docutils literal"><span class="pre">1e-01</span></code> might already be fine.
Defaults to <code class="docutils literal"><span class="pre">1e-08</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="#CompartmentalSystems.smooth_model_run.Error" title="CompartmentalSystems.smooth_model_run.Error"><code class="xref py py-exc docutils literal"><span class="pre">Error</span></code></a> &#8211; If both <code class="docutils literal"><span class="pre">start_age_densities</span></code> and <code class="docutils literal"><span class="pre">F0</span></code> are <code class="docutils literal"><span class="pre">None</span></code>.
One must be given.
It is fastest to provide <code class="docutils literal"><span class="pre">F0</span></code>, otherwise <code class="docutils literal"><span class="pre">F0</span></code> will be
computed by numerical integration of <code class="docutils literal"><span class="pre">start_age_densities</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The computed quantile values over the time grid.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_moment">
<code class="descname">system_age_moment</code><span class="sig-paren">(</span><em>order</em>, <em>start_age_moments=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/CompartmentalSystems/smooth_model_run.html#SmoothModelRun.system_age_moment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.system_age_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <code class="docutils literal"><span class="pre">order</span></code> th system age moment vector over the time grid
by an ODE system.</p>
<p>The pool age moments are computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.age_moment_vector"><code class="xref py py-func docutils literal"><span class="pre">age_moment_vector()</span></code></a> and then
weighted corresponding to the pool contents.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>order</strong> (<em>int</em>) &#8211; The order of the pool age moments to be computed.</li>
<li><strong>start_age_moments</strong> (<em>numpy.ndarray order x nr_pools, optional</em>) &#8211; Given initial age moments up to the order of interest.
Can possibly be computed by <a class="reference internal" href="#CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities" title="CompartmentalSystems.smooth_model_run.SmoothModelRun.moments_from_densities"><code class="xref py py-func docutils literal"><span class="pre">moments_from_densities()</span></code></a>.
Defaults to None assuming zero initial ages.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The <code class="docutils literal"><span class="pre">order</span></code> th system age moment over the time grid.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">CompartmentalSystems</a></h1>










<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="CompartmentalSystems.smooth_reservoir_model.html" title="previous chapter">CompartmentalSystems.smooth_reservoir_model</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Holger Metzler, Markus Müller.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.5+</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/_autosummary/CompartmentalSystems.smooth_model_run.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>